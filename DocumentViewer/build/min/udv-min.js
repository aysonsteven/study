var annotationObject;var markupId=0;var tempId=0;var readyToDraw=false;var lastSelectedDivReason=null;var lastDrawnDivReason=null;function addAnnotationDraw(){readyToDraw=true;transferTextAreaValuetoDiv(lastSelectedDivReason);document.addEventListener("mousedown",initStartPosition,false);lastSelectedDivReason=null;lastDrawnDivReason=null;markupId++}function deactivateAnnotationDraw(){if(readyToDraw){markupId--;readyToDraw=false;document.removeEventListener("mousedown",initStartPosition,false);lastSelectedDivReason=null;lastDrawnDivReason=null}}function createDrawnObject(b){var a={};a.attributes=createAttributesObject(b);a.shapes=createShapeObject(b);a.markupType=parseInt(b);attachShapeFunctions(a);a.toString=function(){var d="";for(var c in this.attributes){d+="("+c+","+this.attributes[c]+")"}return d};return a}function attachShapeFunctions(a,d){var c=JSON.parse(JSON.stringify(isIE));if(d!=undefined){isIE=d}a.setShapeAttribute=function(f,e,g){f.setAttributeNS(null,e,g)};a.getShapeAttribute=function(f,e){f.getAttributeNS(null,e)
};a.setTextAttribute=function(f,e,g){f.style[e]=g};switch(a.markupType){case markupTypes.Text:var b=isIE?a.shapes.SVGText:a.shapes.divText;a.setFontFamily=function(e){this.attributes.fontFamily=e;this.setTextAttribute(b,"fontFamily",e)};a.setFontSize=function(e){this.attributes.fontSize=e;this.setTextAttribute(b,"fontSize",e)};a.setBoldStyle=function(e){this.attributes.boldStyle=e;this.setTextAttribute(b,"fontWeight",e)};a.setItalicStyle=function(e){this.attributes.italicStyle=e;this.setTextAttribute(b,"fontStyle",e)};a.setUnderlineStrikeStyle=function(e){this.attributes.underLineStrikeStyle=e;this.setTextAttribute(b,"textDecoration",e)};a.setHorizontalAlign=function(e){this.attributes.horizontalAlign=e;this.setTextAttribute(b,"textAlign",e)};a.setVerticalAlign=function(e){this.attributes.verticalAlign=e;this.setTextAttribute(b,"verticalAlign",e)};a.setTextAnchor=function(e){this.attributes.textAnchor=e;this.setShapeAttribute(b,"text-anchor",e)};a.getText=function(){var f="";var g=this.attributes.text;
var e=this.attributes.text.length;if(e===undefined||e===null){e=Object.keys(g).length}f=g[0];switch(this.markupType){case markupTypes.Text:for(var h=1;h<e;h++){if(isIE){f+="\n"+g[h]}else{f+="<br/>"+g[h]}}break}return f};a.setSVGTextValueX=function(e){this.attributes.valueX=e;this.setShapeAttribute(b,"x",e)};a.setSVGTextValueY=function(e){this.attributes.valueY=e;this.setShapeAttribute(b,"y",e)};case markupTypes.RectangleRedaction:var b=isIE?a.shapes.SVGText:a.shapes.divText;a.setFontColor=function(f){this.attributes.fontColor=f;var e=(this.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:this.attributes.opacity;var g=getRGBAcolor(f,e);if(isIE){this.setTextAttribute(b,"fill",g)}else{this.setTextAttribute(b,"color",g)}};case markupTypes.Rectangle:case markupTypes.SearchHighlight:a.setX=function(e){this.attributes.x=e;switch(this.markupType){case markupTypes.RectangleRedaction:if(isIE){this.setShapeAttribute(this.shapes.SVGText,"x",this.attributes.width/2);this.setShapeAttribute(this.shapes.SVGClipRect,"x","0");
this.setShapeAttribute(this.shapes.SVGRectangle,"x",e);if(this.getShapeAttribute(this.shapes.SVGGWrapper,"transform")){this.setShapeAttribute(this.shapes.SVGGWrapper,"transform",parseMatrix(this.shapes.SVGGWrapper.getAttributeNS(null,"transform"),4,e))}else{this.setShapeAttribute(this.shapes.SVGGWrapper,"transform","matrix(1,0,0,1,"+e+",0)")}}else{this.setShapeAttribute(this.shapes.SVGRectangle,"x",e);this.setShapeAttribute(this.shapes.foreignObj,"x",e)}break;case markupTypes.Text:if(isIE){this.setShapeAttribute(this.shapes.SVGClipRect,"x","0");this.setShapeAttribute(this.shapes.SVGRectangle,"x",e);if(this.getShapeAttribute(this.shapes.SVGGWrapper,"transform")){this.setShapeAttribute(this.shapes.SVGGWrapper,"transform",parseMatrix(this.shapes.SVGGWrapper.getAttributeNS(null,"transform"),4,e))}else{this.setShapeAttribute(this.shapes.SVGGWrapper,"transform","matrix(1,0,0,1,"+e+",0)")}}else{this.setShapeAttribute(this.shapes.foreignObj,"x",e+5);this.setShapeAttribute(this.shapes.SVGRectangle,"x",e)
}break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:this.setShapeAttribute(this.shapes.SVGRectangle,"x",e);break}};a.setY=function(f){try{this.attributes.y=f;switch(this.markupType){case markupTypes.RectangleRedaction:if(isIE){this.setShapeAttribute(this.shapes.SVGText,"y",this.attributes.height/2);this.setShapeAttribute(this.shapes.SVGClipRect,"y","0");this.setShapeAttribute(this.shapes.SVGRectangle,"y",f);if(this.getShapeAttribute(this.shapes.SVGGWrapper,"transform")){this.setShapeAttribute(this.shapes.SVGGWrapper,"transform",parseMatrix(this.shapes.SVGGWrapper.getAttributeNS(null,"transform"),5,f))}else{this.setShapeAttribute(this.shapes.SVGGWrapper,"transform","matrix(1,0,0,1,0,"+f+")")}}else{this.setShapeAttribute(this.shapes.SVGRectangle,"y",f);this.setShapeAttribute(this.shapes.foreignObj,"y",f)}break;case markupTypes.Text:if(isIE){this.setShapeAttribute(this.shapes.SVGClipRect,"y","0");this.setShapeAttribute(this.shapes.SVGRectangle,"y",f);if(this.getShapeAttribute(this.shapes.SVGGWrapper,"transform")){this.setShapeAttribute(this.shapes.SVGGWrapper,"transform",parseMatrix(this.shapes.SVGGWrapper.getAttributeNS(null,"transform"),5,f))
}else{this.setShapeAttribute(this.shapes.SVGGWrapper,"transform","matrix(1,0,0,1,0,"+f+")")}}else{this.setShapeAttribute(this.shapes.foreignObj,"y",f+5);this.setShapeAttribute(this.shapes.SVGRectangle,"y",f)}break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:this.setShapeAttribute(this.shapes.SVGRectangle,"y",f);break}}catch(e){console.error("Exception in attachShapeFunctions setY: "+e)}};a.setWidth=function(e){try{this.attributes.width=e;switch(this.markupType){case markupTypes.RectangleRedaction:if(isIE){this.setShapeAttribute(this.shapes.SVGText,"width",e);this.setShapeAttribute(this.shapes.SVGClipRect,"width",e);this.setShapeAttribute(this.shapes.SVGRectangle,"width",e)}else{this.setShapeAttribute(this.shapes.SVGRectangle,"width",e);this.setShapeAttribute(this.shapes.foreignObj,"width",e);this.shapes.divText.style.width=e+"px"}break;case markupTypes.Text:if(isIE){this.setShapeAttribute(this.shapes.SVGText,"width",e);this.setShapeAttribute(this.shapes.SVGClipRect,"width",e-5);
this.setShapeAttribute(this.shapes.SVGRectangle,"width",e)}else{this.setShapeAttribute(this.shapes.SVGRectangle,"width",e);this.setShapeAttribute(this.shapes.foreignObj,"width",e-10);this.shapes.divText.style.width=(e-10)+"px"}break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:this.setShapeAttribute(this.shapes.SVGRectangle,"width",e);break}}catch(f){console.error("Exception in attachShapeFunctions setWidth: "+f)}};a.setHeight=function(e){try{this.attributes.height=e;switch(this.markupType){case markupTypes.RectangleRedaction:if(isIE){this.setShapeAttribute(this.shapes.SVGText,"height",e);this.setShapeAttribute(this.shapes.SVGClipRect,"height",e);this.setShapeAttribute(this.shapes.SVGRectangle,"height",e)}else{this.setShapeAttribute(this.shapes.SVGRectangle,"height",e);this.setShapeAttribute(this.shapes.foreignObj,"height",e);this.shapes.divText.style.height=e+"px"}break;case markupTypes.Text:if(isIE){this.setShapeAttribute(this.shapes.SVGText,"height",e);this.setShapeAttribute(this.shapes.SVGClipRect,"height",e-5);
this.setShapeAttribute(this.shapes.SVGRectangle,"height",e)}else{this.setShapeAttribute(this.shapes.SVGRectangle,"height",e);this.setShapeAttribute(this.shapes.foreignObj,"height",e-10);this.shapes.divText.style.height=(e-10)+"px"}break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:this.setShapeAttribute(this.shapes.SVGRectangle,"height",e);break}}catch(f){console.error("Exception in attachShapeFunctions setHeight: "+f)}};break;case markupTypes.Arrow:a.setMarkerEnd=function(e){this.attributes.markerEnd=e;this.setShapeAttribute(this.shapes.SVGLine,"marker-end",e)};a.setCircMaskCX=function(e){this.setShapeAttribute(this.shapes.circleMask,"cx",e)};a.setCircMaskCY=function(e){this.setShapeAttribute(this.shapes.circleMask,"cy",e)};a.setCircMaskRX=function(e){this.setShapeAttribute(this.shapes.circleMask,"rx",e)};a.setCircMaskRY=function(e){this.setShapeAttribute(this.shapes.circleMask,"ry",e)};case markupTypes.Line:a.setX1=function(e){this.attributes.x1=e;this.setShapeAttribute(this.shapes.SVGLine,"x1",e)
};a.setY1=function(e){this.attributes.y1=e;this.setShapeAttribute(this.shapes.SVGLine,"y1",e)};a.setX2=function(e){this.attributes.x2=e;this.setShapeAttribute(this.shapes.SVGLine,"x2",e)};a.setY2=function(e){this.attributes.y2=e;this.setShapeAttribute(this.shapes.SVGLine,"y2",e)};break;case markupTypes.Circle:a.setCX=function(e){this.attributes.cx=e;this.setShapeAttribute(this.shapes.SVGEllipse,"cx",e)};a.setCY=function(e){this.attributes.cy=e;this.setShapeAttribute(this.shapes.SVGEllipse,"cy",e)};a.setRX=function(e){this.attributes.rx=e;this.setShapeAttribute(this.shapes.SVGEllipse,"rx",e)};a.setRY=function(e){this.attributes.ry=e;this.setShapeAttribute(this.shapes.SVGEllipse,"ry",e)};break}a.setFillColor=function(f){this.attributes.fillColor=f;var e;switch(this.markupType){case markupTypes.Text:case markupTypes.RectangleRedaction:e=this.shapes.SVGRectangle;if(f=="rgba(176, 176, 176, 0)"||f=="rgba(0, 0, 0, 0)"||f=="transparent"){f=getRGBAcolor(f,"0")}else{f=getRGBAcolor(f,1)}this.setShapeAttribute(e,"fill",f);
break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:e=this.shapes.SVGRectangle;this.setShapeAttribute(e,"fill",f);break;case markupTypes.Arrow:e=this.shapes.SVGArrowHead;this.setShapeAttribute(e,"fill",f);case markupTypes.Line:e=this.shapes.SVGLine;this.setShapeAttribute(e,"stroke",f);break;case markupTypes.Circle:e=this.shapes.SVGEllipse;this.setShapeAttribute(e,"fill",f);break}};a.setBorderColor=function(f){this.attributes.borderColor=f;var e;switch(this.markupType){case markupTypes.Text:case markupTypes.RectangleRedaction:case markupTypes.Rectangle:case markupTypes.SearchHighlight:e=this.shapes.SVGRectangle;break;case markupTypes.Circle:e=this.shapes.SVGEllipse;break}this.setShapeAttribute(e,"stroke",f)};a.setBorderWeight=function(f){this.attributes.borderWeight=f;var e;switch(this.markupType){case markupTypes.Text:case markupTypes.RectangleRedaction:case markupTypes.Rectangle:case markupTypes.SearchHighlight:e=this.shapes.SVGRectangle;this.setShapeAttribute(e,"stroke-width",f);
break;case markupTypes.Arrow:e=this.shapes.SVGArrowHead;this.setShapeAttribute(e,"stroke-width",f);case markupTypes.Line:e=this.shapes.SVGLine;this.setShapeAttribute(e,"stroke-width",f);break;case markupTypes.Circle:e=this.shapes.SVGEllipse;this.setShapeAttribute(e,"stroke-width",f);break}};a.setOpacityDisplay=function(f){var e;switch(this.markupType){case markupTypes.Text:case markupTypes.RectangleRedaction:e=isIE?this.shapes.SVGText:this.shapes.divText;this.setTextAttribute(e,isIE?"fill":"color",getRGBAcolor(this.attributes.fontColor,f));this.setShapeAttribute(e,"data-opacity",this.attributes.opacity);e=this.shapes.SVGRectangle;if(isSafari){this.setShapeAttribute(e,"fill-opacity",f);this.setShapeAttribute(e,"stroke-opacity",f)}else{if(this.markupType===markupTypes.RectangleRedaction){this.setShapeAttribute(e,"fill",getRGBAcolor(this.attributes.fillColor,f))}else{e.style.opacity=f;if(this.attributes.fillColor=="rgba(176, 176, 176, 0)"||this.attributes.fillColor=="rgba(0, 0, 0, 0)"||this.attributes.fillColor=="transparent"){this.setShapeAttribute(e,"fill",getRGBAcolor(this.attributes.fillColor,"0"))
}else{this.setShapeAttribute(e,"fill",getRGBAcolor(this.attributes.fillColor,1))}}}this.setShapeAttribute(e,"data-opacity",this.attributes.opacity);break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:e=this.shapes.SVGRectangle;if(isSafari){this.setShapeAttribute(e,"fill-opacity",f);this.setShapeAttribute(e,"stroke-opacity",f)}else{e.style.opacity=f}this.setShapeAttribute(e,"data-opacity",this.attributes.opacity);break;case markupTypes.Arrow:e=this.shapes.SVGArrowHead;if(isSafari){this.setShapeAttribute(e,"fill-opacity",f);this.setShapeAttribute(e,"stroke-opacity",f)}case markupTypes.Line:e=this.shapes.SVGLine;if(isSafari){this.setShapeAttribute(e,"fill-opacity",f);this.setShapeAttribute(e,"stroke-opacity",f)}else{e.style.opacity=f}this.setShapeAttribute(e,"data-opacity",this.attributes.opacity);break;case markupTypes.Circle:e=this.shapes.SVGEllipse;if(isSafari){this.setShapeAttribute(e,"fill-opacity",f);this.setShapeAttribute(e,"stroke-opacity",f)}else{e.style.opacity=f}this.setShapeAttribute(e,"data-opacity",this.attributes.opacity);
break}};a.setOpacity=function(e){this.attributes.opacity=e;this.setOpacityDisplay(e)};a.setText=function(g,f){var e=JSON.parse(JSON.stringify(isIE));if(f!=undefined){isIE=f}this.attributes.text=[];g=""+g;var h=[];switch(this.markupType){case markupTypes.Text:if(isIE){h=g.split("\n")}else{h=g.split("\n")}this.attributes.text=h;break;case markupTypes.RectangleRedaction:this.attributes.text.push(g);if(isIE){}else{this.shapes.divText.innerHTML=g}break}if(e!=isIE){isIE=e}};a.setVisibilityMode=function(e){this.visibilityMode=e;switch(this.visibilityMode){case visibilityMode.Shown:this.setOpacityDisplay(this.attributes.opacity);break;case visibilityMode.Hidden:this.setOpacityDisplay(0);break;case visibilityMode.Transparent:this.setOpacityDisplay(0.2);break}};a.setId=function(g){this.attributes.id=g;this.id=g;var f;if(this.markupType==markupTypes.RectangleRedaction){f="redaction"}else{f="annotation"}for(var e in this.shapes){if(e.indexOf("SVG")>-1||e.indexOf("divText")>-1||e.indexOf("para")>-1||e.indexOf("foreign")>-1||e.indexOf("body")>-1){this.setShapeAttribute(this.shapes[e],"data-isi",f+"-"+g)
}}if(this.markupType==markupTypes.Text){if(isIE){this.setShapeAttribute(this.shapes.SVGText,"id","divText-"+g);this.setShapeAttribute(this.shapes.divText,"id","tSpan-"+g)}else{this.setShapeAttribute(this.shapes.divText,"id","divText-"+g);this.setShapeAttribute(this.shapes.para,"id","pText-"+g)}}this.setShapeAttribute(this.shapes.group,"data-isi",f+"-"+g)};a.rotateTextObject=function(g,r){if(this.markupType===markupTypes.Text||this.markupType===markupTypes.RectangleRedaction){var o=JSON.parse(JSON.stringify(isIE));if(r!=undefined){isIE=r}var l=this.attributes.width;var k=this.attributes.height;var n=this.attributes.x;var m=this.attributes.y;var j=l/2;var i=k/2;var q,p;var f=getTextTransformRotate(g,n,m,l,k);if(g===90||g===270){l=this.attributes.height;k=this.attributes.width;q=i;p=j}else{l=this.attributes.width;k=this.attributes.height;q=j;p=i}if(isIE){if(this.markupType===markupTypes.Text){this.shapes.SVGClipRect.setAttribute("width",l-5);this.shapes.SVGClipRect.setAttribute("height",k-5);
this.shapes.SVGText.setAttribute("width",l);this.shapes.SVGText.setAttribute("height",k);var h=null,e=0;switch(this.attributes.horizontalAlign){case"left":e=5;h="start";break;case"center":e=parseInt(l/2);h="middle";break;case"right":e=parseInt(l-5);h="end";break}this.setSVGTextValueX(e);this.setTextAnchor(h);clearTextNodes(this.shapes.SVGText);this.shapes.divText.textContent="";performWrappingAndNewLineForText(this.shapes.divText,this.getText());setVerticalAlignOnChange(this.shapes.SVGText,this.attributes.verticalAlign);this.setSVGTextValueY(this.shapes.SVGText.getAttribute("y"));q=this.attributes.valueX;p=this.attributes.valueY;this.shapes.SVGText.setAttribute("x",q);this.shapes.SVGText.setAttribute("y",p)}if(this.markupType===markupTypes.RectangleRedaction){clearChildren(this.shapes.SVGText);processWrapping(this.shapes.SVGText,this.attributes.text[0],redactionFontSize,l,this.id,(l/2));this.shapes.SVGText.setAttribute("width",l);this.shapes.SVGText.setAttribute("height",k);this.shapes.SVGText.setAttribute("x",q);
this.shapes.SVGText.setAttribute("y",p);this.shapes.SVGClipRect.setAttribute("width",l-5);this.shapes.SVGClipRect.setAttribute("height",k-5);f=getTextTransformRotate(g,n,m,this.attributes.width-5,this.attributes.height-5)}this.shapes.SVGGWrapper.setAttribute("transform",f)}else{if(this.markupType===markupTypes.Text){l-=10;k-=10}this.shapes.foreignObj.setAttribute("width",l);this.shapes.foreignObj.setAttribute("height",k);this.shapes.divText.style.width=l;this.shapes.divText.style.height=k;this.shapes.foreignObj.setAttribute("transform",f)}if(o!=isIE){isIE=o}}};if(c!=isIE){isIE=c}}function createAttributesObject(a){var b={};b.id=-1;b.type=a;switch(a){case markupTypes.Circle:b.x=0;b.y=0;case markupTypes.RectangleRedaction:case markupTypes.Text:b.fontColor="rgb(0,0,0)";case markupTypes.Rectangle:case markupTypes.SearchHighlight:b.x=0;b.y=0;b.height=0;b.width=0;b.fillColor="rgb(0,0,0)";b.borderColor="rgb(0,0,0)";break;case markupTypes.Arrow:case markupTypes.Line:b.x1=0;b.y1=0;b.x2=0;b.y2=0;
break}return b}function createShapeObject(r,t){var s=JSON.parse(JSON.stringify(isIE));if(t!=undefined){isIE=t}var l=createSVGElement("g");l.setAttribute("style","display:block;");l.setAttribute("class","annotationClass");var e={};switch(r){case markupTypes.Circle:var f=createSVGElement("ellipse");e.SVGEllipse=f;e.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGEllipse.parentNode);return transformed};e.retrieveShapeForCalculation=function(){return this.SVGEllipse};break;case markupTypes.Arrow:var i=createSVGElement("marker");var o=createSVGElement("path");var j=createSVGElement("ellipse");e.SVGArrowHead=i;e.SVGPath=o;e.circleMask=j;case markupTypes.Line:var k=createSVGElement("line");e.SVGLine=k;e.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGLine.parentNode);return transformed};e.retrieveShapeForCalculation=function(){return this.SVGLine};break;case markupTypes.RectangleRedaction:var c=createSVGElement("rect");e.SVGRectangle=c;if(isIE){var b=createSVGElement("rect");
var d=createSVGElement("text");var a=createSVGElement("g");var h=createSVGElement("tspan");var m=createSVGElement("clipPath");var u=document.createTextNode("");e.SVGClipRect=b;e.SVGText=d;e.SVGGWrapper=a;e.divText=h;e.clip=m;e.redactionText=u}else{var v=createBodyObject();var g=createSVGElement("foreignObject");var c=createSVGElement("rect");var q=document.createElement("div");e.body=v;e.foreignObj=g;e.SVGRectangle=c;e.divText=q}e.retrieveShapeForCalculation=function(){return this.SVGRectangle};e.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGRectangle.parentNode);return transformed};break;case markupTypes.Text:var c=createSVGElement("rect");e.SVGRectangle=c;if(isIE){var b=createSVGElement("rect");var d=createSVGElement("text");var a=createSVGElement("g");var h=createSVGElement("tspan");var m=createSVGElement("clipPath");e.SVGClipRect=b;e.SVGText=d;e.SVGGWrapper=a;e.divText=h;e.clip=m}else{var v=createBodyObject();var g=createSVGElement("foreignObject");var q=document.createElement("div");
var n=document.createElement("p");e.body=v;e.foreignObj=g;e.divText=q;e.para=n}e.retrieveShapeForCalculation=function(){return this.SVGRectangle};e.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGRectangle.parentNode);return transformed};break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:var c=createSVGElement("rect");e.SVGRectangle=c;e.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGRectangle.parentNode);return transformed};e.retrieveShapeForCalculation=function(){return this.SVGRectangle};break}e.group=l;if(s!=isIE){isIE=s}return e}function initializePreDrawProcess(d,a,c,e,f){var b=JSON.parse(JSON.stringify(isIE));if(f!=undefined){isIE=f}var g=a.attributes.id;switch(d){case markupTypes.Circle:appendObjectToDom(a.shapes.group,a.shapes.SVGEllipse);break;case markupTypes.Rectangle:case markupTypes.SearchHighlight:appendObjectToDom(a.shapes.group,a.shapes.SVGRectangle);break;case markupTypes.Line:appendObjectToDom(a.shapes.group,a.shapes.SVGLine);
break;case markupTypes.Arrow:createArrowHead(a.shapes.SVGArrowHead,g);changeArrowHeadSize(a.shapes.SVGArrowHead,a.shapes.SVGPath,a.attributes);appendObjectToDom(a.shapes.SVGArrowHead,a.shapes.SVGPath);appendObjectToDom(a.shapes.group,a.shapes.circleMask);a.shapes.circleMask.setAttributeNS(null,"data-isi","annotation-"+(g));a.shapes.circleMask.setAttributeNS(null,"fill","transparent");a.shapes.circleMask.setAttributeNS(null,"stroke","transparent");break;case markupTypes.Text:setDefaultTextStyle(a);if(isIE){appendObjectToDom(a.shapes.SVGText,a.shapes.divText);appendObjectToDom(a.shapes.clip,a.shapes.SVGClipRect);appendObjectToDom(a.shapes.SVGGWrapper,a.shapes.clip);appendObjectToDom(a.shapes.SVGGWrapper,a.shapes.SVGText);appendObjectToDom(a.shapes.group,a.shapes.SVGRectangle);appendObjectToDom(a.shapes.group,a.shapes.SVGGWrapper);a.shapes.divText.textContent="";a.shapes.divText.setAttributeNS(null,"class","wrapText");a.shapes.clip.setAttributeNS(null,"id","UDV"+(g));a.shapes.clip.setAttributeNS(null,"clipPathUnits","userSpaceOnUse");
a.shapes.SVGGWrapper.setAttributeNS(null,"style","display: block;");a.shapes.SVGGWrapper.setAttributeNS(null,"data-isi","annotation-"+(g));a.shapes.SVGGWrapper.setAttribute("clip-path","url(#UDV"+g+")");lastDrawnDivReason=a.shapes.divText}else{appendObjectToDom(a.shapes.body,a.shapes.divText);appendObjectToDom(a.shapes.foreignObj,a.shapes.body);appendObjectToDom(a.shapes.divText,a.shapes.para);appendObjectToDom(a.shapes.group,a.shapes.SVGRectangle);appendObjectToDom(a.shapes.group,a.shapes.foreignObj);a.shapes.foreignObj.setAttributeNS(null,"style","overflow:hidden;position:absolute;z-index:-1;");a.shapes.para.setAttributeNS(null,"style","word-break:break-all");lastDrawnDivReason=a.shapes.para}break;case markupTypes.RectangleRedaction:setDefaultRedactionStyle(a,isIE);if(isIE){appendObjectToDom(a.shapes.SVGText,a.shapes.divText);appendObjectToDom(a.shapes.clip,a.shapes.SVGClipRect);appendObjectToDom(a.shapes.divText,a.shapes.redactionText);appendObjectToDom(a.shapes.group,a.shapes.SVGRectangle);
appendObjectToDom(a.shapes.group,a.shapes.SVGGWrapper);appendObjectToDom(a.shapes.SVGGWrapper,a.shapes.clip);appendObjectToDom(a.shapes.SVGGWrapper,a.shapes.SVGText);a.shapes.redactionText.data=e;a.shapes.divText.setAttributeNS(null,"data-isi","redaction-"+(g));a.shapes.clip.setAttributeNS(null,"id","UDV"+(g));a.shapes.clip.setAttributeNS(null,"clipPathUnits","userSpaceOnUse");a.shapes.SVGRectangle.setAttributeNS(null,"data-isi","redaction-"+(g));a.shapes.SVGClipRect.setAttributeNS(null,"data-isi","redaction-"+(g));a.shapes.SVGGWrapper.setAttribute("clip-path","url(#UDV"+g+")")}else{appendObjectToDom(a.shapes.body,a.shapes.divText);appendObjectToDom(a.shapes.foreignObj,a.shapes.body);appendObjectToDom(a.shapes.group,a.shapes.SVGRectangle);appendObjectToDom(a.shapes.group,a.shapes.foreignObj)}break}appendObjectToDom(c,a.shapes.group);if(b!=isIE){isIE=b}}function appendObjectToDom(b,a){b.appendChild(a)}function removeObjectFromDom(b,a){b.removeChild(a)}function setDefaultTextStyle(a){var b=isIE?a.shapes.SVGText:a.shapes.divText;
b.setAttribute("style","resize: none; word-wrap: break-word; display: table-cell; white-space: normal; background-color: transparent;")}function setDefaultRedactionStyle(a,b){if(b){object=a.shapes.SVGText;object.setAttribute("class","redactionReason");object.setAttributeNS(null,"text-decoration","none");object.setAttributeNS(null,"style","fill:rgba(255, 255, 255, 1)");object.setAttributeNS(null,"data-isi","redaction-"+(markupId));object.setAttributeNS(null,"text-anchor","middle");object.setAttributeNS(null,"font-family","Arial");object.setAttributeNS(null,"font-size","12");object.setAttributeNS(null,"font-style","normal");object.setAttributeNS(null,"font-weight","normal")}else{object=a.shapes.divText;object.setAttribute("class","redactionReason");a.setTextAttribute(object,"wordWrap","break-word");a.setTextAttribute(object,"fontFamily","Arial");a.setTextAttribute(object,"fontSize","12px");a.setTextAttribute(object,"textAlign","center");a.setTextAttribute(object,"display","table-cell");a.setTextAttribute(object,"whiteSpace","normal");
a.setTextAttribute(object,"verticalAlign","middle");a.setTextAttribute(object,"backgroundColor","transparent")}}function createArrowHead(a,b){a.setAttributeNS(null,"viewBox","0 0 10 10");a.setAttributeNS(null,"refX","0.1");a.setAttributeNS(null,"refY","5");a.setAttributeNS(null,"markerUnits","userSpaceOnUse");a.setAttributeNS(null,"orient","auto");a.setAttributeNS(null,"id","arrowhead-"+b);a.setAttributeNS(null,"data-isi","annotation-"+b)}function initStartPosition(u){var r={};var y=(u.target.correspondingUseElement)?u.target.correspondingUseElement:u.target;var a=false;var d=false;var x=retrievePageNumber(y);var A=$(getElement("viewer-document-wrapper"));var b=A.children(".pageContent").filter(":nth-child("+(x)+")");var w=b.width();var g=b.height();var o=documentViewer.annotationToolBox[markupTypes.RectangleRedaction].reason;if(isFirefox&&y.tagName!="INPUT"){u.preventDefault()}if(x>-1){if(pageCollection[(x-1)].isErroredPage==true){return}var k=pageCollection[(x-1)].attributes.rotateDegrees;
var v=pageCollection[x-1].svgPage;var B=convertToSVGCoordinateSpace(v,u.clientX,u.clientY);var t=B.x;var s=B.y;var p=pageCollection[x-1];var q=p.svgMarkupGroup;r=createDrawnObject(annotationObject);r.setId(markupId);initializePreDrawProcess(annotationObject,r,q,o);switch(k){case 0:case 360:default:initialX=t;initialY=s;break;case 90:initialX=s;initialY=parseFloat(w-t);break;case 180:initialX=parseFloat(w-t);initialY=parseFloat(g-s);break;case 270:initialX=parseFloat(g-s);initialY=t;break}initialX=initialX*(1/scaleFactor);initialY=initialY*(1/scaleFactor);a=true;var c=$(getElement("viewerContainer"));var l=parseInt(c.position().top),z=parseInt(c.position().left),i=parseInt(c.outerWidth()),n=parseInt(c.outerHeight());n+=l;var f=function(I){if(isFirefox){I.preventDefault();if(I.clientY>=(n-30)){c.scrollTop(c.scrollTop()+30)}else{if(I.clientY<=(l+30)){c.scrollTop(c.scrollTop()-30)}else{if(I.clientX>(i-30)){c.scrollLeft(c.scrollLeft()+30)}else{if(I.clientX<=(z+30)){c.scrollLeft(c.scrollLeft()-30)
}}}}}d=isMouseWithinPageBoundary(B,w,g);if(a){var R=v.createSVGPoint();R.x=I.clientX;R.y=I.clientY;B=R.matrixTransform(v.getScreenCTM().inverse());var L=0;var J=0;var P=B.x;var N=B.y;switch(k){case 0:case 360:default:L=P;J=N;break;case 90:L=N;J=parseFloat(w-P);break;case 180:L=parseFloat(w-P);J=parseFloat(g-N);break;case 270:L=parseFloat(g-N);J=P;break}P=P*(1/scaleFactor);N=N*(1/scaleFactor);L=L*(1/scaleFactor);J=J*(1/scaleFactor);var E=0,O=0,G=0,F=0,M=initialX,K=initialY;switch(k){case 0:case 360:default:E=parseFloat(L-initialX);O=parseFloat(J-initialY);G=parseFloat((L+initialX)/2);F=parseFloat((J+initialY)/2);if(E<0){E=parseFloat(initialX-L);M=M-E}if(O<0){O=parseFloat(initialY-J);K=K-O}break;case 90:E=parseFloat(N-initialX);O=parseFloat(J-initialY);G=parseFloat((L+initialX)/2);F=parseFloat((J+initialY)/2);if(E<0){E=parseFloat(initialX-N);M=M-E}if(O<0){O=parseFloat(initialY-J);K=K-O}break;case 180:E=parseFloat(L-initialX);O=parseFloat(J-initialY);G=parseFloat((L+initialX)/2);F=parseFloat((J+initialY)/2);
if(E<0){E=parseFloat(initialX-L);M=M-E}if(O<0){O=parseFloat(initialY-J);K=K-O}break;case 270:E=parseFloat(L-initialX);O=parseFloat(P-initialY);G=parseFloat((L+initialX)/2);F=parseFloat((P+initialY)/2);if(E<0){E=parseFloat(initialX-L);M=M-E}if(O<0){O=parseFloat(initialY-P);K=K-O}break}var Q=documentViewer.annotationToolBox[annotationObject];switch(annotationObject){case markupTypes.Circle:if(d){var D=parseFloat((E)/2);var C=parseFloat((O)/2);r.setCX(G);r.setCY(F);r.setRX(D);r.setRY(C);r.setFillColor(Q.fillColor);r.setBorderColor(Q.borderColor);r.setBorderWeight(Q.borderWeight);r.setOpacity(Q.opacityLevelDecimal)}break;case markupTypes.Rectangle:if(d){r.setX(M);r.setY(K);r.setWidth(E);r.setHeight(O);r.setFillColor(Q.fillColor);r.setBorderColor(Q.borderColor);r.setBorderWeight(Q.borderWeight);r.setOpacity(Q.opacityLevelDecimal)}break;case markupTypes.SearchHighlight:if(d){r.setX(M);r.setY(K);r.setWidth(E);r.setHeight(O);r.setFillColor(defaultHighlightColor);r.setBorderColor(Q.borderColor);
r.setBorderWeight(Q.borderWeight);r.setOpacity(Q.opacityLevelDecimal)}break;case markupTypes.Line:if(d){r.setX1(initialX);r.setY1(initialY);r.setX2(L);r.setY2(J);r.setFillColor(Q.fillColor);r.setBorderWeight(Q.borderWeight);r.setOpacity(Q.opacityLevelDecimal)}break;case markupTypes.Arrow:if(d){r.setX1(initialX);r.setY1(initialY);r.setX2(L);r.setY2(J);r.setCircMaskCX(L);r.setCircMaskCY(J);r.setCircMaskRX(12);r.setCircMaskRY(12);r.setFillColor(Q.fillColor);r.setBorderWeight(Q.borderWeight);r.setOpacity(Q.opacityLevelDecimal);r.setMarkerEnd("url(#arrowhead-"+markupId+")");appendObjectToDom(r.shapes.group,r.shapes.SVGArrowHead);appendObjectToDom(r.shapes.group,r.shapes.SVGLine)}break;case markupTypes.Text:if(d){r.shapes.SVGRectangle.setAttributeNS(null,"style","z-index:-1;position:absolute;");r.setX(M);r.setY(K);r.setWidth(E);r.setHeight(O);r.setFillColor(Q.fillColor);r.setBorderColor(Q.borderColor);r.setBorderWeight(Q.borderWeight);r.setOpacity(Q.opacityLevelDecimal);r.setFontColor(Q.fontColor);
r.setFontFamily(Q.fontFamily);r.setFontSize(Q.fontSize);r.setBoldStyle(Q.boldStyle?"bold":"normal");r.setItalicStyle(Q.italicStyle?"italic":"normal");r.setUnderlineStrikeStyle((Q.underlineStyle&&Q.strikeStyle)?"underline line-through":Q.underlineStyle?"underline":Q.strikeStyle?"line-through":"none");r.setHorizontalAlign(Q.horizontalAlign);r.setVerticalAlign(Q.verticalAlign);if(isIE){var H=null,h=0;switch(getSelectedHorizontalAlignment()){case"left":h=5;H="start";break;case"center":h=parseInt(E/2);H="middle";break;case"right":h=parseInt(E-5);H="end";break}r.shapes.SVGGWrapper.setAttributeNS(null,"transform","matrix(1 0 0 1 "+M+" "+K+")");r.setSVGTextValueX(h);r.setTextAnchor(H)}}break;case markupTypes.RectangleRedaction:if(d){r.shapes.group.setAttributeNS(null,"data-isi","redaction-"+(markupId));r.setX(M);r.setY(K);r.setWidth(E);r.setHeight(O);r.setFontColor("rgb(255, 255, 255)");r.setFillColor("rgb(0, 0, 0)");r.visibilityMode=visibilityMode.Shown;r.setOpacity(1);r.setText(o);r.rotateTextObject(k)
}break}readyToDraw=false}};var j=function m(){if(isFirefox){u.preventDefault()}attachSnapToDrag(r.shapes.group);if(tempId!=markupId&&!readyToDraw){pageCollection[x-1].addMarkupObject(r);var e=pageCollection[x-1].markups.indexOf(r);if(annotationObject==markupTypes.Text){showTextArea(r.shapes.SVGRectangle)}else{if(annotationObject==markupTypes.RectangleRedaction){showHideRedactedFileContent(r,x)}}tempId=markupId}a=false;if(!readyToDraw){document.removeEventListener("mousedown",initStartPosition,false)}document.removeEventListener("mousemove",f,false);document.removeEventListener("mouseup",m,false);dedactiveAnnotation();var h=$(getElement("page-handtool"));if(h.data("laststate")==true){h.data("drag","enable").addClass("selected-tool");A.dragScroll()}reenableDrawing(annotationObject)};document.addEventListener("mousemove",f,false);document.addEventListener("mouseup",j,false)}}function reenableDrawing(b){readyToDraw=false;var g=$("#addRedact"),e=$("#addArrow"),c=$("#addLine"),d=$("#addSquare"),f=$("#addCircle"),a=$("#addText");
if($("#annotationInfiniteBtn").hasClass("ann-infinite-app-btn active-state")){switch(b){case markupTypes.Line:c.mouseup();break;case markupTypes.Arrow:e.mouseup();break;case markupTypes.Circle:f.mouseup();break;case markupTypes.Rectangle:d.mouseup();break;case markupTypes.Text:viewerWrapper.addClass("cursorCrosshair");$(a).addClass("selected-tool");break;case markupTypes.SearchHighlight:break;default:break}}if($("#redactionInfiniteBtn").hasClass("red-infinite-app-btn active-state")){switch(b){case markupTypes.RectangleRedaction:g.mouseup();break}}}function attachSnapToDrag(b){var a=$(getElement("viewer-document-wrapper"));var c=new Snap(b);c.drag();a.removeClass("cursorCrosshair");c.drag(function(){},function(){var d=$(getElement("page-handtool"));var e=document.getElementById("page-handtool");e.setAttributeNS(null,"data-drag","unable");d.data("drag","unable").removeClass("selected-tool");a.removeDragScroll();a.css("cursor","move")},function(){var e=document.getElementById("page-handtool");
var d=$(getElement("page-handtool"));if(d.data("laststate")==true){d.data("drag","enable").addClass("selected-tool");a.dragScroll()}else{a.css("cursor","default")}})}function showHideRedactedFileContent(a,b){if(isIE){a.resetViewable=function(){var d=a.shapes.SVGText.getAttributeNS(null,"data-isi");var e=parseInt(d.substring(d.indexOf("-")+1,d.length));var g=pageCollection[b-1];var f=g.retrieveMarkObjectInPage(e);var c=(f.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;f.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(c*100)+")";f.setShapeAttribute(f.shapes.SVGRectangle,"fill","rgba(0, 0, 0, "+c+")");f.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(c*100)+")";f.shapes.SVGText.style.fill="rgba(255, 255, 255, "+c+")"};a.shapes.SVGText.addEventListener("mouseover",function(g){var c=this.getAttributeNS(null,"data-isi");var d=parseInt(c.substring(c.indexOf("-")+1,c.length));var h=pageCollection[b-1];
if(!h.isMarkupSelected(d)){var f=h.retrieveMarkObjectInPage(d);f.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";f.setShapeAttribute(f.shapes.SVGRectangle,"fill","rgba(0, 0, 0, 0.2)");f.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";f.shapes.SVGText.style.fill="rgba(255, 255, 255, 0)"}},false);a.shapes.SVGText.addEventListener("mouseout",function(h){var d=this.getAttributeNS(null,"data-isi");var f=parseInt(d.substring(d.indexOf("-")+1,d.length));var i=pageCollection[b-1];var g=i.retrieveMarkObjectInPage(f);var c=(g.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;g.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";g.setShapeAttribute(g.shapes.SVGRectangle,"fill","rgba(0, 0, 0, "+c+")");g.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(c*100)+")";g.shapes.SVGText.style.fill="rgba(255, 255, 255, "+c+")"},false);
a.shapes.SVGRectangle.addEventListener("mouseover",function(g){var c=this.getAttributeNS(null,"data-isi");var d=parseInt(c.substring(c.indexOf("-")+1,c.length));var h=pageCollection[b-1];if(!h.isMarkupSelected(d)){var f=h.retrieveMarkObjectInPage(d);f.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";f.setShapeAttribute(f.shapes.SVGRectangle,"fill","rgba(0, 0, 0, 0.2)");f.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";f.shapes.SVGText.style.fill="rgba(255, 255, 255, 0)"}},false);a.shapes.SVGRectangle.addEventListener("mouseout",function(h){var d=this.getAttributeNS(null,"data-isi");var f=parseInt(d.substring(d.indexOf("-")+1,d.length));var i=pageCollection[b-1];var g=i.retrieveMarkObjectInPage(f);var c=(g.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;g.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";g.setShapeAttribute(g.shapes.SVGRectangle,"fill","rgba(0, 0, 0, "+c+")");
g.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(c*100)+")";g.shapes.SVGText.style.fill="rgba(255, 255, 255, "+c+")"},false)}else{a.resetViewable=function(){var d=a.shapes.divText.getAttributeNS(null,"data-isi");var e=parseInt(d.substring(d.indexOf("-")+1,d.length));var g=pageCollection[b-1];var f=g.retrieveMarkObjectInPage(e);var c=(f.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;f.shapes.divText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(c*100)+")";f.shapes.divText.style.color="rgba(255, 255, 255, "+c+")";if(isSafari){f.setShapeAttribute(f.shapes.SVGRectangle,"fill-opacity",c)}else{f.setShapeAttribute(f.shapes.SVGRectangle,"fill","rgba(0, 0, 0, "+c+")")}};a.shapes.divText.addEventListener("mouseover",function(g){var c=this.getAttributeNS(null,"data-isi");var d=parseInt(c.substring(c.indexOf("-")+1,c.length));var h=pageCollection[b-1];if(!h.isMarkupSelected(d)){var f=h.retrieveMarkObjectInPage(d);
f.shapes.divText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";f.shapes.divText.style.color="rgba(255, 255, 255, 0)";if(isSafari){f.setShapeAttribute(f.shapes.SVGRectangle,"fill-opacity","0.2")}else{f.setShapeAttribute(f.shapes.SVGRectangle,"fill","rgba(0, 0, 0, 0.2)")}}},false);a.shapes.divText.addEventListener("mouseout",function(h){var d=this.getAttributeNS(null,"data-isi");var f=parseInt(d.substring(d.indexOf("-")+1,d.length));var i=pageCollection[b-1];var g=i.retrieveMarkObjectInPage(f);var c=(g.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;g.shapes.divText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(c*100)+")";g.shapes.divText.style.color="rgba(255, 255, 255, "+c+")";if(isSafari){g.setShapeAttribute(g.shapes.SVGRectangle,"fill-opacity",c)}else{g.setShapeAttribute(g.shapes.SVGRectangle,"fill","rgba(0, 0, 0, "+c+")")}},false);a.shapes.SVGRectangle.addEventListener("mouseout",function(h){var d=this.getAttributeNS(null,"data-isi");
var f=parseInt(d.substring(d.indexOf("-")+1,d.length));var i=pageCollection[b-1];var g=i.retrieveMarkObjectInPage(f);var c=(g.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;g.shapes.divText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(c*100)+")";g.shapes.divText.style.color="rgba(255, 255, 255, "+c+")";if(isSafari){g.setShapeAttribute(g.shapes.SVGRectangle,"fill-opacity",c)}else{g.setShapeAttribute(g.shapes.SVGRectangle,"fill","rgba(0, 0, 0, "+c+")")}},false);a.shapes.SVGRectangle.addEventListener("mouseover",function(g){var c=this.getAttributeNS(null,"data-isi");var d=parseInt(c.substring(c.indexOf("-")+1,c.length));var h=pageCollection[b-1];if(!h.isMarkupSelected(d)){var f=h.retrieveMarkObjectInPage(d);f.shapes.divText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";f.shapes.divText.style.color="rgba(255, 255, 255, 0)";if(isSafari){f.setShapeAttribute(f.shapes.SVGRectangle,"fill-opacity","0.2")}else{f.setShapeAttribute(f.shapes.SVGRectangle,"fill","rgba(0, 0, 0, 0.2)")
}}},false)}}function getSelectedOpacity(a){return(document.getElementById(a).innerHTML.replace("%",""))/100}function getSelectedColor(b){var d=document.getElementById(b);var a=d.style.background;var c;if(a.indexOf("rgba(176, 176, 176, 0)")>-1){c="transparent"}else{c=d.style.backgroundColor}return c}function getSelectedWidth(a){return document.getElementById(a).innerHTML}$(function(){var t=new Dropdown(".arrowopacityPicker",".opacity-available-container"),m=new Dropdown(".arrowWidthPicker",".width-available-container"),k=$(".arrowcolorPickerBox"),b=$(".arrowopacityPicker"),a=$(".arrowWidthPicker"),h=$(".availableColors"),l=$(getElement("closeArrow")),i=$(getElement("resizeArrowAnnotate")),j=$(".ArrowControls"),r=$(".ArrowControls-contents"),g=$(getElement("viewer-arrowAnnotate")),e=$(getElement("arrow_delete")),s=$(getElement("ArrowStyle")),f=$(getElement("Arrow_index")),u=$(".arrowAnnotateStyle"),c=$(".arrowlayering-controls"),o=$(".arrowBringFront"),q=$(".arrowBringBack"),n=$(".arrowMoveFront"),p=$(".arrowMoveBack");
$(document).on("click",function(){b.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");k.children(".availableColors").removeClass("active")});b.on("click",function(){a.children(".width-available-container").removeClass("active");k.children(".availableColors").removeClass("active")});a.on("click",function(){b.children(".opacity-available-container").removeClass("active");k.children(".availableColors").removeClass("active")});k.on("click",function(){var v=$(this);v.children(".availableColors").addClass("active");b.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");return false});$(".opacity-holder").on({click:function(){var w=$(this),v=w.text();w.parent().siblings(".selectedArrowOpacity").children("span").text(v);if($(getElement("viewer-arrowAnnotate")).css("display")==="block"){setOpacity(getSingleSelectedObject(0),"arrow_fillOpacity")}}});
$(".width-holder").on({click:function(){var w=$(this),v=w.text();w.parent().siblings(".selectedArrowWidth").children("span").text(v);if($(getElement("viewer-arrowAnnotate")).css("display")==="block"){setWidth(getSingleSelectedObject(0),"arrow_fillWidth")}}});h.on("click","div",function(w){$(this).parent().removeClass("active");$(this).parent(".availableColors").siblings(".selectedColor").attr("style",$(this).attr("style"));if($(getElement("viewer-arrowAnnotate")).css("display")==="block"){if($(getElement("ArrowStyle")).hasClass("selected")){var v=getSingleSelectedObject(0).parentNode.lastChild;setAttributeColor("stroke",getSingleSelectedObject(0),"arrow_fillColor");setAttributeColor("fill",v,"arrow_fillColor")}}return false});i.on("click",function(){var v=$(this);if(v.data("resize")=="minimize"){j.css("display","none");r.css("display","none");e.css("display","none");g.animate({width:"35px"},500,function(){v.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize")
})}else{if(v.data("resize")=="maximize"){g.animate({width:"284px"},500,function(){j.css("display","block");r.css("display","block");e.css("display","block");v.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")})}}});s.on({mousedown:function(){var v=$(this);v.siblings("img").removeClass("selected").end().addClass("selected");u.css("display","block");c.css("display","none")}});f.on({mousedown:function(){var v=$(this);v.siblings("img").removeClass("selected").end().addClass("selected");u.css("display","none");c.css("display","block")}});l.on("click",function(){if(!g.is(":animated")){if(i.data("resize")=="maximize"){g.css({width:"284px"});i.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")}e.css("display","block");j.css("display","block");r.css("display","block");g.css("display","none");d()}});function d(){var w=$(getElement("viewer-document-wrapper")),v=w.children(".pageContent");$(getElement("addArrow")).data("active",false).removeClass("selected-tool");
v.removeClass("cursorCrosshair")}e.on({mouseup:function(){deleteSingleMarkup();removeSingleMarkupInArray();clearAllHandles()}});o.on("click",function(){var v=getSelectedObjectGroup();if(v){layerAnnotationObject(v,layerOptions.Top)}});q.on("click",function(){var v=getSelectedObjectGroup();if(v){layerAnnotationObject(v,layerOptions.Bottom)}});n.on("click",function(){var v=getSelectedObjectGroup();if(v){layerAnnotationObject(v,layerOptions.Forward)}});p.on("click",function(){var v=getSelectedObjectGroup();if(v){layerAnnotationObject(v,layerOptions.Backward)}})});$(function(){var u=new Dropdown(".circleWidthPicker",".width-available-container"),n=new Dropdown(".circleopacityPicker",".opacity-available-container"),l=$(".circlecolorPickerBox"),d=$(".circleopacityPicker"),a=$(".circleWidthPicker"),i=$(".availableColors"),m=$("#closeCircle"),j=$("#resizeCircleAnnotate"),k=$(".CircleControls"),s=$(".CircleControls-contents"),h=$("#viewer-circleAnnotate"),p=$("#circle_delete"),t=$("#CircleStyle"),g=$("#Circle_index"),q=$("#CircleB"),v=$(".circleAnnotateStyle"),e=$(".circlelayering-controls"),c=$(".circleborder-controls"),w=$(".circleBringFront"),o=$(".circleBringBack"),b=$(".circleMoveFront"),r=$(".circleMoveBack");
$(document).on("click",function(){d.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");l.children(".availableColors").removeClass("active")});d.on("click",function(){a.children(".width-available-container").removeClass("active");l.children(".availableColors").removeClass("active")});a.on("click",function(){d.children(".opacity-available-container").removeClass("active");l.children(".availableColors").removeClass("active")});l.on("click",function(){var x=$(this);x.children(".availableColors").addClass("active");d.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");return false});$(".opacity-holder").on({click:function(){var y=$(this),x=y.text();y.parent().siblings(".selectedCircleOpacity").children("span").text(x);if($("#viewer-circleAnnotate").css("display")==="block"){setOpacity(getSingleSelectedObject(0),"circle_fillOpacity")}}});$(".width-holder").on({click:function(){var y=$(this),x=y.text();
y.parent().siblings(".selectedCircleWidth").children("span").text(x);if($("#viewer-circleAnnotate").css("display")==="block"){setWidth(getSingleSelectedObject(0),"circle_borderWidth")}}});i.on("click","div",function(x){$(this).parent().removeClass("active");$(this).parent(".availableColors").siblings(".selectedColor").attr("style",$(this).attr("style"));if($("#viewer-circleAnnotate").css("display")==="block"){if($("#CircleB").hasClass("selected")){setAttributeColor("stroke",getSingleSelectedObject(0),"circle_borderColor")}if($("#CircleStyle").hasClass("selected")){setAttributeColor("fill",getSingleSelectedObject(0),"circle_fillColor")}}return false});j.on("click",function(){var x=$(this);if(x.data("resize")=="minimize"){k.css("display","none");s.css("display","none");p.css("display","none");h.animate({width:"35px"},500,function(){x.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize")})}else{if(x.data("resize")=="maximize"){h.animate({width:"284px"},500,function(){k.css("display","block");
s.css("display","block");p.css("display","block");x.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")})}}});t.on({mousedown:function(){var x=$(this);x.siblings("img").removeClass("selected").end().addClass("selected");v.css("display","block");e.css("display","none");c.css("display","none")}});g.on({mousedown:function(){var x=$(this);x.siblings("img").removeClass("selected").end().addClass("selected");v.css("display","none");e.css("display","block");c.css("display","none")}});q.on({mousedown:function(){var x=$(this);x.siblings("img").removeClass("selected").end().addClass("selected");v.css("display","none");e.css("display","none");c.css("display","block")}});m.on("click",function(){if(!h.is(":animated")){if(j.data("resize")=="maximize"){h.css({width:"284px"});j.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")}p.css("display","block");k.css("display","block");s.css("display","block");h.css("display","none");
f()}});function f(){var y=$("#viewer-document-wrapper"),x=y.children(".pageContent");$("#addCircle").data("active",false).removeClass("selected-tool");x.removeClass("cursorCrosshair")}p.on({mouseup:function(){deleteSingleMarkup();removeSingleMarkupInArray();clearAllHandles()}});w.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Top)}});o.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Bottom)}});b.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Forward)}});r.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Backward)}})});var hoverRedactionReason=function(){var a=$(this);a.addClass("hoveredSelect")},outRedactionReason=function(){var a=$(this);a.removeClass("hoveredSelect")},selectRedactionReason=function(){var e=$(this),d=e.text();e.parent().siblings(".selected-reason").children("span").text(d);var b=getSingleSelectedMarkupObject(0);
var a,c=0,f;if(b){b.setText(d);if(isIE){c=b.shapes.SVGRectangle.getAttribute("width");f=b.shapes.SVGText;clearChildren(f);processWrapping(f,d,redactionFontSize,c,b.id,(c/2));b.shapes.redactionText.data=d}else{b.shapes.divText.innerHTML=d}}documentViewer.annotationToolBox[markupTypes.RectangleRedaction].reason=d};function createSVGElement(a){return document.createElementNS(svgNamespace,a)}function populateAttributes(c,a){for(var b in a){if(a.hasOwnProperty(b)){c.setAttribute(b,a[b].toString())}}}function convertToSVGCoordinateSpace(d,a,e){var c=d.createSVGPoint();c.x=a;c.y=e;var b=c.matrixTransform(d.getScreenCTM().inverse());return b}function retrievePageNumber(c){var d=c.parentNode,a=-1,b;while((d&&d.id&&d.id.indexOf(pagePrefix)==-1)||(d&&!d.id)){d=d.parentNode}if(d&&d.id){b=d.id;a=b.substring(b.indexOf("_page_")+6,b.length)}return a}function createBodyObject(){var a=document.createElementNS("http://www.w3.org/1999/xhtml","body");populateAttributes(a,{xmlns:"http://www.w3.org/1999/xhtml",style:"display:table; width: 100%;table-layout: fixed;margin:0"});
return a}function clearMarkupHandle(a){var b=a.parentHandle;var c=b.parentNode;clearChildren(b);c.removeChild(b)}function clearChildren(a){if(a){while(a.firstChild){a.removeChild(a.firstChild)}}}function selectAnnotationObject(u){var w=(u.target.correspondingUseElement)?u.target.correspondingUseElement:u.target;var d=w.getAttribute("data-isi"),a;var n=$(getElement("addRedact")),b=$(getElement("addArrow")),f=$(getElement("addLine")),c=$(getElement("addSquare")),t=$(getElement("addCircle")),i=$(getElement("addText")),p=$(getElement("page-handtool"));var q=$(getElement("viewer-redactbox")),h=$(getElement("deleteMultiple")),r=$(getElement("viewer-annotateBox"));var v=retrievePageNumber(w)-1;if(d&&!readyToDraw){var o=pageCollection[v];var j=parseInt(d.substring(d.indexOf("-")+1,d.length));var m=o.retrieveMarkObjectInPage(j);var l=o.isMarkupSelected(j);if(u.shiftKey||u.ctrlKey){transferTextAreaValuetoDiv(lastSelectedDivReason);if(!l&&(d.indexOf("annotation")>-1||d.indexOf("redaction")>-1)){a=applyHandles(m,o);
o.selectMarkup(j,a)}else{if(d.indexOf("outline")>-1||(d.indexOf("annotation")>-1||d.indexOf("redaction")>-1)&&l){o.deSelectMarkup(j)}}}else{transferTextAreaValuetoDiv(lastSelectedDivReason);if(!l&&(d.indexOf("annotation")>-1)||d.indexOf("redaction")>-1){if(selectedPages.length>0){while(selectedPages.length>0){var k=selectedPages[0];pageCollection[k].clearAllSelectedMarkups(k)}}if(!$(viewerWrapper).hasClass("cursorCrosshair")){o.clearAllSelectedMarkups(v);console.log("applyHandles second");a=applyHandles(m,o);o.selectMarkup(j,a)}}}if(selectedObjectCollection.length===1){var g=selectedObjectCollection[0];var x=pageCollection[g.pageId];var s=x.retrieveMarkObjectInPage(g.markupId);documentViewer.setCurrentSelectedMarkup(s.markupType);switch(s.markupType){case markupTypes.Circle:activeAnnotation(t,r);break;case markupTypes.Rectangle:activeAnnotation(c,r);break;case markupTypes.Line:activeAnnotation(f,r);break;case markupTypes.RectangleRedaction:s.resetViewable();activeAnnotation(n,q);break;case markupTypes.Arrow:activeAnnotation(b,r);
break;case markupTypes.Text:activeAnnotation(i,r);break}setToolBoxValues(s.markupType);activateTab(s.markupType);curSelectedMarkup=s;h.css("display","none")}else{if(selectedObjectCollection.length>1){h.css("display","block")}else{h.css("display","none")}dedactiveAnnotation()}}else{if(!d&&v>=0){if(w.getAttribute("id")!="textAreaContainer"){transferTextAreaValuetoDiv(lastSelectedDivReason)}if(v>-1){if(!(u.shiftKey||u.ctrlKey)){if(selectedPages.length>0){while(selectedPages.length>0){var k=selectedPages[0];pageCollection[k].clearAllSelectedMarkups(k)}}}}if(!(u.shiftKey||u.ctrlKey)){dedactiveAnnotation();h.css("display","none")}}}}function selectObject(){var m=$(getElement("addRedact")),c=$(getElement("addArrow")),l=$(getElement("addLine")),e=$(getElement("addSquare")),f=$(getElement("addCircle")),i=$(getElement("addText")),a=$(getElement("page-handtool"));var g=$(getElement("viewer-redactbox")),b=$(getElement("deleteMultiple")),d=$(getElement("viewer-annotateBox"));if(selectedObjectCollection.length===1){var j=selectedObjectCollection[0];
var h=pageCollection[j.pageId];var k=h.retrieveMarkObjectInPage(j.markupId);documentViewer.setCurrentSelectedMarkup(k.markupType);switch(k.markupType){case markupTypes.Circle:activeAnnotation(f,d);break;case markupTypes.Rectangle:activeAnnotation(e,d);break;case markupTypes.Line:activeAnnotation(l,d);break;case markupTypes.RectangleRedaction:k.resetViewable();activeAnnotation(m,g);break;case markupTypes.Arrow:activeAnnotation(c,d);break;case markupTypes.Text:activeAnnotation(i,d);break}setToolBoxValues(k.markupType);activateTab(k.markupType);curSelectedMarkup=k;b.css("display","none")}else{if(selectedObjectCollection.length>1){b.css("display","block")}else{b.css("display","none")}dedactiveAnnotation()}}function retrieveSelectedMarkup(){if(selectedObject.pageIndex>-1&&selectedObject.markupIndex>-1){var a=pageCollection[pageIndex];return a.retrieveMarkObjectInPage(markupIndex)}return null}function activeAnnotation(g,k){var s=$(getElement("viewer-document-wrapper")),a=s.children(".pageContent");
var m=$(".annotateBoxTab"),d=$(getElement("arrowTab")),o=$(getElement("lineTab")),e=$(getElement("rectTab")),i=$(getElement("circleTab")),n=$(getElement("textTab")),b=$(getElement("textstyleTab")),r=$(getElement("textAlignTab")),f=$(getElement("verticalAlignTab")),j=$(getElement("layerTab")),q=$(getElement("rectBorderTab")),l=$(getElement("circleBorderTab")),c=$(getElement("Redact_index")),p=$(getElement("Redact_fill"));g.siblings().data("active",false).removeClass("selected-tool");g.data("active",false).removeClass("selected-tool");a.removeClass("cursorCrosshair");k.siblings().css("display","none").end().css("display","block");$(".annotateBoxTab").children("img").css("display","none").removeClass("selected").removeClass("standBy");var h=g.data("annotate");switch(h){case markupTypes.Arrow:d.siblings().removeClass("standBy selected").end().addClass("standBy selected");j.addClass("standBy");d.trigger("click");break;case markupTypes.Line:o.siblings().removeClass("standBy selected").end().addClass("standBy selected");
j.addClass("standBy");o.trigger("click");break;case markupTypes.Rectangle:e.siblings().removeClass("standBy selected").end().addClass("standBy selected");q.addClass("standBy");j.addClass("standBy");e.trigger("click");break;case markupTypes.Circle:i.siblings().removeClass("standBy selected").end().addClass("standBy selected");l.addClass("standBy");j.addClass("standBy");i.trigger("click");break;case markupTypes.Text:e.siblings().removeClass("standBy selected").end().addClass("standBy selected");q.addClass("standBy");n.addClass("standBy");b.addClass("standBy");r.addClass("standBy");f.addClass("standBy");j.addClass("standBy");e.trigger("click");break;case markupTypes.RectangleRedaction:c.css("display","block");p.trigger("mousedown");break}}function hideTabContent(){tabContent.children("div").css("display","none").removeClass("standBy");hideDropDown()}function hideDropDown(){tabContent.children("div").children("div").each(function(){if($(this).hasClass("active")){$(this).removeClass("active")
}})}function dedactiveAnnotation(){var g=$(getElement("addRedact")),e=$(getElement("addArrow")),c=$(getElement("addLine")),d=$(getElement("addSquare")),f=$(getElement("addCircle")),b=$(getElement("addText"));var a=$(getElement("viewer-redactbox")),h=$(getElement("viewer-annotateBox"));if(!viewerWrapper.hasClass("cursorCrosshair")){g.data("active",false).removeClass("selected-tool");e.data("active",false).removeClass("selected-tool");c.data("active",false).removeClass("selected-tool");d.data("active",false).removeClass("selected-tool");f.data("active",false).removeClass("selected-tool");b.data("active",false).removeClass("selected-tool")}a.css("display","none");h.css("display","none")}function clearAllHandles(){var a=pageCollection.length;for(var b=0;b<a;b++){if(pageCollection[b].selectedMarkupIds.length>0){pageCollection[b].clearAllSelectedMarkups(b)}}}function computeRelativePageDimensions(a){var c={height:0,width:0},d;for(var b=0;b<a;b++){d=pageCollection[b].rotatedDimensions();c.height+=d.height;
c.width+=d.width}return c}function computeCoordinates(k,i,j,d){var b={x:k,y:i},g=$(getElement("viewer-document-wrapper")).closest("div#viewerContainer"),h=document.getElementById("udv_page_"+(d+1)),f=j.height,l=j.width,e=10*d,a=h.offsetTop-((f*(scaleFactor))+e),c=h.offsetLeft;i-=a-g.scrollTop();i=i-((f*(scaleFactor)))-((10*d));k-=c-g.scrollLeft();b.x=k;b.y=i;return b}function calculateLeftAndTop(b){var d={left:0,top:0,width:0,height:0};var k=b;var g={left:0,top:0};g=k.getBoundingClientRect();var l=document,c=l.documentElement,h=document.body,i=window,f=c.clientTop||h.clientTop||0,j=c.clientLeft||h.clientLeft||0,a=i.pageYOffset||jQuery.support.boxModel&&c.scrollTop||h.scrollTop,e=i.pageXOffset||jQuery.support.boxModel&&c.scrollLeft||h.scrollLeft;d.top=g.top+a-f,d.left=g.left+e-j;d.height=k.getBoundingClientRect().height,d.width=k.getBoundingClientRect().width;return d}function calculatePosition(c,e,a){var b=calculateLeftAndTop(c);var d=computeCoordinates(b.left,b.top,e,a);b.left=d.x;b.top=d.y;
return b}function reCalculateHandles(a){var e=a.selectedMarkupIds.length;var d;clearChildren(a.divHandles);for(var c=0;c<e;c++){var b=a.retrieveMarkObjectInPage(a.selectedMarkupIds[c]);if(b){d=applyHandles(b,a);a.updateHandles(c,d)}}}function computeLineCoordinates(e,k,m,c){var n=document,b=n.documentElement,h=document.body,i=window,f=b.clientTop||h.clientTop||0,j=b.clientLeft||h.clientLeft||0,a=i.pageYOffset||jQuery.support.boxModel&&b.scrollTop||h.scrollTop,d=i.pageXOffset||jQuery.support.boxModel&&b.scrollLeft||h.scrollLeft;var g={};var o=k.createSVGPoint();var l=e.getScreenCTM();o.x=e.x1.animVal.value;o.y=e.y1.animVal.value;g.nw=o.matrixTransform(l);g.nw.x+=(d-j);g.nw.y+=(a-f);o.x=e.x2.animVal.value;o.y=e.y2.animVal.value;g.se=o.matrixTransform(l);g.se.x+=(d-j);g.se.y+=(a-f);return{pt1:computeCoordinates(g.nw.x,g.nw.y,m,c),pt2:computeCoordinates(g.se.x,g.se.y,m,c)}}function applyHandles(g,i){var a,e=i.attributes,b,h=i.divHandles,c,f=computeRelativePageDimensions(e.pageIndex);a=g.shapes.retrieveShapeForCalculation();
switch(g.markupType){case markupTypes.Line:case markupTypes.Arrow:var d=computeLineCoordinates(a,i.svgPage,f,e.pageIndex);c=resizeHandlesArrow(g,h,d.pt1.x,d.pt1.y,d.pt2.x,d.pt2.y,i);break;case markupTypes.Circle:b=calculatePosition(a,f,e.pageIndex);c=resizeHandles(g,h,b.left,b.top,b.height,b.width,i);break;case markupTypes.Text:case markupTypes.Rectangle:case markupTypes.RectangleRedaction:b=calculatePosition(a,f,e.pageIndex);c=resizeHandles(g,h,b.left,b.top,b.height,b.width,i);break}return c}function checkCollection(e,b){var d=selectedObjectCollection.length;for(var c=0;c<d;c++){var a=selectedObjectCollection[c];if(a.markupId===b){return c}}return null}function initializeAttributesTransformed(a){var c={x:0,y:0,width:0,height:0},b;switch(a.markupType){case markupTypes.Text:case markupTypes.Rectangle:case markupTypes.RectangleRedaction:b=a.SVGRectangle.getBoundingClientRect();c.x=b.x;c.y=b.y;c.width=b.width;c.height=b.height;break;case markupTypes.Circle:b=a.SVGEllipse.getBoundingClientRect();
c.x=b.x;c.y=b.y;c.width=b.width;c.height=b.height;break}return b}function applyResizeLogic(a,e,b,f,d,g){var c=function(E){E.stopPropagation();E.preventDefault();var J=$(getElement("viewer-document-wrapper")),y=$(getElement("page-handtool")),B=$(getElement("viewer-document-wrapper")).closest("div#viewerContainer");y.data("drag","unable").removeClass("selected-tool");J.removeDragScroll();var C=E.clientX,A=E.clientY,x=f,j=b.attributes,s=a,l=initializeAttributes(s),o=j.rotateDegrees,F=l.x,D=l.y,h=l.width,G=l.height,H=B.scrollTop(),v=B.scrollLeft(),n,k,r,p,u,q=b.rotatedDimensions();var t=parseInt(B.position().top),I=parseInt(B.position().left),m=parseInt(B.outerWidth()),w=parseInt(B.outerHeight());w+=t;if(a.markupType==markupTypes.Text){transferTextAreaValuetoDiv(lastSelectedDivReason)}if(a.markupType==markupTypes.Circle){n=parseFloat(a.shapes.SVGEllipse.cx.animVal.value);k=parseFloat(a.shapes.SVGEllipse.cy.animVal.value);r=parseFloat(a.shapes.SVGEllipse.rx.animVal.value);p=parseFloat(a.shapes.SVGEllipse.ry.animVal.value)
}var z=function(ax){ax.stopPropagation();ax.preventDefault();var S,R,T=B.scrollTop(),ao=B.scrollLeft(),ay,Q,ah=0,ag=0,W=0,aj=0,am=0,aw=0,ak=0,at=0,X=b.rotatedDimensions().height*scaleFactor,Z=b.rotatedDimensions().width*scaleFactor;var N=convertToSVGCoordinateSpace(b.svgPage,ax.clientX,ax.clientY);var an=parseInt(Z-N.x);var al=parseInt(X-N.y);var aa=ax.clientX;var Y=ax.clientY;if(an<0){aa=aa+an}else{if(N.x<0){aa=aa+(-1*N.x)}}if(al<0){Y=Y+al}else{if(N.y<0){Y=Y+(-1*N.y)}}switch(o){case 270:case 90:S=Y-A+(T-H);R=aa-C+(ao-v);break;case 180:default:S=aa-C+(ao-v);R=Y-A+(T-H);break}S*=1/scaleFactor;R*=1/scaleFactor;var az=s.shapes.retrieveOriginCoordinates();var ac={x:parseInt(""+az.x),y:parseInt(""+az.y)};if(d>=0&&d<=2){if(a.markupType==markupTypes.Circle){if(o==90){ay=G+R}else{ay=G-R}if(o==180){ag=-R;aj=R}else{if(o==90){ag=-R;aj=-R}else{ag=R;aj=R}}ak=k+(ag/2);if(ay>0){at=p-(aj/2)}else{at=(aj/2)-p}}else{if(o==90){ay=G+R}else{ay=G-R}if(ay>0){if(o==180){ag=0;aj=(R)}else{if(o==90){ag=-R;aj=-R}else{ag=R;
aj=R}}}else{if(o==180){ag=(ay)}else{ag=G}aj=(ay+G)}}}if(d>=4&&d<=6){if(a.markupType==markupTypes.Circle){if(o==90){ay=G-R}else{ay=G+R}if(o==180){ag=-R;aj=-R}else{if(o==90){ag=-R;aj=R}else{ag=R;aj=-R}}ak=k+(ag/2);if(ay>0){at=p-(aj/2)}else{at=(aj/2)-p}}else{if(o==90){ay=G-R}else{ay=G+R}if(ay>0){if(o==180){ag=-R;aj=-R}else{if(o==90){ag=0;aj=R}else{ag=0;aj=-R}}}else{if(o==180){ag=G}else{if(o==90){ag=ay}else{ag=ay}}aj=(ay+G)}}}if(d==0||d==7||d==6){if(a.markupType==markupTypes.Circle){if(o==270){Q=h+S}else{Q=h-S}if(o==180){ah=-S;W=S}else{if(o==270){ah=-S;W=-S}else{ah=S;W=S}}am=n+(ah/2);if(Q>0){aw=r-(W/2)}else{aw=(W/2)-r}}else{if(o==270){Q=h+S}else{Q=h-S}if(Q>0){if(o==180){ah=0;W=(S)}else{if(o==270){ah=-S;W=-S}else{ah=S;W=S}}}else{if(o==180){ah=(Q)}else{ah=h}W=h+Q}}}if(d>=2&&d<=4){if(a.markupType==markupTypes.Circle){if(o==270){Q=h-S}else{Q=h+S}if(o==180){ah=-S;W=-S}else{if(o==270){ah=-S;W=S}else{ah=S;W=-S}}am=n+(ah/2);if(Q>0){aw=r-(W/2)}else{aw=(W/2)-(r)}}else{if(o==270){Q=h-S}else{Q=h+S}if(Q>0){if(o==180){ah=-S;
W=-S}else{if(o==270){ah=0;W=(S)}else{ah=0;W=(-S)}}}else{if(o==180){ah=h}else{ah=Q}W=(Q+h)}}}if(a.markupType!=markupTypes.Circle){az.x+=parseInt(F)+ah;az.y+=parseInt(D)+ag;az.xWidth=az.x+(parseInt(h)-W);az.yHeight=parseInt(az.y+(parseInt(G)-aj))}else{az.x+=am-aw;az.y+=ak-at;az.xWidth=parseInt(az.x+(aw*2));az.yHeight=parseInt(az.y+(at*2))}if(d==1||d==5||d%2==0){var au,aq;if(a.markupType!=markupTypes.Circle){aq=parseInt(D)+ag;au=parseInt(G)-aj}else{aq=ak;au=at}switch(a.markupType){case markupTypes.Text:case markupTypes.RectangleRedaction:a.setY(aq);a.setHeight(au);case markupTypes.Rectangle:a.setY(aq);a.setHeight(au);u=a.shapes.retrieveShapeForCalculation();break;case markupTypes.Circle:a.setCY(aq);a.setRY(au);u=a.shapes.retrieveShapeForCalculation()}}if(d==3||d==7||d%2==0){var ap,ar;if(a.markupType!=markupTypes.Circle){ar=parseInt(F)+ah;ap=parseInt(h)-W}else{ar=am;ap=aw}switch(a.markupType){case markupTypes.Text:case markupTypes.RectangleRedaction:a.setX(ar);a.setWidth(ap);case markupTypes.Rectangle:a.attributes.x=ar+az.x;
a.attributes.width=ap;a.setX(ar);a.setWidth(ap);u=a.shapes.retrieveShapeForCalculation();break;case markupTypes.Circle:a.setCX(ar);a.setRX(ap);u=a.shapes.retrieveShapeForCalculation();break}}a.rotateTextObject(b.attributes.rotateDegrees);var V=calculatePosition(u,q,j.pageIndex);var L=parseInt(V.left-5);var K=parseInt(V.top-5);var ad=parseInt(V.width);var U=parseInt(V.height);var ai,P;P=U-1;ai=ad-1;var ae=L+"px";var M=(L+ai)+"px";var O=(L+ai/2)+"px";var af=K+"px";var ab=(K+P)+"px";var av=(K+P/2)+"px";g[0].style.left=(L+5)+"px";g[0].style.top=(K+5)+"px";g[0].style.width=ai+"px";g[0].style.height=P+"px";g[1].style.left=ae;g[7].style.left=ae;g[8].style.left=ae;g[2].style.left=O;g[6].style.left=O;g[3].style.left=M;g[4].style.left=M;g[5].style.left=M;g[1].style.top=af;g[2].style.top=af;g[3].style.top=af;g[4].style.top=av;g[8].style.top=av;g[5].style.top=ab;g[6].style.top=ab;g[7].style.top=ab;if(a.markupType==markupTypes.Text){if(V.height<=50||V.width<=50){g[9].style.top=(K+P+10)+"px";g[9].style.left=(L-8)+(ai/2)+"px"
}else{g[9].style.top=(K-10)+(P/2)+"px";g[9].style.left=(L-8)+(ai/2)+"px"}}if(ax.clientY>=(w-30)){B.scrollTop(B.scrollTop()+30)}else{if(ax.clientY<=(t+30)){B.scrollTop(B.scrollTop()-30)}else{if(ax.clientX>(m-30)){B.scrollLeft(B.scrollLeft()+30)}else{if(ax.clientX<=(I+30)){B.scrollLeft(B.scrollLeft()-30)}}}}};window.addEventListener("mousemove",z,false);var i=function(K){window.removeEventListener("mousemove",z,false);window.removeEventListener("mouseup",i,false);if(y.data("laststate")==true){y.data("drag","enable").addClass("selected-tool");J.dragScroll()}};window.addEventListener("mouseup",i,false)};e.addEventListener("mousedown",c,false)}function resizeHandles(g,c,j,h,m,q,r){var k=r.attributes.rotateDegrees,v=[],b,z,n=document.createElement("div"),w=n.style,o="px",s="0"+o,f=g.id,A={x:j,y:h};j-=5;h-=5;b=parseInt(m)-1;z=parseInt(q)-1;w.width=s;w.height=s;w.left=s;w.top=s;w.zIndex="1";w.cursor="move";w.display="block";c.appendChild(n);var d=document.createElement("div");d.style.position="absolute";
d.style.top=(h+5)+o;d.style.left=(j+5)+o;d.style.width=(z)+o;d.style.height=(b)+o;d.style.border="1px solid gray";d.style.display="block";d.style.pointerEvents="none";d.setAttributeNS(null,"data-isi","outlineHandle-"+f);n.appendChild(d);v.push(d);for(var t=1;t<9;t+=1){var l=document.createElement("div");l.style.position="absolute";l.style.width="12px";l.style.height="12px";l.style.display="block";l.style.zIndex="1";l.setAttributeNS(null,"data-isi","handle-"+t);var u="transparent url(images/handles.png)";switch(t){case 1:l.style.left=j+o;l.style.top=h+o;l.style.cursor="nw-resize";l.style.background=u+" 0px 0px ";if(k==90){selectedHandleIndex=6}else{if(k==270){selectedHandleIndex=2}else{selectedHandleIndex=0}}break;case 2:l.style.left=(j+(z/2))+o;l.style.top=h+o;l.style.cursor="n-resize";l.style.background=u+" -60px 0px ";if(k==90){selectedHandleIndex=7}else{if(k==270){selectedHandleIndex=3}else{selectedHandleIndex=1}}break;case 3:l.style.left=(j+z)+o;l.style.top=h+o;l.style.cursor="ne-resize";
l.style.background=u+" -12px 0px ";if(k==90){selectedHandleIndex=0}else{if(k==270){selectedHandleIndex=4}else{selectedHandleIndex=2}}break;case 4:l.style.left=(j+z)+o;l.style.top=(h+(b/2))+o;l.style.cursor="e-resize";l.style.background=u+" -60px 0px ";if(k==90){selectedHandleIndex=1}else{if(k==270){selectedHandleIndex=5}else{selectedHandleIndex=3}}break;case 5:l.style.left=(j+z)+o;l.style.top=(h+b)+o;l.style.cursor="se-resize";l.style.background=u+" -36px 0px ";if(k==90){selectedHandleIndex=2}else{if(k==270){selectedHandleIndex=6}else{selectedHandleIndex=4}}break;case 6:l.style.left=(j+(z/2))+o;l.style.top=(h+b)+o;l.style.cursor="s-resize";l.style.background=u+" -60px 0px ";if(k==90){selectedHandleIndex=3}else{if(k==270){selectedHandleIndex=7}else{selectedHandleIndex=5}}break;case 7:l.style.left=j+o;l.style.top=(h+b)+o;l.style.cursor="sw-resize";l.style.background=u+" -24px 0px ";if(k==90){selectedHandleIndex=4}else{if(k==270){selectedHandleIndex=0}else{selectedHandleIndex=6}}break;case 8:l.style.left=j+o;
l.style.top=(h+(b/2))+o;l.style.cursor="w-resize";l.style.background=u+" -60px 0px ";if(k==90){selectedHandleIndex=5}else{if(k==270){selectedHandleIndex=1}else{selectedHandleIndex=7}}break}applyResizeLogic(g,l,r,k,selectedHandleIndex,v);l.style.left+=5;l.style.top+=5;n.appendChild(l);v.push(l)}if(g.markupType==markupTypes.Text){var e=document.createElement("div");e.style.position="absolute";e.style.cursor="pointer";if(z<=50||b<=50){e.style.top=(h+b+10)+o;e.style.left=(j-8)+(z/2)+o}else{e.style.top=((h-10)+(b/2))+o;e.style.left=((j-8)+(z/2))+o}e.style.backgroundColor="transparent";e.style.backgroundImage="url(images/under-redact/EditTextMark.png)";e.style.backgroundSize="cover";e.style.width=editButtonWidth+o;e.style.height=editButtonHeight+o;e.setAttributeNS(null,"data-isi","editHandle-"+f);e.onclick=function(){var i=calculateLeftAndTop(g.shapes.retrieveShapeForCalculation());if(isIE){transferDivValuetoTextArea(g.shapes.divText,i.top,i.left,i.height,i.width,g);lastSelectedDivReason=g.shapes.divText
}else{transferDivValuetoTextArea(g.shapes.para,i.top,i.left,i.height,i.width,g);lastSelectedDivReason=g.shapes.para}};e.onmousedown=function(){transferTextAreaValuetoDiv(lastSelectedDivReason)};n.appendChild(e);v.push(e)}var a=new HandleGroup(n,v);return a}function applyResizeLogicArrow(a,e,b,f,d,g){var c=function(D){D.stopPropagation();D.preventDefault();var K=$(getElement("viewer-document-wrapper")),x=$(getElement("page-handtool"));closestChild=$(getElement("viewer-document-wrapper")).closest("div#viewerContainer");x.data("drag","unable").removeClass("selected-tool");K.removeDragScroll();var B=D.clientX,A=D.clientY,w=f,l=b.attributes,r=a.shapes.retrieveShapeForCalculation(),p=l.rotateDegrees,E=parseFloat(r.x1.animVal.value),C=parseFloat(r.y1.animVal.value),m=parseFloat(r.x2.animVal.value),z=parseFloat(r.y2.animVal.value),u=a.shapes.retrieveShapeForCalculation(),q=b.rotatedDimensions(),n=l.pageHeight,I=l.pageWidth,G=closestChild.scrollTop(),t=closestChild.scrollLeft(),h=true,H=0,j=0,F=0,i=0;
var s=parseInt(closestChild.position().top),J=parseInt(closestChild.position().left),o=parseInt(closestChild.outerWidth()),v=parseInt(closestChild.outerHeight());v+=s;var y=function(U){U.stopPropagation();U.preventDefault();var N,M,Y=closestChild.scrollTop(),Q=closestChild.scrollLeft(),L={x:0,y:0},W={x:0,y:0};var X=convertToSVGCoordinateSpace(b.svgPage,U.clientX,U.clientY);transfPageHeight=b.rotatedDimensions().height*scaleFactor;transPageWidth=b.rotatedDimensions().width*scaleFactor;var S=parseInt(transPageWidth-X.x);var P=parseInt(transfPageHeight-X.y);var R=U.clientX;var O=U.clientY;if(S<0){R=R+S}else{if(X.x<0){R=R+(-1*X.x)}}if(P<0){O=O+P}else{if(X.y<0){O=O+(-1*X.y)}}switch(p){case 270:N=-1*(O-A)+(G-Y);M=R-B+(Q-t);break;case 90:N=O-A+(Y-G);M=-1*(R-B)+(t-Q);break;case 180:N=-1*(R-B)+(t-Q);M=-1*(O-A)+(G-Y);break;default:N=R-B+(Q-t);M=O-A+(Y-G);break}N*=1/scaleFactor;M*=1/scaleFactor;var T=a.shapes.retrieveOriginCoordinates();L.x=E+T.x+N;L.y=C+T.y+M;W.x=m+T.x+N;W.y=z+T.y+M;if(L.x>=0&&L.x<=I){H=E+N
}else{if(L.x<0){H=0-T.x}else{if(L.x>I){H=I-T.x}}}if(L.y>=0&&L.y<=n){j=C+M}else{if(L.y<0){j=0-T.y}else{if(L.y>n){j=n-T.y}}}if(W.x>=0&&W.x<=I){F=m+N}else{if(W.x<0){F=0-T.x}else{if(W.x>I){F=I-T.x}}}if(W.y>=0&&W.y<=n){i=z+M}else{if(W.y<0){i=0-T.y}else{if(W.y>n){i=n-T.y}}}if(d==0){a.setX1(H);a.setY1(j)}if(d==1){a.setX2(F);a.setY2(i);if(a.markupType==markupTypes.Arrow){a.setCircMaskCX(F);a.setCircMaskCY(i)}}var V=computeLineCoordinates(u,b.svgPage,q,l.pageIndex);g[0].style.left=(V.pt1.x-5)+"px";g[0].style.top=(V.pt1.y-5)+"px";g[1].style.left=(V.pt2.x-5)+"px";g[1].style.top=(V.pt2.y-5)+"px";if(U.clientY>=(v-30)){closestChild.scrollTop(closestChild.scrollTop()+30)}else{if(U.clientY<=(s+30)){closestChild.scrollTop(closestChild.scrollTop()-30)}else{if(U.clientX>(o-30)){closestChild.scrollLeft(closestChild.scrollLeft()+30)}else{if(U.clientX<=(J+30)){closestChild.scrollLeft(closestChild.scrollLeft()-30)}}}}};var k=function(L){window.removeEventListener("mousemove",y,false);window.removeEventListener("mouseup",k,false);
if(x.data("laststate")==true){x.data("drag","enable").addClass("selected-tool");K.dragScroll()}};window.addEventListener("mousemove",y,false);window.addEventListener("mouseup",k,false)};e.addEventListener("mousedown",c,false)}function resizeHandlesArrow(e,f,o,k,a,l,r){var g=[],c=document.createElement("div"),q=c.style,d=e.id,b=r.attributes.rotateDegrees;o-=5;a-=5;k-=5;l-=5;q.width="0px";q.height="0px";q.left="0px";q.top="0px";q["z-index"]="1";q.cursor="move";q.display="block";f.appendChild(c);var n="transparent url(images/handles.png)";for(var j=0;j<2;j+=1){var m=document.createElement("div");m.style.position="absolute";m.style.width="12px";m.style.height="12px";m.style.display="block";m.style.zindex="1";m.setAttributeNS(null,"data-isi","handle-"+j);m.style.background=n+" -48px 0px ";m.style.cursor="move";switch(j){case 0:m.style.left=o+"px";m.style.top=k+"px";applyResizeLogicArrow(e,m,r,b,0,g);break;case 1:m.style.left=(a)+"px";m.style.top=(l)+"px";applyResizeLogicArrow(e,m,r,b,1,g);break
}c.appendChild(m);g.push(m)}var h=new HandleGroup(c,g);return h}function initializeAttributes(a){var c={x:0,y:0,width:0,height:0},b=a.shapes.retrieveShapeForCalculation().getBBox();switch(a.markupType){case markupTypes.Text:case markupTypes.Rectangle:case markupTypes.RectangleRedaction:c.x=b.x;c.y=b.y;c.width=b.width;c.height=b.height;break;case markupTypes.Circle:c.x=b.x;c.y=b.y;c.width=b.width;c.height=b.height;break}return b}function getSelectedObjectGroup(){var a=null;if(selectedObjectCollection.length==1){a=getSelectedObjectParentGroup(0)}return a}function getMultipleSelectedObjectGroup(){var b=[];var c=selectedObjectCollection.length;if(c>1){for(var a=0;a<c;a++){b.push(getSelectedObjectParentGroup(a))}}return b}function getSelectedObjectParentGroup(g){var i=null,a=selectedObjectCollection[g].pageId,f=selectedObjectCollection[g].markupId;if(a>-1&&f>-1){var e=getSingleSelectedObject(g);if(e){var b=e.parentNode;var d=(b)?b.parentNode:null;if(d&&b.tagName=="g"){var c=d.getAttribute("data-isi");
var h="markups-"+(a+1);if(c==h){i=b}}}}return i}function getSingleSelectedObject(d){var c=selectedObjectCollection[d],f=null;if(c){var e=c.pageId,a=c.markupId,g=pageCollection[e],b=g.retrieveMarkObjectInPage(a);f=b.shapes.retrieveShapeForCalculation()}return f}function getSingleSelectedMarkupObject(d){var c=selectedObjectCollection[d],f=null;if(c){var e=c.pageId,a=c.markupId,g=pageCollection[e],b=g.retrieveMarkObjectInPage(a);f=b}return f}function getSelectedRedactionReason(d){var c=selectedObjectCollection[d],f=null;if(c){var e=c.pageId,a=c.markupId,g=pageCollection[e],b=g.retrieveMarkObjectInPage(a);if(b.markupType===markupTypes.RectangleRedaction){if(isIE){f=b.shapes.redactionText.data}else{f=b.shapes.divText.innerHTML}}}return f}function getSingleSelectedTextObject(){var b=getSelectedObjectGroup();if(b){var a=parseInt(selectedObjectCollection[0].markupId);return document.getElementById("divText-"+a)}else{return null}}function deleteSingleMarkup(){var a=getSelectedObjectGroup();if(a){var b=a.parentNode;
b.removeChild(a)}}function deleteMultipleMarkups(){var a=getMultipleSelectedObjectGroup();var d=a.length;for(var b=0;b<d;b++){if(a[b]){var c=a[b].parentNode;c.removeChild(a[b])}}}function removeSingleMarkupInArray(){if(selectedObjectCollection.length==1){var d=pageCollection[selectedObjectCollection[0].pageId];var c=d.markups.length;for(var a=0;a<c;a++){if(d.markups[a].id==selectedObjectCollection[0].markupId){d.markups.splice(a,1);break}}var b=d.textMarkups;c=b.length;for(var a=0;a<c;a++){if(b[a].id==selectedObjectCollection[0].markupId){b.splice(a,1);break}}}}function removeMultipleMarkupInArray(){if(selectedObjectCollection.length>1){for(var c=selectedObjectCollection.length-1;c>=0;c--){var f=pageCollection[selectedObjectCollection[c].pageId];var e=f.markups.length;for(var b=e-1;b>=0;b--){if(f.markups[b].id==selectedObjectCollection[c].markupId){f.markups.splice(b,1)}}var d=f.textMarkups;e=d.length;for(var b=e-1;b>=0;b--){if(d[b].id==selectedObjectCollection[c].markupId){d.splice(b,1)
}}}}}function layerMarkupObject(b){var a=getSelectedObjectGroup();if(a&&b){var c=a.parentNode;switch(b){case layerOptions.Top:c.appendChild(a);break;case layerOptions.Bottom:c.insertBefore(a,c.firstChild);break;case layerOptions.Forward:if(a.nextElementSibling!==null){c.insertBefore(a.nextElementSibling,a)}break;case layerOptions.Backward:if(a.previousElementSibling!==null){c.insertBefore(a,a.previousElementSibling)}break;default:}}}function setAttributeColor(b,a,c){switch(b){case"fill":a.setAttribute("fill",getSelectedColor(c));a=null;break;case"stroke":a.setAttribute("stroke",getSelectedColor(c));a=null;break}}function setOpacity(d,e){d.setAttribute("style","opacity:"+getSelectedOpacity(e));d.setAttribute("data-opacity",getSelectedOpacity(e));var c=selectedObjectCollection[0].pageId,a=selectedObjectCollection[0].markupId,f=pageCollection[c],b=f.retrieveMarkObjectInPage(a);b.markupOpacity=getSelectedOpacity(e);if(b.markupType===markupTypes.Text){if(isIE){b.SVGText.style.fill=getRGBAcolor(b.SVGText.style.fill,b.markupOpacity)
}else{b.divText.style.color=getRGBAcolor(b.divText.style.color,b.markupOpacity)}}}function setWidth(c,d){var e=c;e.setAttribute("stroke-width",getSelectedWidth(d));if(c.hasAttribute("marker-end")){var b=isIE?c.getAttribute("marker-end").slice(5,-2):c.getAttribute("marker-end").slice(4,-1),a=$(c).siblings(b)[0];changeArrowHeadSize(a,a.firstChild)}}function setToolBarColor(a,c){var b=document.getElementById(a);b.style.backgroundColor=c}function setToolBarWidth(a,c){var b=document.getElementById(a);b.innerHTML=c}function setToolBarFontFace(a,c){var b=document.getElementById(a);b.innerHTML=c}function setToolBarFontSize(a,c){var b=document.getElementById(a);b.innerHTML=c}function setToolBarOpacity(a,d){var b=document.getElementById(a);var c=(parseFloat(d).toFixed(2)*parseInt(100))+"%";b.innerHTML=c}function parseText(c){var b="";var a=this.attributes.text.length;b=c[0];switch(this.markupType){case markupTypes.Text:for(var d=1;d<a;d++){if(isIE){b+="\n"+c[d]}else{b+="<br/>"+c[d]}}break}return b
}function transferTextAreaValuetoDiv(b){if(b==null){b=lastDrawnDivReason}var d=document.getElementById("textAreaContainer");if(d.style.display!="none"){if(isIE){var c=d.value;rotateTextLabel(b,c)}else{b.innerHTML=d.value.replace(/\n/g,"<br/>");rotateTextLabel(b,d.value)}resetTextAreaStyle();if($("#annotationInfiniteBtn").hasClass("ann-infinite-app-btn active-state")){if(annotationObject==markupTypes.Text){var a=$("#addText");a.mouseup()}}}}function insertTextValuetoDiv(c,a){var b;if(isIE){b=c.shapes.divText}else{b=c.shapes.para}if(isIE){}else{b.innerHTML=a}resetTextAreaStyle()}function transferDivValuetoTextArea(f,q,j,r,s,l){var o=document.getElementById(f.getAttribute("id"));var h=null;if(isIE){lastSelectedDivReason=f.divText;var v=o.parentNode;var c=v.childNodes.length;var k="";for(var u=0;u<c;u++){var m=v.childNodes[u];if(m.getAttribute("class")==="wrapTextWithNewLine"){k+=m.textContent;k+="\n";m.textContent=""}else{k+=m.textContent;m.textContent=""}}for(var u=c-1;u>=1;u--){v.removeChild(v.childNodes[u])
}document.getElementById("textAreaContainer").value=k.replace(/((\s*\S+)*)\s*/,"$1");h=getRGBvalue(window.getComputedStyle(o).getPropertyValue("fill"))}else{lastSelectedDivReason=f.para;document.getElementById("textAreaContainer").value=htmlDecode(o.innerHTML.replace(/<br>/g,"\n"));o.innerHTML="";h=getRGBvalue(window.getComputedStyle(o).getPropertyValue("color"))}var x=window.getComputedStyle(o).getPropertyValue("font-family");var d=window.getComputedStyle(o).getPropertyValue("font-size");var n=window.getComputedStyle(o).getPropertyValue("font-weight");var e=window.getComputedStyle(o).getPropertyValue("font-style");var t=o.parentNode.style.textDecoration;var p=window.getComputedStyle(o).getPropertyValue("text-align");var a=window.getComputedStyle(o).getPropertyValue("vertical-align");var w=l.attributes.fillColor;if(w=="rgba(176, 176, 176, 0)"||w=="rgba(0, 0, 0, 0)"||w=="transparent"){w="rgba(255, 255, 255, 1)"}else{w=getRGBAcolor(w,"1")}var b=document.getElementById("textAreaContainer");
b.setAttribute("style","outline: none; border: none; position: absolute; overflow: auto; resize: none; display: block; width: "+((s-15)+"px")+"; height: "+((r-15)+"px")+"; top: "+((q+5)+"px")+"; left: "+((j+8)+"px")+"; font-family: "+x+"; font-size: "+d+"; color: "+h+"; font-weight: "+n+"; font-style: "+e+"; text-decoration: "+t+"; text-align:left; vertical-align:top; background: "+w+";");b.focus();var g=b.value.length;b.setSelectionRange(g,g);b.select()}function htmlDecode(a){return $("<div/>").html(a).text()}function htmlEncode(a){return $("<div/>").text(a).html()}function clearTextAreaContents(){document.getElementById("textAreaContainer").value=""}function resetTextAreaStyle(){var a=document.getElementById("textAreaContainer");a.setAttribute("style","position: absolute; overflow: auto; width: 1px; height: 1px; resize: none; display: none; cursor: none");clearTextAreaContents()}function showTextArea(b){var e=b.getAttribute("fill");if(e=="rgba(176, 176, 176, 0)"||e=="rgba(0, 0, 0, 0)"||e=="transparent"){e="rgba(255, 255, 255, 1)"
}else{e=getRGBAcolor(e,"1")}var a=e;var d=document.getElementById("textAreaContainer");var c=calculateLeftAndTop(b);d.setAttribute("style","outline: none; border: none; position: absolute; overflow: auto; resize: none; display: block; text-align:left; vertical-align: top; width: "+((c.width-15)+"px")+"; height: "+((c.height-15)+"px")+"; top: "+((c.top+5)+"px")+"; left: "+((c.left+8)+"px")+"; background: "+a+";");applyAttributesInTextArea();d.focus()}function moveHandles(a,c){var b,e=c.attributes,d=c.handleCollections[0],f,g=computeRelativePageDimensions(e.pageIndex);b=a.shapes.retrieveShapeForCalculation();switch(a.markupType){case markupTypes.Line:case markupTypes.Arrow:f=computeLineCoordinates(b,c.svgPage,g,e.pageIndex);changeHandlePosition(a,f,d);break;case markupTypes.Circle:f=calculatePosition(b,g,e.pageIndex);changeHandlePosition(a,f,d);break;case markupTypes.Text:case markupTypes.Rectangle:case markupTypes.RectangleRedaction:f=calculatePosition(b,g,e.pageIndex);changeHandlePosition(a,f,d);
break}}function changeHandlePosition(m,h,o){var j=parseInt(h.left-5);var i=parseInt(h.top-5);var d=parseInt(h.width);var c=parseInt(h.height);var a,l;l=c-1;a=d-1;var n=j+"px";var f=(j+a)+"px";var g=(j+a/2)+"px";var k=i+"px";var e=(i+l)+"px";var b=(i+l/2)+"px";if(m.markupType==markupTypes.Line||m.markupType==markupTypes.Arrow){o.handleCollection[0].style.left=(h.pt1.x-5)+"px";o.handleCollection[0].style.top=(h.pt1.y-5)+"px";o.handleCollection[1].style.left=(h.pt2.x-5)+"px";o.handleCollection[1].style.top=(h.pt2.y-5)+"px"}else{o.handleCollection[0].style.left=(j+5)+"px";o.handleCollection[0].style.top=(i+5)+"px";o.handleCollection[1].style.left=n;o.handleCollection[7].style.left=n;o.handleCollection[8].style.left=n;o.handleCollection[2].style.left=g;o.handleCollection[6].style.left=g;o.handleCollection[3].style.left=f;o.handleCollection[4].style.left=f;o.handleCollection[5].style.left=f;o.handleCollection[1].style.top=k;o.handleCollection[2].style.top=k;o.handleCollection[3].style.top=k;o.handleCollection[4].style.top=b;
o.handleCollection[8].style.top=b;o.handleCollection[5].style.top=e;o.handleCollection[6].style.top=e;o.handleCollection[7].style.top=e;if(m.markupType==markupTypes.Text){if(h.height<=50||h.width<=50){o.handleCollection[9].style.top=(i+l+10)+"px";o.handleCollection[9].style.left=(j-8)+(a/2)+"px"}else{o.handleCollection[9].style.top=(i-10)+(l/2)+"px";o.handleCollection[9].style.left=(j-8)+(a/2)+"px"}}}}function getSelectedFontFace(){var a=documentViewer.annotationToolBox[markupTypes.Text];document.getElementById("textAreaContainer").style.fontFamily=a.fontFamily;return a.fontFamily}function getSelectedFontSize(){var a=documentViewer.annotationToolBox[markupTypes.Text];document.getElementById("textAreaContainer").style.fontSize=a.fontSize;return a.fontSize}function getSelectedTextColor(){var a=documentViewer.annotationToolBox[markupTypes.Text];document.getElementById("textAreaContainer").style.color=getRGBvalue(a.fontColor);return getRGBvalue(a.fontColor)}function getSelectedFontWeight(){var a=documentViewer.annotationToolBox[markupTypes.Text];
if(a.boldStyle){document.getElementById("textAreaContainer").style.fontWeight="bold";return"bold"}else{return"normal"}}function getSelectedFontStyle(){var a=documentViewer.annotationToolBox[markupTypes.Text];if(a.italicStyle){document.getElementById("textAreaContainer").style.fontStyle="italic";return"italic"}else{return"normal"}}function getSelectedTextDecoration(){var a=documentViewer.annotationToolBox[markupTypes.Text];if(a.underlineStyle){if(a.strikeStyle){document.getElementById("textAreaContainer").style.textDecoration="underline line-through";return"underline line-through"}else{document.getElementById("textAreaContainer").style.textDecoration="underline";return"underline"}}else{if(a.strikeStyle){if(a.underlineStyle){document.getElementById("textAreaContainer").style.textDecoration="underline line-through";return"underline line-through"}else{document.getElementById("textAreaContainer").style.textDecoration="line-through";return"line-through"}}}}function getSelectedHorizontalAlignment(){var a=documentViewer.annotationToolBox[markupTypes.Text];
switch(a.horizontalAlign){case"left":document.getElementById("textAreaContainer").style.textAlign="left";return"left";break;case"center":document.getElementById("textAreaContainer").style.textAlign="center";return"center";break;case"right":document.getElementById("textAreaContainer").style.textAlign="right";return"right";break}}function getSelectedVerticalAlignment(){if(getSelectedObjectGroup()!=null){var b=getSingleSelectedTextObject();var c=getComputedStyle(b,null).getPropertyValue("vertical-align");switch(c){case"top":return"top";break;case"middle":return"middle";break;case"bottom":return"bottom";break}}else{var a=documentViewer.annotationToolBox[markupTypes.Text];switch(a.verticalAlign){case"top":document.getElementById("textAreaContainer").style.verticalAlign="top";return"top";break;case"middle":document.getElementById("textAreaContainer").style.verticalAlign="middle";return"middle";break;case"bottom":document.getElementById("textAreaContainer").style.verticalAlign="bottom";return"bottom";
break}}}function applyAttributesInTextArea(){getSelectedFontFace();getSelectedFontSize();getSelectedTextColor();getSelectedFontWeight();getSelectedFontStyle();getSelectedTextDecoration()}function isMouseWithinPageBoundary(b,a,c){if((parseInt(b.x)>0)&&(parseInt(b.y)>0)&&(parseInt(b.x)<a)&&(parseInt(b.y)<c)){return true}else{return false}}function changeArrowHeadSize(b,d,c){var a=(readyToDraw||selectedObjectCollection.length>0)?parseInt($(getElement("fillWidth")).text()):parseInt(c.borderWeight);switch(a){case 1:b.setAttributeNS(null,"markerWidth","13");b.setAttributeNS(null,"markerHeight","13");break;case 2:b.setAttributeNS(null,"markerWidth","15");b.setAttributeNS(null,"markerHeight","15");break;case 3:b.setAttributeNS(null,"markerWidth","18");b.setAttributeNS(null,"markerHeight","18");break;case 4:b.setAttributeNS(null,"markerWidth","20");b.setAttributeNS(null,"markerHeight","20");break;case 5:b.setAttributeNS(null,"markerWidth","23");b.setAttributeNS(null,"markerHeight","23");break;case 6:b.setAttributeNS(null,"markerWidth","25");
b.setAttributeNS(null,"markerHeight","25");break;case 7:b.setAttributeNS(null,"markerWidth","28");b.setAttributeNS(null,"markerHeight","28");break;case 8:b.setAttributeNS(null,"markerWidth","30");b.setAttributeNS(null,"markerHeight","30");break}if(isIE){if(a==1){d.setAttributeNS(null,"d","M 0 0.5 L 9.5 5 L 0 9.5 z")}else{if(a==2){d.setAttributeNS(null,"d","M 0 1 L 8 5 L 0 9 z")}else{if(a==3){d.setAttributeNS(null,"d","M 0 2 L 6.5 5 L 0 8 z")}else{if(a==4){d.setAttributeNS(null,"d","M 0 2.5 L 5.5 5 L 0 7.5 z")}else{if(a==5){d.setAttributeNS(null,"d","M 0 3 L 4 5 L 0 7 z")}else{if(a==6){d.setAttributeNS(null,"d","M 0 3.5 L 3.15 5 L 0 6.5 z")}else{if(a==7){d.setAttributeNS(null,"d","M 0 4 L 2 5 L 0 6 z")}else{if(a==8){d.setAttributeNS(null,"d","M 0 4.5 L 1 5 L 0 5.5 z")}}}}}}}}}else{d.setAttributeNS(null,"d","M 0 0 L 10 5 L 0 10 z")}}function hideEditButton(){var e=selectedObjectCollection.length;for(var c=0;c<e;c++){var d=pageCollection[(selectedObjectCollection[c].pageId)];var a=d.retrieveMarkObjectInPage(selectedObjectCollection[c].markupId);
var b=d.handleCollections[c];if(a.markupType==markupTypes.Text){b.handleCollection[9].style.display="none"}}}function showEditButton(){var c=pageCollection[(selectedObjectCollection[0].pageId)];var a=c.retrieveMarkObjectInPage(selectedObjectCollection[0].markupId);var b=c.handleCollections[0];if(a.markupType==markupTypes.Text){b.handleCollection[9].style.display="block"}}function setVerticalAlignOnChange(c,b){var f=c.childNodes.length;var g=c.style.fontSize.replace("px","");var d=parseInt(c.getAttribute("height"));var a=parseInt(g)*parseInt(f-1);var e=parseInt(d)+(parseInt(g)/2);var h=(b)?b:getSelectedVerticalAlignment();if(f>1){switch(h){case"top":c.setAttributeNS(null,"y",parseInt(g));break;case"middle":c.setAttributeNS(null,"y",parseInt(e/2)-parseInt(a/2));break;case"bottom":c.setAttributeNS(null,"y",parseInt(d-10)-a);break}}else{switch(h){case"top":c.setAttributeNS(null,"y",parseInt(g));break;case"middle":c.setAttributeNS(null,"y",parseInt(e/2));break;case"bottom":c.setAttributeNS(null,"y",parseInt(d-10));
break}}}function changeTspanFontSize(c,b){var f=c.childNodes.length;for(var d=1;d<f;d++){var e=parseInt(c.style["font-size"].replace("px",""));var a=parseInt(c.childNodes[d].getAttribute("dy"));var g=parseInt(a/b);c.childNodes[d].setAttributeNS(null,"dy",parseInt(e*g))}}function getObjectMatrix(d){try{var a,b={x:0,y:0};if(d.transform.animVal.numberOfItems!=0){a=d.transform.animVal.getItem(0).matrix;b.x=parseFloat(a.e);b.y=parseFloat(a.f)}}catch(c){console.error("Exception in getObjectMatrix: "+c)}return b}function parseMatrix(a,b,e){a=a.substring(a.indexOf("("));a=a.substring(1,a.length-1);var d=a.split(" ");if(a.indexOf(" ")===-1&&a.indexOf(",")>-1){d=a.split(",")}newMatrix="matrix(";for(var c=0;c<d.length;c++){if(c===0&&b===0){newMatrix+=e}else{if(c===0){newMatrix+=d[c]}else{if(b===c){newMatrix+=","+e}else{newMatrix+=","+d[c]}}}}newMatrix+=")";return newMatrix}function showHideNoFillColor(a){var b=$(getElement("availableColors"));if(a!="fill"&&a!="border"){b.children("#nofillColor").css({display:"none",cursor:"default"}).removeClass("nofillColor");
b.children("#nofillColor").removeClass("nofillColor")}else{b.children("#nofillColor").css({display:"block",cursor:"pointer"});b.children("#nofillColor").addClass("nofillColor")}}function processWrapping(a,l,m,k,b,d){try{k-=15;var h=createSVGElement("tspan");var j=document.createTextNode(l[0]);h.appendChild(j);a.appendChild(h);h.setAttributeNS(null,"data-isi","redaction-"+(b));var f=2;for(var e=1;e<l.length;e++){var g=h.firstChild.data.length;h.firstChild.data+=l[e];if(h.getComputedTextLength()>k){f-=m/2;h.firstChild.data=h.firstChild.data.slice(0,g);var h=createSVGElement("tspan");h.setAttributeNS(null,"x",d);h.setAttributeNS(null,"dy",m);j=document.createTextNode(l[e]);h.appendChild(j);a.appendChild(h);h.setAttributeNS(null,"data-isi","redaction-"+(b))}}a.setAttributeNS(null,"dy",f)}catch(c){}}function wrapTextOnSizeChange(){var h=pageCollection[(selectedObjectCollection[0].pageId)];var d=h.retrieveMarkObjectInPage(selectedObjectCollection[0].markupId);var g=d.shapes.divText;var c=g.parentNode;
var a=c.childNodes.length;var f="";for(var e=0;e<a;e++){var b=c.childNodes[e];if(b.getAttribute("class")==="wrapTextWithNewLine"){f+=b.textContent;f+="\n";b.textContent=""}else{f+=b.textContent;b.textContent=""}}clearTextNodes(c);performWrappingAndNewLineForText(g,f)}function clearTextNodes(b){var a=b.childNodes.length;for(var c=a-1;c>=1;c--){b.removeChild(b.childNodes[c])}}function rotateAllTextObjects(){var a=pageCollection.length;for(var c=0;c<a;c++){var b=pageCollection[c];if(b.textMarkups.length>0){b.rotateTextMarkups(b.attributes.rotateDegrees)}}}function performWrappingAndNewLineForText(b,h){b.setAttributeNS(null,"class","wrapText");var j=null;var l=1;var f=h[0];var e=false;var k=parseInt(b.parentNode.getAttribute("width")-15);for(var d=1;d<h.length;d++){if(h[d]!="\n"&&j==null&&b.getComputedTextLength()<k){f=f+""+h[d];var c=document.getElementById(b.getAttribute("id"));if(c!=undefined&&c!=null){c.textContent=f}}else{if(h[d]!="\n"&&j!=null&&j.getComputedTextLength()<k){j.textContent=j.textContent+""+h[d]
}else{if(j){j.textContent=j.textContent}var m=b.parentNode.style.fontSize.replace("px","");var g=createSVGElement("tspan");g.setAttributeNS(null,"x",b.parentNode.getAttribute("x"));g.setAttributeNS(null,"id",b.getAttribute("id"));g.setAttributeNS(null,"data-isi",b.getAttribute("data-isi"));if(e){g.setAttributeNS(null,"dy",(parseInt(m)*(l-1)));e=false}else{g.setAttributeNS(null,"dy",(parseInt(m)*(l)))}if(h[d]!="\n"&&j!=null&&j.getComputedTextLength()>k){g.textContent=h[d];j=g;g.setAttributeNS(null,"class","wrapText")}else{if(h[d]!="\n"&&b!=null&&b.getComputedTextLength()>k){g.textContent=h[d];j=g;g.setAttributeNS(null,"class","wrapText")}else{if(h[d+1]&&h[d+1]!="\n"){if(j){j.setAttributeNS(null,"class","wrapTextWithNewLine")}else{b.setAttributeNS(null,"class","wrapTextWithNewLine")}g.textContent=h[d+1];j=g;l=1;d=d+1;g.setAttributeNS(null,"class","wrapText")}else{if(j){j.setAttributeNS(null,"class","wrapTextWithNewLine")}else{b.setAttributeNS(null,"class","wrapTextWithNewLine")}g.textContent=h[d];
l+=1;e=true;g.setAttributeNS(null,"class","newLine")}}}b.parentNode.appendChild(g)}}}if(f){var a=document.getElementById(b.getAttribute("id"));if(a!=undefined&&a!=null){document.getElementById(b.getAttribute("id")).textContent=f}}}function getRGBAcolor(c,b){return"rgba("+getRvalue(c)+", "+getGvalue(c)+", "+getBvalue(c)+", "+b+")"}function getRGBvalue(a){if(a.indexOf("transparent")>-1){return"rgb(0, 0, 0)"}else{return"rgb("+getRvalue(a)+", "+getGvalue(a)+", "+getBvalue(a)+")"}}function getRGBarray(b){var a="";if(b.indexOf("transparent")>-1){a="0, 0, 0"}else{a=b.substring(b.indexOf("(")+1,b.lastIndexOf(")"))}return a.split(",")}function getRvalue(a){var b=getRGBarray(a);if(b.length===3||b.length===4){return getRGBarray(a)[0].trim()}}function getGvalue(a){var b=getRGBarray(a);if(b.length===3||b.length===4){return getRGBarray(a)[1].trim()}}function getBvalue(a){var b=getRGBarray(a);if(b.length===3||b.length===4){return getRGBarray(a)[2].trim()}}function getAvalue(a){var b=getRGBarray(a);if(b.length===3||b.length===4){return getRGBarray(a)[3].trim()
}}function rotatePageLoadAnnotation(a,b){var c=$(getElement("viewer-document-wrapper")).children(".pageContent"),h=c.eq(a);if(h.length){var i,d,k,j,l=h[0].style.width,e=h[0].style.height,m=pageCollection[a].attributes.pageWidth,g=pageCollection[a].attributes.pageHeight;switch(b){case 90:i=e;d=l;k=g/2;j=k;break;case 180:i=e;d=l;k=m/2;j=g/2;break;case 270:i=e;d=l;k=m/2;j=k;break;case 0:case 360:default:i=e;d=l;k=g/2;j=k;break}pageCollection[a].attributes.rotateDegrees=b;pageCollection[a].attributes.rotateX=k;pageCollection[a].attributes.rotateY=j;var f=h.find(".gWrapper");if(hasNativeSVG(h)||f){if(f.prop("tagName")=="g"){var n=getTransformMatrixValue(scaleFactor,b,k,j);Snap(f[0]).transform(n)}}h.width(i);h.height(d);reCalculateHandles(pageCollection[a])}displayViewableSvg(h)}function attachDrawFinishFunction(a,e){var c=JSON.parse(JSON.stringify(isIE));if(e!=undefined){isIE=e}if(a.attributes.type==markupTypes.RectangleRedaction){var b=function(h){var g=a;var f=(g.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;
g.setOpacityDisplay(f)};var d=function(g){var f=a;var h=pageCollection[retrievePageNumber(f.shapes.SVGRectangle)-1];if(!h.isMarkupSelected(f.attributes.id)){f.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";if(isSafari){f.setShapeAttribute(f.shapes.SVGRectangle,"fill-opacity","0.2")}else{f.setShapeAttribute(f.shapes.SVGRectangle,"fill","rgba(0, 0, 0, 0.2)")}if(isIE){f.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";f.shapes.SVGText.style.fill="rgba(255, 255, 255, 0)"}else{f.shapes.divText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";f.shapes.divText.style.color="rgba(255, 255, 255, 0)"}}};a.resetViewable=function(){var g=a;var f=(g.visibilityMode===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;g.setOpacityDisplay(f)};a.shapes.SVGRectangle.addEventListener("mouseover",d,false);a.shapes.SVGRectangle.addEventListener("mouseout",b,false);if(isIE){a.shapes.SVGText.addEventListener("mouseover",d,false);
a.shapes.SVGText.addEventListener("mouseout",b,false)}else{a.shapes.divText.addEventListener("mouseover",d,false);a.shapes.divText.addEventListener("mouseout",b,false)}}if(c!=isIE){isIE=c}}function redactionHandlingMouseOut(){var b=this.getAttributeNS(null,"data-isi");var c=parseInt(b.substring(b.indexOf("-")+1,b.length));var e=pageCollection[pageNumber-1];var d=e.retrieveMarkObjectInPage(c);var a=(d.markupVisibility===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;drawnObject.shapes.SVGRectangle.style.fill="rgba(0, 0, 0, "+a+")";drawnObject.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";drawnObject.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(a*100)+")";drawnObject.shapes.SVGText.style.fill="rgba(255, 255, 255, "+a+")"}function redactionHandlingMouseOver(){var a=this.getAttributeNS(null,"data-isi");var b=parseInt(a.substring(a.indexOf("-")+1,a.length));var c=pageCollection[pageNumber-1];
if(!c.isMarkupSelected(b)){drawnObject.shapes.SVGRectangle.style.fill="rgba(0, 0, 0, 0.2)";drawnObject.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";drawnObject.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";drawnObject.shapes.SVGText.style.fill="rgba(255, 255, 255, 0)"}}function resetViewable(){var b=drawnObject.shapes.SVGText.getAttributeNS(null,"data-isi");var c=parseInt(b.substring(b.indexOf("-")+1,b.length));var e=pageCollection[pageNumber-1];var d=e.retrieveMarkObjectInPage(c);var a=(d.markupVisibility===visibilityMode.Transparent)?visibilityMode.Transparent:visibilityMode.Shown;drawnObject.shapes.SVGRectangle.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(a*100)+")";drawnObject.shapes.SVGRectangle.style.fill="rgba(0, 0, 0, "+a+")";drawnObject.shapes.SVGRectangle.style.fill="rgba(0, 0, 0, "+a+")";drawnObject.shapes.SVGText.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(a*100)+")";
drawnObject.shapes.SVGText.style.fill="rgba(255, 255, 255, "+a+")"}function setToolBoxValues(b){var c=documentViewer.annotationToolBox[b];var d=getSingleSelectedObject(0);var a=getSingleSelectedTextObject();switch(b){case markupTypes.Text:c.fontColor=isIE?a.style.fill:a.style.color;c.fontFamily=a.style.fontFamily;c.fontSize=a.style.fontSize;c.horizontalAlign=a.style.textAlign;c.verticalAlign=a.style.verticalAlign;c.boldStyle=a.style.fontWeight=="bold"?true:false;c.italicStyle=a.style.fontStyle=="italic"?true:false;if(a.style.textDecoration=="underline"){c.underlineStyle=true;c.strikeStyle=false}else{if(a.style.textDecoration=="line-through"){c.underlineStyle=false;c.strikeStyle=true}else{if(a.style.textDecoration=="underline line-through"){c.underlineStyle=true;c.strikeStyle=true}else{c.underlineStyle=false;c.strikeStyle=false}}}case markupTypes.Circle:case markupTypes.Rectangle:c.fillColor=d.getAttribute("fill");c.borderColor=d.getAttribute("stroke");c.borderWeight=d.getAttribute("stroke-width");
c.opacityLevel=d.getAttribute("data-opacity")*100+"%";c.opacityLevelDecimal=d.getAttribute("data-opacity");break;case markupTypes.Line:case markupTypes.Arrow:c.fillColor=d.getAttribute("stroke");c.borderWeight=d.getAttribute("stroke-width");c.opacityLevel=d.getAttribute("data-opacity")*100+"%";c.opacityLevelDecimal=d.getAttribute("data-opacity");break;case markupTypes.RectangleRedaction:c.reason=$(".reasons-holder").parent().siblings(".selected-reason").children("span").text();break}}function getTransformMatrixValue(e,b,a,d){var c=new Snap.Matrix();c.scale(e);c.rotate(b,a,d);return c}function getTextTransformRotate(f,h,g,d,i){var c,b,a;switch(f){case 0:case 360:c=0;if(isIE){b=h;a=g}else{b=h+(i/2);a=g+(i/2)}break;case 90:c=270;if(isIE){b=(g+(i))*-1;a=h}else{b=h+(i/2);a=g+(i/2)}break;case 180:c=180;if(isIE){b=(h+(d))*-1;a=(g+(i))*-1}else{b=h+(d/2);a=g+(i/2)}break;case 270:c=90;if(isIE){b=g;a=(h+d)*-1}else{b=h+(d/2);a=g+(d/2)}break}var e=new Snap.Matrix();if(isIE){e="rotate("+c+") translate("+b+" "+a+")"
}else{e="rotate("+c+","+b+","+a+")"}return e}function rotateTextLabel(c,b){if(c){var f=c.getAttribute("data-isi");if(f){var a=parseInt(retrievePageNumber(c))-1;var g=pageCollection[a];if(g){var e=parseInt(f.substring(f.indexOf("-")+1,f.length));var d=g.retrieveMarkObjectInPage(e);if(d){d.setText(b);d.rotateTextObject(g.attributes.rotateDegrees)}}}}}function activateTab(a){if(a===markupTypes.RectangleRedaction){$(getElement("redactTab")).addClass("tab-active").siblings("li").removeClass("tab-active");$(".under-redact").show().siblings().hide()}else{$(getElement("annotateTab")).addClass("tab-active").siblings("li").removeClass("tab-active");$(".under-annotate").show().siblings().hide()}}function retrieveViewableIndex(){var d=$(".gWrapper");var c=d.length;var e="";var a=[];for(var b=0;b<c;b++){e=d[b].parentNode.id;e=parseInt(e.substring(5,e.length))-1;a.push(e)}return a}function msieversion(){var b=window.navigator.userAgent;var a=b.substring(b.indexOf("rv")+3,b.length);a=parseInt(a.substring(0,a.indexOf(")")));
return a}function fixArrows(){var e=retrieveViewableIndex();var a=e.length;for(var d=0;d<a;d++){var f=pageCollection[e[d]];if(f.hasDrawnObject()){for(var c=0;c<f.markups.length;c++){var b=f.markups[c];if(b.markupType===markupTypes.Arrow){removeObjectFromDom(b.shapes.group,b.shapes.SVGArrowHead);removeObjectFromDom(b.shapes.group,b.shapes.SVGLine);appendObjectToDom(b.shapes.group,b.shapes.SVGArrowHead);appendObjectToDom(b.shapes.group,b.shapes.SVGLine)}}}}}function setMouseStyle(){var b=$(getElement("viewer-document-wrapper"));var a=$(getElement("page-handtool"));b.removeClass("cursorCrosshair");if(a.data("laststate")==true){a.data("drag","enable").addClass("selected-tool");b.dragScroll()}else{b.css("cursor","default")}}function breakCacheParameter(){return"&date="+new Date().getTime()}function sendConversionRequest(a){createAJAXRequest("POST",documentViewer.domain+"/DocViewerWS/rest/convert/tosvg?nativeFilePath="+a+"&timezone="+documentViewer.timezone)}function sendBatchConversionRequest(c,a,d){var b=function(){d();
console.log("batchsize: "+a);getReportFile(c,a)};createAJAXRequest("POST",documentViewer.domain+"/DocViewerWS/rest/convert/tosvgbatch?nativeFilePath="+c+"&timezone="+documentViewer.timezone+"&batchSize="+a,b)}function cleanUpDocument(a){createAJAXRequest("POST",documentViewer.domain+"/DocViewerWS/rest/document/cleanUpDocument?nativePath="+a)}function duplicateNativeFile(c,a,b){createAJAXRequest("POST",documentViewer.domain+"/DocViewerWS/rest/document/duplicateFile?nativePath="+c+"&destinationFolderPath="+a+"&batchSize="+b)}function getReportFile(a,c){var b=documentViewer.domain+"/DocViewerWS/rest/document/reportFile?nativePath="+a+"&batchSize="+c+breakCacheParameter();window.location=b}function hideNotification(){var a=$(getElement("DV-Notif"));a.animate({top:"-85px",opacity:0},600)}function hideNavigationButtons(){var a=$(".page-nav-container");a.css("display","none")}function resetDefaultVisibilityMode(){var c=$(".selected-visibility-redaction"),b=c.children(".visibility-holder-redaction"),a=c.siblings(".visibility-available-container").children()[0].getAttribute("src");
b.attr("src",a);b.attr("data-visibility","Show Redaction");b.attr("title","Change Redaction Visibility to Semi-Transparent");var f=$(".selected-visibility-annotation"),e=f.children(".visibility-holder-annotation"),d=f.siblings(".visibility-available-container").children()[0].getAttribute("src");e.attr("src",d);e.attr("data-visibility","Show Annotation");e.attr("title","Change Annotation Visibility to Semi-Transparent")}function displayPrintButton(a){if(a){displayTool($(".printDocument"),true)}else{displayTool($(".printDocument"),false)}}function hideRedactTab(){displayTool($(".redact-tab"),false)}function hideAnnotateTab(){displayTool($(".annotate-tab"),false)}function displaySaveButton(a){if(a){displayTool($(".saveDocSettings"),true)}else{displayTool($(".saveDocSettings"),false)}}function hasObjectsOnDocument(){var b={hasRedactions:false,hasAnnotations:false};var d=pageCollection.length;var f=false;var a=false;var e;for(var c=0;c<d;c++){e=pageCollection[c];if(!f){if(e.hasRedactions()){f=true;
b.hasRedactions=true}}if(!a){if(e.hasAnnotations()){a=true;b.hasAnnotations=true}}}return b}function isMobile(){var a=false;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))){a=true
}}function clearSearch(){highlightWalkerCollection=[];getElement("walker").innerHTML="0";getElement("resultHit").innerHTML="0";clearAllSearchHighlights()}function search(b){clearAllSearchHighlights();var a=function(c){var e=0;var g=JSON.parse(c.responseText);var j=g.length;var k;var f=null;var n=null;var m=null;var d=null;var o=null;for(var h=0;h<j;h++){k=g[h];m=pageCollection[parseInt(k.page)];if(m){f=k.rectangles;n=f.length;for(var l=0;l<n;l++){e++;d=f[l];o=f[l].length;m.addHitTerm(d)}}else{tempHighlightCollection[parseInt(k.page)]=k}}document.getElementById("resultHit").innerHTML=e;navigateToNextTerm(0)};createAJAXRequest("POST",documentViewer.domain+"/DocViewerWS/rest/search/query?nativeFilePath="+documentViewer.documentAbsPath+"&searchQuery="+b,a)}function createFullPageRedact(d,g){var k=d.length;for(var c=0;c<k;c++){var a=d[c]-1;var j=createDrawnObject(markupTypes.RectangleRedaction);var f=pageCollection[a];var h=f.attributes.rotateDegrees;var b;if(f.svgMarkupGroup==null||f.svgMarkupGroup==undefined){var e=createSVGElement("g");
e.setAttribute("data-isi","markups-"+(a+1));f.svgMarkupGroup=e}markupId++;j.setId(markupId);initializePreDrawProcess(markupTypes.RectangleRedaction,j,f.svgMarkupGroup,g);j.shapes.group.setAttributeNS(null,"data-isi","redaction-"+markupId);j.setX(0);j.setY(0);j.setWidth(f.attributes.pageWidth);j.setHeight(f.attributes.pageHeight);j.setFontColor("rgb(255, 255, 255)");j.setFillColor("rgba(0, 0, 0, 1)");j.visibilityMode=visibilityMode.Shown;j.setOpacity(1);j.setText(g);j.rotateTextObject(h);attachSnapToDrag(j.shapes.group);f.addMarkupObject(j);showHideRedactedFileContent(j,a+1)}}function createHighlightAnnotations(b,c){var a;a=createDrawnObject(markupTypes.SearchHighlight);markupId++;a.setId(markupId);initializePreDrawProcess(markupTypes.SearchHighlight,a,b,undefined);a.setX(parseFloat(c[0]));a.setY(parseFloat(c[1]));a.setWidth(parseFloat(c[2]));a.setHeight(parseFloat(c[3]));a.setOpacity(0.5);a.setFillColor(defaultHighlightColor);return a}function clearAllSearchHighlights(){var a=pageCollection.length;
for(var b=0;b<a;b++){if(pageCollection[b].highlightCollection.length>0){pageCollection[b].clearHighlights()}}}function hidePrintModal(){var a=$(getElement("blocker"));var b=$(getElement("DV-PrintModal"));b.css("display","none");a.css("display","none")}var fitToWidthHandler=function(){isFitContent=!isFitContent;$(getElement("fitToWidth")).toggleClass("active-state");fitToWidthViewablePages();if(!isFitContent){transferTextAreaValuetoDiv(lastSelectedDivReason);zoomAllPages(scaleFactor)}};try{document.getElementById("fitToWidth").addEventListener("mouseup",fitToWidthHandler)}catch(err){console.log(err)}function fitToWidthViewablePages(){var c=isFitContent;var b=getViewerContainerWidth();function a(){var k=$(getElement("viewer-document-wrapper"));viewerChild=k.children(".pageContent"),pageCount=viewerChild.length;var l=$(getElement("viewerContainer"));var j=curscrollPercentage;preZoomPageNo=parseInt($(".current-page").val());zoomScroll=true;var f=k.children(".pageContent:has(svg)");var g=f.length;
var m;var e;var d;for(var h=0;h<g;h++){d=f[h];e=d.id;e=e.substring(e.indexOf("_page_")+6,e.length)-1;m=pageCollection[e];newFit(m,d.firstChild.firstChild,c,b)}HScrollBarChecker();getScrollHeightPercentage(pageCount);l.scrollTop(currentScrollVal(j,scrollDiff))}a()}function getViewerContainerWidth(){return parseFloat(document.getElementById("viewer-document-wrapper").offsetWidth-20)}function getFitToWidthScaleFactor(a){return parseFloat(parseFloat(document.getElementById("viewer-document-wrapper").offsetWidth-20)/a)}function newFit(s,f,l,m){var e,c,n=s.attributes.rotateDegrees;if(n===90||n===270){e=m/s.attributes.pageHeight;c=parseFloat(s.attributes.pageWidth*e)}else{e=m/s.attributes.pageWidth;c=parseFloat(s.attributes.pageHeight*e)}var r,d=f.transform.animVal.getItem(0).matrix.d,q=(d*1)/e,i=f.parentNode.parentNode,k=s.attributes,p=k.pageWidth,b=k.pageHeight,t=0,j=0,a=0,o=3,h=e,g=e;if(l&&(originalScaleFactor===-1||isResizing)){console.log(isResizing);if(!isResizing){originalScaleFactor=scaleFactor;
scaleFactor=e}else{if(isResizing){scaleFactor=e}}}else{if(!l){if(originalScaleFactor!=-1){scaleFactor=originalScaleFactor}originalScaleFactor=-1}}if(!l&&!isResizing){i.style.width=k.pageWidth+"px";i.style.height=k.pageHeight+"px";r=parseMatrix(f.getAttributeNS(null,"transform"),0,scaleFactor);r=parseMatrix(r,3,scaleFactor)}else{if(k.isFitted===false){if(n===90||n===270){i.style.height=parseFloat(p*e)+"px";i.style.width=parseFloat(b*e)+"px"}else{i.style.height=parseFloat(b*e)+"px";i.style.width=parseFloat(p*e)+"px"}}switch(k.rotateDegrees){case 90:case 270:a=1;o=2;break}switch(k.rotateDegrees){case 90:g*=-1;break;case 270:h*=-1;break;case 180:h*=-1;g*=-1;break}r=parseMatrix(f.getAttributeNS(null,"transform"),a,h);r=parseMatrix(r,o,g);if(k.rotateDegrees==270){r=parseMatrix(r,5,parseFloat(p*e));console.log(r)}else{if(k.rotateDegrees==90){r=parseMatrix(r,4,parseFloat(b*e))}}}console.log(scaleFactor);setZoomLabel(parseFloat((scaleFactor*100)).toFixed(0)+"%");f.setAttributeNS(null,"transform",r);
reCalculateHandles(s);getScrollHeightPercentage(pageCollection.length);s.rotateTextMarkups(s.attributes.rotateDegrees)}function disableFitToWidth(){if(isFitContent===true){fitToWidthHandler()}}function createAJAXRequest(c,a,e,f){var d=new XMLHttpRequest(),b=new Date().getTime();d.id=b;d.open(c,a,true);d.send();d.onreadystatechange=function(){if(this.readyState==4&&this.status==200){if(e){e(this)}delete XHRList[b]}else{if(f){f(this)}}};XHRList[b]=d}function cancelALLAJAXRequests(){var a=XHRList,b=a.length;for(var c in a){a[c].abort()}XHRList=[]}function createMarkupObject(d,b,a){var e={},c={};c=deepCopy(c,d.attributes);e.attributes=c;e.id=c.id;e.markupType=d.markupType;e.shapes=createShapeObject(d.markupType,a);attachShapeFunctions(e,a);attachDrawFinishFunction(e,a);var f=createSVGElement("g");f.setAttribute("data-isi","markups-"+b);initializePreDrawProcess(e.markupType,e,f,e.attributes.text,a);initializeAnnotationObject(e,a);return e}function deepCopy(a,c){for(var b in c){if(typeof c[b]==="object"&&c[b]!==null){a[b]=a[b]||{};
arguments.callee(a[b],c[b])}else{a[b]=c[b]}}return a}function getElement(a){return document.getElementById(a)}function navigateToNextTerm(f){var d=highlightWalkerCollection[f];jumpPage(parseInt(d.pageId+1));var h=$(document.getElementById("viewerContainer"));var a=d.rectangles;var g=a.length;h.scrollTop(0);var c="udv_page_"+(d.pageId+1);var j=parseInt($(document.getElementById(c)).position().top);var b=j-60;var e=d.highlightPosition;h.scrollTop(b+((e)+(10)));for(var i=0;i<g;i++){changeToActiveHighlightColor(a[i])}}function changeToHighlightColor(a){a.setFillColor(defaultHighlightColor)}function changeToActiveHighlightColor(a){a.setFillColor(defaultActiveHighlightColor)}function shadeBlendConvert(c,k,l){if(typeof(c)!="number"||c<-1||c>1||typeof(k)!="string"||(k[0]!="r"&&k[0]!="#")||(typeof(l)!="string"&&typeof(l)!="undefined")){return null}if(!this.sbcRip){this.sbcRip=function(h){var f=h.length,b=new Object();if(f>9){h=h.split(",");if(h.length<3||h.length>4){return null}b[0]=d(h[0].slice(4)),b[1]=d(h[1]),b[2]=d(h[2]),b[3]=h[3]?parseFloat(h[3]):-1
}else{switch(f){case 8:case 6:case 3:case 2:case 1:return null}if(f<6){h="#"+h[1]+h[1]+h[2]+h[2]+h[3]+h[3]+(f>4?h[4]+""+h[4]:"")}h=d(h.slice(1),16),b[0]=h>>16&255,b[1]=h>>8&255,b[2]=h&255,b[3]=f==9||f==5?a(((h>>24&255)/255)*10000)/10000:-1}return b}}var d=parseInt,a=Math.round,e=k.length>9,e=typeof(l)=="string"?l.length>9?true:l=="c"?!e:false:e,j=c<0,c=j?c*-1:c,l=l&&l!="c"?l:j?"#000000":"#FFFFFF",g=sbcRip(k),m=sbcRip(l);if(!g||!m){return null}if(e){return"rgb("+a((m[0]-g[0])*c+g[0])+","+a((m[1]-g[1])*c+g[1])+","+a((m[2]-g[2])*c+g[2])+(g[3]<0&&m[3]<0?")":","+(g[3]>-1&&m[3]>-1?a(((m[3]-g[3])*c+g[3])*10000)/10000:m[3]<0?g[3]:m[3])+")")}else{return"#"+(4294967296+(g[3]>-1&&m[3]>-1?a(((m[3]-g[3])*c+g[3])*255):m[3]>-1?a(m[3]*255):g[3]>-1?a(g[3]*255):255)*16777216+a((m[0]-g[0])*c+g[0])*65536+a((m[1]-g[1])*c+g[1])*256+a((m[2]-g[2])*c+g[2])).toString(16).slice(g[3]>-1||m[3]>-1?1:3)}}var inheritsFrom=function(b,a){b.prototype=Object.create(a.prototype)};var svgNamespace="http://www.w3.org/2000/svg",xmlNamespace="http://www.w3.org/2000/xmlns/",markupTypes={Circle:0,Rectangle:1,Line:2,Arrow:3,Text:4,RectangleRedaction:5,SearchHighlight:6},markupSaveType={Circle:"circle",CircleFilled:"circle_filled",Rectangle:"rectangle",RectangleFilled:"rectangle_filled",Line:"line",Arrow:"arrow",Text:"text",RectangleRedaction:"rectangle_filled_redact"},pagePrefix="udv",pagePrefixId="udv_page_",handleCollection=[],pageCollection=[],tempHighlightCollection={};
markUpCollection={},selectedObjectCollection=[],editButtonHeight="26",editButtonWidth="26",isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,isFirefox=typeof InstallTrigger!=="undefined",isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,isChrome=!!window.chrome&&!isOpera,isIE=false||!!document.documentMode,layerOptions={Top:"Top",Bottom:"Bottom",Forward:"Forward",Backward:"Backward"},visibilityMode={Shown:1,Hidden:0,Transparent:0.2},defaultFillColorShapes="rgb(0, 0, 255)",defaultHighlightColor="rgb(0,178,255)",defaultActiveHighlightColor="rgb(203,203,1)",defaultFillColorText="rgb(255, 255, 255)",defaultFillColorBorder="rgb(0, 0, 0)",defaultFontColor="rgb(0, 0, 0)",defaultLineColor="rgb(0, 0, 0)",defaultFillWidthShapes="4",defaultFillWidthLine="6",defaultOpacity="100%",erroredPage={height:1056,width:816},redactionFontSize=12;var documentAbsPath="";var currentView,selectedObject={pageIndex:-1,markupIndex:-1},selectedObjectCollection=[],currentSelectedMarkup,selectedPages=[],scaleFactor=1,logFileStatus,printOptions,timeOutCollection=[],isPrintingCancelled=false,isSaved=false,isFitContent=false,highlightWalkerCollection=[],currentTermIndex=0,originalScaleFactor=-1,XHRList={},isResizing=false,lastQuery;
PrintingOptions=function(){this.withRedaction=document.getElementById("w_redaction").checked?true:false;this.withAnnotation=document.getElementById("w_annotation").checked?true:false;this.autoOrientation=document.getElementById("orient_auto").checked?true:false;this.portrait=document.getElementById("orient_port").checked?true:false;this.landscape=document.getElementById("orient_land").checked?true:false;this.currentPage=document.getElementById("printCurrent").checked?true:false;this.allPages=document.getElementById("printAll").checked?true:false;return this};AnnotationObject=function(a,b){this.pageId=a;this.markupId=b;return this};Redaction=function(e,b,d,c,a){this.id=e;this.rectangleSVG=b;this.redactionReasonDiv=d;this.foreignGroup=a;this.textReason=c;return this};function RectangleToolBox(){}function CircleToolBox(){}function LineToolBox(){}function ArrowToolBox(){}function TextAnnotationToolBox(){this.fontColor=defaultFontColor;this.fontSize="12";this.fontFamily="Arial";this.boldStyle=false;
this.italicStyle=false;this.underlineStyle=false;this.strikeStyle=false;this.horizontalAlign="center";this.verticalAlign="middle";this.fillColor=defaultFillColorText;this.continuous=false}function RectangleRedction(){this.redactionReason}function RedactionRectangleToolBox(){this.reason="Redaction";this.continuous=false}function defaultShapeSettings(){this.fillColor=defaultFillColorShapes;this.borderColor=defaultFillColorBorder;this.borderWeight=defaultFillWidthShapes;this.opacityLevel=defaultOpacity;this.opacityLevelDecimal=this.opacityLevel.replace("%","")/100;this.setOpacityLevel=function(a){this.opacityLevel=a;this.opacityLevelDecimal=this.opacityLevel.replace("%","")/100};this.continuous=false}RectangleToolBox.prototype=new defaultShapeSettings();CircleToolBox.prototype=new defaultShapeSettings();LineToolBox.prototype=new defaultLineSettings();ArrowToolBox.prototype=new defaultArrowSettings();TextAnnotationToolBox.prototype=new defaultShapeSettings();function defaultLineSettings(){this.fillColor=defaultFillColorShapes;
this.borderWeight=defaultFillWidthLine;this.opacityLevel=defaultOpacity;this.opacityLevelDecimal=this.opacityLevel.replace("%","")/100;this.setOpacityLevel=function(a){this.opacityLevel=a;this.opacityLevelDecimal=this.opacityLevel.replace("%","")/100};this.continuous=false}function defaultArrowSettings(){this.fillColor=defaultLineColor;this.borderWeight=defaultFillWidthLine;this.opacityLevel=defaultOpacity;this.opacityLevelDecimal=this.opacityLevel.replace("%","")/100;this.setOpacityLevel=function(a){this.opacityLevel=a;this.opacityLevelDecimal=this.opacityLevel.replace("%","")/100};this.continuous=false}function setDefaultLineProperties(a){a.borderWeight=defaultFillWidthLine;a.opacityLevel=defaultOpacity;a.opacityLevelDecimal=a.opacityLevel.replace("%","")/100;a.setOpacityLevel=function(b){a.opacityLevel=b;a.opacityLevelDecimal=a.opacityLevel.replace("%","")/100}}RedactionMarkup=function(b,e,a,c,d){this.x=b;this.y=e;this.height=a;this.width=c;this.text=d;return this};HandleGroup=function(a,b){this.parentHandle=a;
this.handleCollection=b};MarkObject=function(a,b){this.pageIndex=a;this.markupId=b;return this};UDVPage=function(g,a,d,c,f,b){function e(){var h=document.createElement("div");h.style.position="absolute";h.style.width="10px";h.style.height="10px";h.style.left="0px";h.style.top="0px";h.style.overflow="visible";h.id="handlegroup-"+g;return h}this.attributes={id:pagePrefixId+g,pageHeight:d,pageWidth:c,rotateDegrees:0,rotateX:parseFloat(d)/2,rotateY:parseFloat(d)/2,pageIndex:a,isFitted:false};this.svgMarkupGroup=f;this.svgHighlightGroup=b;this.tempHighlights=[];this.svgPage;this.markups=[];this.highlightCollection=[];this.divHandles=e();this.handleCollections=[];this.selectedMarkupIds=[];this.isPageRequested=false;this.isErroredPage=false;this.textMarkups=[];this.retrieveMarkObjectInPage=function(j){var k=this.markups.length;for(var h=0;h<k;h++){if(this.markups[h].attributes.id==j){return this.markups[h]}}return null};this.retrieveLayeredMarkObjectInPage=function(h){var k=this.markups.length;
for(var j=0;j<k;j++){if(this.markups[j].attributes.layerIndex==h){return this.markups[j]}}return null};this.rotateTextMarkups=function(j){for(var h=0;h<this.textMarkups.length;h++){this.textMarkups[h].rotateTextObject(j)}};this.rotatedDimensions=function(){var h=this.attributes.rotateDegrees;var i={height:0,width:0};if(h===0||h===180||h===360){i.height=this.attributes.pageHeight;i.width=this.attributes.pageWidth;return i}else{i.height=this.attributes.pageWidth;i.width=this.attributes.pageHeight;return i}};this.isMarkupSelected=function(h){if(this.selectedMarkupIds.indexOf(h)>=0){return true}return false};this.selectMarkup=function(i,h){this.selectedMarkupIds.push(i);selectedObjectCollection.push(new AnnotationObject(this.attributes.pageIndex,i));this.handleCollections.push(h);if(selectedPages.indexOf(this.attributes.pageIndex)<0){selectedPages.push(this.attributes.pageIndex)}};this.updateHandles=function(h,i){this.handleCollections[h]=i};this.deSelectMarkup=function(j){var i=this.selectedMarkupIds.indexOf(j),h=checkCollection(selectedObjectCollection,j);
this.selectedMarkupIds.splice(i,1);selectedObjectCollection.splice(h,1);clearMarkupHandle(this.handleCollections[i]);this.handleCollections.splice(i,1);if(this.selectedMarkupIds.length==0){selectedPages.splice(selectedPages.indexOf(this.attributes.pageIndex),1)}};this.clearAllSelectedMarkups=function(h){this.selectedMarkupIds=[];this.handleCollections=[];if(selectedObjectCollection.length>1){for(var k=selectedObjectCollection.length-1;k>=0;k--){if(selectedObjectCollection[k].pageId==h){selectedObjectCollection.splice(k,1)}}}else{selectedObjectCollection=[]}clearChildren(this.divHandles);var j=selectedPages.indexOf(this.attributes.pageIndex);if(j>-1){selectedPages.splice(j,1)}};this.retrieveMarkHandles=function(k){var j=this.markups.length;for(var h=0;h<j;h++){if(this.handleCollections[h].id==checkId){return this.handleCollections[h]}}return null};this.getPageCoordinates=function(h,i){return convertToSVGCoordinateSpace(this.svgPage,h,i)};this.addMarkupObject=function(h){this.markups.push(h);
if(h.markupType===markupTypes.RectangleRedaction||h.markupType===markupTypes.Text){this.textMarkups.push(h)}};this.removeAllAnnotations=function(){this.clearAllSelectedMarkups();clearChildren(this.svgMarkupGroup);this.markups=[]};this.hasDrawnObject=function(){if(this.markups.length>0){return true}return false};this.hasRedactions=function(){var h=this.markups.length;for(var i=0;i<h;i++){if(this.markups[i].markupType===markupTypes.RectangleRedaction){return true}}return false};this.hasAnnotations=function(){var h=this.markups.length;if(h===0){return false}for(var i=0;i<h;i++){if(this.markups[i].markupType!=markupTypes.RectangleRedaction){return true}}return false};this.isRotationAdjusted=function(){if(this.attributes.rotateDegrees>0){return true}return false};this.addHighlight=function(k,j){var h=null;var i={pageId:0,highlightPosition:0,rectangles:[]};if(k!=undefined){if(!this.svgHighlightGroup){this.svgHighlightGroup=createSVGElement("g");this.svgHighlightGroup.setAttribute("data-isi","highlights-"+a)
}if(this.svgHighlightGroup.parentNode){h=createHighlightAnnotations(this.svgHighlightGroup,k);this.highlightCollection.push(h);return h}else{}}else{}};this.clearHighlights=function(){clearChildren(this.svgHighlightGroup);this.tempHighlights=[]};this.initializeHighlights=function(){var l=this.tempHighlights.length;if(l>0){if(this.svgHighlightGroup.parentNode){if(this.tempHighlights.length>0){var i;for(var p=0;p<highlightWalkerCollection.length;p++){if(highlightWalkerCollection[p].pageId===this.attributes.pageIndex){i=highlightWalkerCollection[p];break}}for(var h=0;h<this.tempHighlights.length;h++){var m=this.tempHighlights[h];var j=[];for(var o=0;o<m.length;o++){var k=createHighlightAnnotations(this.svgHighlightGroup,m[o]);this.highlightCollection.push(k);j.push(k)}i.rectangles=j}this.tempHighlights=[]}}}};this.addHitTerm=function(p){var k,n=p.length,o=[],h,m,j=[];k={pageId:this.attributes.pageIndex,highlightPosition:p[0][1],rectangles:[]};for(var l=0;l<n;l++){m=p[l];h=this.addHighlight(m);
if(h!=null&&h!=undefined){k.rectangles.push(h)}}highlightWalkerCollection.push(k);if(k.rectangles===null||k.rectangles===undefined){this.tempHighlights.push(p)}};return this};DrawnRectangle=function(b,d,c,a){this.x=b;this.y=d;this.width=c;this.height=a;return this};DrawnRectangle.prototype.toString=function(){return"x: "+this.x+",y: "+this.y+"width: "+this.width+"height: "+this.height};var pccId=1;function loadDocument(b,e,d,a,f){if((documentViewer.documentAbsPath===undefined&&b!=undefined)||(b!=documentViewer.documentAbsPath)){clearAlert();documentViewer.isViewable=false;documentViewer.documentAbsPath=b;documentViewer.markupPath=e;cleanUpViewerDocWrapper();if(!e){e=""}if(typeof d==="undefined"){d=true}if(typeof a==="undefined"){a=true}if(!e||e===""||typeof e==="undefined"){a=false}if(documentViewer.allowRotation){d=true}else{d=false}if(d&&f){documentViewer.rotationMarkupPath=f}var c=documentViewer.autoGeneration;initializeDoc(b,e,true,1,d,a,c)}}function executeTimeout(b,a){timeOutCollection.push(setTimeout(b,a))
}function clearTimeoutCollection(){var a=timeOutCollection.length;for(var b=0;b<a;b++){clearTimeout(timeOutCollection[b])}}function cleanUpViewerDocWrapper(){cancelALLAJAXRequests();var h=document.getElementById("DV-PrintModal");if(h.style.display==="block"){hidePrintModal()}var c=$(getElement("fitToWidth"));var d=c.attr("class");var e=d.indexOf("active-state");if(isFitContent){d=d.substring(0,e);c.attr("class",d);isFitContent=false;originalScaleFactor=-1}isResizing=false;isPrintingCancelled=false;isSaved=false;clearTimeoutCollection();clearDownloadTimer();logFileStatus=null;selectedObject={pageIndex:-1,markupIndex:-1};selectedObjectCollection=[];currentSelectedMarkup;scaleFactor=1;pageCollection=[];handleCollection=[];markUpCollection={};selectedObjectCollection=[];annotationObject=null;drawnObject=null;tempId=0;readyToDraw=false;lastDrawnDivReason=false;lastSelectedDivReason=null;hasRedactedFile=false;var j=document.getElementById("viewer-document-wrapper");clearChildren(j);$(j).removeClass("cursorCrosshair");
$(j).css("cursor","default");setZoomLabel("100%");$(".current-page").val(0);$(".pages").text(0);$(getElement("cancelDownloadBtn")).trigger("click");$(getElement("cancelfpRedactionBtn")).trigger("click");$(getElement("closeRedact")).trigger("click");$(getElement("closeAnnotateBox")).trigger("click");$(".tab-menu #pageTab").trigger("click");$(getElement("DV-Notif")).css({top:"0",display:"none",visibility:"hidden"});displayReviewTools(false);var g=$(".selected-visibility-redaction"),b=g.children(".visibility-holder-redaction"),i=g.siblings(".visibility-available-container").children()[0].getAttribute("src");b.attr("src",i);b.attr("data-visibility","Show Redaction");b.attr("title","Change Redaction Visibility to Semi-Transparent");var a=$(".selected-visibility-annotation"),k=a.children(".visibility-holder-annotation"),f=a.siblings(".visibility-available-container").children()[0].getAttribute("src");k.attr("src",f);k.attr("data-visibility","Show Annotation");k.attr("title","Change Annotation Visibility to Semi-Transparent");
document.removeEventListener("mousedown",initStartPosition,false);checkNavigation();disableHandTool();markupId=0;pccId=1;document.getElementById("w_redaction").checked=true;document.getElementById("w_annotation").checked=false;document.getElementById("orient_auto").checked=true;document.getElementById("orient_port").checked=false;document.getElementById("orient_land").checked=false;document.getElementById("printAll").checked=true;document.getElementById("printCurrent").checked=false;dedactiveAnnotation()}function initializeDoc(d,f,c,b,e,a,h){documentAbsPath=d;var g=function(l){logFileStatus=l.responseText;var i=function(){initializeDoc(d,f,false,b+1)};var j=function(){initializeDoc(d,f,false,1)};if(documentViewer.isMobile===true){document.getElementById("mobile-warning").display="block";$(".downloadDocument").hide()}else{if(documentViewer.redactTab===false){$(".downloadDocument").hide()}}switch(logFileStatus){case"FileNotFound":displayReviewTools(false);showAlert("Error: Source file not found!","error");
break;case"GenerateViewer":if(c&&h){var k=new XMLHttpRequest();k.open("POST",documentViewer.domain+"/DocViewerWS/rest/convert/tosvg?nativeFilePath="+d+"&timezone="+documentViewer.timezone,true);k.send()}else{if(c&&!h){showAlert("Error: Viewer is not configured to generate files on-the-fly!","error")}}executeTimeout(j,200);break;case"Queued":case"ConvertingToPDF":if(b<=2){displayReviewTools(false)}if(b<=25){executeTimeout(i,200)}else{if(b<=55){executeTimeout(i,2000)}else{if(b<=175){if(b===56){showAlert("Conversion still in progress...","warning")}executeTimeout(i,2000)}else{showAlert("Document is not ready for viewing. Refresh the page after few minutes.","warning")}}}break;case"Timeout":case"ConversionError":case"PasswordProtected":case"Unsupported":case"Encrypted":case"Corrupted":displayReviewTools(false);displayErrorPlaceHolder();break;case"ConvertingToSVG":logFileStatusChecker();case"Completed":documentViewer.isViewable=true;if(documentViewer.viewerLoaded){documentViewer.viewerLoaded(true)
}hideNotification();completed(d,f,e,a)}};createAJAXRequest("GET",documentViewer.domain+"/DocViewerWS/rest/document/logFileStatus?nativeFilePath="+d+breakCacheParameter(),g);req.send()}function completed(c,e,d,a){var b=new XMLHttpRequest();b.open("GET",documentViewer.domain+"/DocViewerWS/rest/document/pageAttributes?nativeFilePath="+c+breakCacheParameter(),true);b.send();b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){var f=JSON.parse(b.responseText);displayReviewTools(true);getPageAttributes(f);if(documentViewer.rotationMarkupPath&&d){loadRotationBeforeMarkups(a,d,e,documentViewer.rotationMarkupPath)}else{getXMLFromServer(a,d,e);if(documentViewer.loadCallback){console.log("callback will be executed");documentViewer.loadCallback()}}}}}function loadRotationBeforeMarkups(a,e,d,c){var b=new XMLHttpRequest();b.open("GET",documentViewer.domain+"/DocViewerWS/rest/convert/openMarkup?path="+c,true);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.onreadystatechange=function(){if(b.readyState!==4){return
}if(b.status!==200&&b.status!==304){return}if(b.readyState==4&&b.status==200){var i=parseXMLToDom(b.responseText),j,m;if(j){j=i.getElementsByTagName("documentAnnotations")[0];m=j.getAttribute("version")}var h=i.getElementsByTagName("page");var n=h.length;if(n>0){for(var g=0;g<n;g++){var l=h[g];var k=parseInt(l.getAttribute("pageIndex"));var q=pageCollection[k];if(q){if(l){var s=l.getAttribute("rotateDegrees")?l.getAttribute("rotateDegrees"):0;var r=l.getAttribute("rotateX")?l.getAttribute("rotateX"):0;var p=l.getAttribute("rotateY")?l.getAttribute("rotateY"):0;q.attributes.rotateDegrees=parseInt(s);q.attributes.rotateX=parseInt(r);q.attributes.rotateY=parseInt(p)}}}}getXMLFromServer(a,false,d);if(documentViewer.loadCallback){console.log("called back");documentViewer.loadCallback()}}};b.send()}function logFileStatusChecker(){var a=new XMLHttpRequest();a.open("GET",documentViewer.domain+"/DocViewerWS/rest/document/logFileStatus?nativeFilePath="+documentAbsPath+breakCacheParameter(),true);
a.send();a.onreadystatechange=function(){if(a.readyState==4&&a.status==200){logFileStatus=a.responseText;if(logFileStatus!=="Completed"){executeTimeout(logFileStatusChecker,200)}else{displayDocCompletedTools()}}}}function getPageAttributes(a){var f=$(".pages"),k=parseInt(a.pageCount);pagesLength=parseInt(a.pages.length);if(f){f.text(k);$(".current-page").val(1);if(k==pagesLength){for(var d=0;d<pagesLength;d++){var b=a.pages[d].id,j=a.pages[d].width,c=a.pages[d].height;var h=new UDVPage(b,d,c,j,null);pageCollection.push(h)}}}var g=$(getElement("nextPage")),e=$(getElement("lastPage"));if(k>1){$("#nextPage > i, #lastPage > i").css({opacity:"1",cursor:"pointer"});g.css("cursor","pointer").data("enable",true);e.css("cursor","pointer").data("enable",true)}else{if(k==1){$(getElement("firstBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("prevBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("lastBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("nextBtn")).css({cursor:"not-allowed",opacity:"0.5"})
}else{if(k==0){$(getElement("firstBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("prevBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("lastBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("nextBtn")).css({cursor:"not-allowed",opacity:"0.5"})}}}if(documentViewer.allPagesReady){documentViewer.allPagesReady()}}function clearAllDocumentMarkup(){for(var a=0;a<pageCollection.length;a++){pageCollection[a].removeAllAnnotations()}}function loadAnnotations(a,b){clearAllDocumentMarkup();loadMarkup(true,true,a,false);if(b){documentViewer.markupPath=a}resetDefaultVisibilityMode();checkRedactedFile()}function loadAnnotationsNoRotation(a,b){clearAllDocumentMarkup();if(b){documentViewer.markupPath=a}loadMarkup(true,false,a,false);resetDefaultVisibilityMode();checkRedactedFile()}function loadRotations(a){clearAllDocumentMarkup();loadMarkup(true,false,a,true);resetDefaultVisibilityMode()}function loadRotationsClean(a,b){loadMarkup(false,true,a,false);if(b){documentViewer.markupPath=a
}checkRedactedFile()}function loadMarkup(e,b,f,c){var d=new XMLHttpRequest();var a="openMarkup";if(c){a="openTempMarkup"}d.open("GET",documentViewer.domain+"/DocViewerWS/rest/convert/"+a+"?path="+f+breakCacheParameter(),true);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.onreadystatechange=function(){if(d.readyState!==4){return}if(d.status!==200&&d.status!==304){return}if(d.readyState==4&&d.status==200){var x=parseXMLToDom(d.responseText),y,k;if(y){y=x.getElementsByTagName("documentAnnotations")[0];k=y.getAttribute("version")}var s=x.getElementsByTagName("page");var g=s.length;if(g>0){for(var v=0;v<g;v++){var l=s[v];var n=parseInt(l.getAttribute("pageIndex"));var m=pageCollection[n];if(m){if(l){if(b){var t=l.getAttribute("rotateDegrees")?l.getAttribute("rotateDegrees"):m.rotateDegrees;var r=l.getAttribute("rotateX")?l.getAttribute("rotateX"):m.attributes.rotateX;var q=l.getAttribute("rotateY")?l.getAttribute("rotateY"):m.attributes.rotateY;m.attributes.rotateDegrees=parseInt(t)?parseInt(t):0;
m.attributes.rotateX=parseInt(r)?parseInt(t):0;m.attributes.rotateY=parseInt(q)?parseInt(t):0}if(e){var A=l.childNodes;var z=A.length;if(z>0){var j=createSVGElement("g");j.setAttribute("data-isi","markups-"+(n+1));for(var w=0;w<z;w++){var h=A[w];if(h.nodeName==="#text"){continue}if(h.attributes&&h.attributes.nodeId){h.attributes=createMarkupAttributes(h)}var u=processAnnotationXMLNode(h,m);if(u){m.addMarkupObject(u);var p=new Snap(u.shapes.group);p.drag();p.drag(function(){},function(){var o=$(getElement("viewer-document-wrapper"));var i=$(getElement("page-handtool"));var B=document.getElementById("page-handtool");B.setAttributeNS(null,"data-drag","unable");i.data("drag","unable").removeClass("selected-tool");o.removeDragScroll()},function(){var i=$(getElement("page-handtool"));var o=document.getElementById("page-handtool");o.setAttributeNS(null,"data-drag","enable");if(i.data("drag")==="unable"){i.trigger("mouseup")}})}}}}}if(b){rotatePageOnLoad(n,m.attributes.rotateDegrees)}else{m.rotateTextMarkups(m.attributes.rotateDegrees)
}}}}}};d.send()}function getXMLFromServer(c,a,d){var b=new XMLHttpRequest();b.open("GET",documentViewer.domain+"/DocViewerWS/rest/convert/openMarkup?path="+d,true);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.onreadystatechange=function(){if(b.readyState!==4){return}if(b.status!==200&&b.status!==304){return}if(b.readyState==4&&b.status==200){var y=parseXMLToDom(b.responseText),z,k;if(z){z=y.getElementsByTagName("documentAnnotations")[0];k=z.getAttribute("version")}var t=y.getElementsByTagName("page");var e=t.length;if(e>0){for(var w=0;w<e;w++){var l=t[w];var q=l.getAttribute("pageIndex")?l.getAttribute("pageIndex"):(parseInt(l.getAttribute("id"))-1);var n=parseInt(q);var m=pageCollection[n];if(m){if(l){if(a){var u=l.getAttribute("rotateDegrees")?l.getAttribute("rotateDegrees"):0;var s=l.getAttribute("rotateX")?l.getAttribute("rotateX"):0;var r=l.getAttribute("rotateY")?l.getAttribute("rotateY"):0;m.attributes.rotateDegrees=parseInt(u);m.attributes.rotateX=parseInt(s);
m.attributes.rotateY=parseInt(r)}if(c){var B=l.childNodes;var A=B.length;if(A>0){var j=createSVGElement("g");j.setAttribute("data-isi","markups-"+(n+1));m.svgMarkupGroup=j;for(var x=0;x<A;x++){var g=B[x];if(g.nodeName==="#text"){continue}if(g.attributes&&g.attributes.nodeId){g.attributes=createMarkupAttributes(g)}var v=processAnnotationXMLNode(g,m);if(v){m.addMarkupObject(v);var h=createSVGElement("g");h.setAttribute("style","display: block");var p=new Snap(h);p.drag();p.drag(function(){},function(){var i=$(getElement("viewer-document-wrapper"));var f=$(getElement("page-handtool"));var o=document.getElementById("page-handtool");o.setAttributeNS(null,"data-drag","unable");f.data("drag","unable").removeClass("selected-tool");i.removeDragScroll()},function(){var f=$(getElement("page-handtool"));var i=document.getElementById("page-handtool");i.setAttributeNS(null,"data-drag","enable");if(f.data("drag")==="unable"){f.trigger("mouseup")}})}}m.svgMarkupGroup=j}}}}}}else{}loadDivPages();loadSvgOnViewablePage();
if(documentViewer.loadAnnotationsCallback){documentViewer.loadAnnotationsCallback()}if(documentViewer.isMobile===true){displayVisibilityToolsForAvailableObjects()}}};b.send()}function parseXMLToDom(b){var a;if(window.DOMParser){a=function(c){return(new window.DOMParser()).parseFromString(c,"text/xml")}}else{if(typeof window.ActiveXObject!=="undefined"&&new window.ActiveXObject("Microsoft.XMLDOM")){a=function(d){var c=new window.ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML(d);return c}}else{a=function(){return null}}}return a(b)}function createAttributes(b){var f={};var d=b.attributes;var c=b.attributes.length;var j="";for(var e=0;e<c;e++){j=d[e].nodeName;if(j==="type"){f[j]=parseInt(d[e].nodeValue)}else{if(j==="rx"||j==="ry"||j==="cx"||j==="cy"||j==="x"||j==="y"||j==="height"||j==="width"||j==="id"){f[j]=parseFloat(d[e].nodeValue)}else{f[j]=d[e].nodeValue}}if(d[e].nodeName==="id"){if(markupId<f[j]){markupId=f[j]}}}if(f.type===markupTypes.Text){if(!b.attributes.nodeId){var h=b.childNodes;
var g=h.length;var l=[];for(var a=0;a<g;a++){l.push(h[a].textContent)}f.text=l}else{d.text=d.text.nodeValue;var l=[];l.push(d.text);f.text=l}}if(f.type===markupTypes.RectangleRedaction){var k=f.text;f.text=[];f.text.push(k)}return f}function createMarkupAttributes(l){var g={};var d=l.attributes;var b=d.length,k;for(var h=0;h<b;h++){g[d[h].name]=d[h].value}function c(n){var p=parseInt(n>>16);var o=parseInt(n>>8&255);var i=parseInt(n&255);return"rgb("+p+","+o+","+i+")"}function f(n){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return"("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+")"}if(isNaN(g.drawType)){switch(g.drawType){case markupSaveType.Circle:case markupSaveType.CircleFilled:g.cx=(parseInt(g.x))+(parseInt(g.width)/2);g.cy=(parseInt(g.y))+(parseInt(g.height)/2);g.rx=parseInt(g.width)/2;g.ry=parseInt(g.height)/2;l.setAttribute("cx",(parseInt(g.x))+(parseInt(g.width)/2));l.setAttribute("cy",(parseInt(g.y))+(parseInt(g.height)/2));l.setAttribute("rx",parseInt(g.width)/2);
l.setAttribute("ry",parseInt(g.height)/2);delete g.x;delete g.y;break;case markupSaveType.Text:case markupSaveType.RectangleRedaction:if(g.drawType===markupSaveType.Text){if(window.DOMParser){try{var a;a=new DOMParser();var m;m=a.parseFromString(l.childNodes[0].data,"text/xml");var j=getAllNodes(m);g.fontColor=j.FONT[2].nodeValue;g.fontFamily=j.FONT[0].nodeValue;g.fontSize=parseInt(j.FONT[1].nodeValue);g.boldStlye=j.B?true:false;g.italicStyle=j.I?true:false;g.underLineStrikeStyle=j.U?true:false;g.horizontalAlign=j.P[0].nodeValue.toLowerCase();g.text=j.text;l.setAttribute("text",j.text);l.setAttribute("fontColor",j.FONT[2].nodeValue);l.setAttribute("fontFamily",j.FONT[0].nodeValue);l.setAttribute("fontSize",parseInt(j.FONT[1].nodeValue));l.setAttribute("boldStlye",j.B?true:false);l.setAttribute("italicStyle",j.I?true:false);l.setAttribute("underLineStrikeStyle",j.U?true:false);l.setAttribute("horizontalAlign",j.P[0].nodeValue.toLowerCase())}catch(e){}}}else{g.text=g.meta;l.setAttribute("text",g.meta)
}case markupSaveType.Rectangle:case markupSaveType.RectangleFilled:g.x=(parseInt(g.x))+(parseInt(g.width));g.y=(parseInt(g.y))+(parseInt(g.height));g.width=parseInt(g.width);g.height=parseInt(g.height);l.setAttribute("x",(parseInt(g.x))+(parseInt(g.width)));l.setAttribute("y",(parseInt(g.y))+(parseInt(g.height)));l.setAttribute("width",parseInt(g.width));l.setAttribute("height",parseInt(g.height));break;case markupSaveType.Arrow:case markupSaveType.Line:g.x1=parseInt(g.x);g.y1=parseInt(g.y);g.x2=(parseInt(g.x))+(parseInt(g.width));g.y2=(parseInt(g.y))+(parseInt(g.height));g.borderWeight=g.lineWidth*6;l.setAttribute("x1",parseInt(g.x));l.setAttribute("y1",parseInt(g.y));l.setAttribute("x2",(parseInt(g.x))+(parseInt(g.width)));l.setAttribute("y2",(parseInt(g.y))+(parseInt(g.height)));l.setAttribute("borderWeight",g.lineWidth*6);delete g.x;delete g.y;break}switch(g.drawType){case markupSaveType.Circle:case markupSaveType.Rectangle:g.fillColor="rgba(255,255,255,0)";g.borderColor=c(g.lineColor);
l.setAttribute("fillColor","rgba(255,255,255,0)");l.setAttribute("borderColor",c(g.lineColor));break;case markupSaveType.CircleFilled:case markupSaveType.RectangleFilled:g.borderColor="rgba(255,255,255,0)";g.fillColor=c(g.fillColor);l.setAttribute("fillColor","rgba(255,255,255,0)");l.setAttribute("borderColor",c(g.fillColor));break;case markupSaveType.Text:g.fontColor=f(g.fontColor);g.fillColor=c(g.fillColor);g.borderColor=c(g.lineColor);g.borderWeight=g.lineWidth;l.setAttribute("fontColor",g.fontColor);l.setAttribute("fillColor",c(g.fillColor));l.setAttribute("borderColor",c(g.lineColor));l.setAttribute("borderWeight",g.lineWidth);break;default:g.fillColor=c(g.fillColor);g.borderColor=c(g.lineColor);l.setAttribute("fillColor",c(g.fillColor));l.setAttribute("lineColor",c(g.lineColor));break}if(!g.opacity){g.opacity=1;l.setAttribute("opacity",1)}}l.setAttribute("id",pccId);g.id=pccId++;switch(g.drawType){case markupSaveType.Circle:case markupSaveType.CircleFilled:l.setAttribute("type",markupTypes.Circle);
g.type=markupTypes.Circle;break;case markupSaveType.Rectangle:case markupSaveType.RectangleFilled:l.setAttribute("type",markupTypes.Rectangle);g.type=markupTypes.Rectangle;break;case markupSaveType.Line:l.setAttribute("type",markupTypes.Line);g.type=markupTypes.Line;break;case markupSaveType.Arrow:l.setAttribute("type",markupTypes.Arrow);g.type=markupTypes.Arrow;break;case markupSaveType.Text:l.setAttribute("type",markupTypes.Text);g.type=markupTypes.Text;break;case markupSaveType.RectangleRedaction:l.setAttribute("type",markupTypes.RectangleRedaction);g.type=markupTypes.RectangleRedaction;break}return g}function createMarkupDrawnObject(c){var a={},b;a.attributes=createAttributes(c);b=a.attributes.type;a.id=a.attributes.id;a.shapes=createShapeObject(b);a.toString=function(){var e="";for(var d in this.attributes){e+="("+d+","+this.attributes[d]+")"}return e};a.markupType=b;attachShapeFunctions(a);attachSnapToDrag(a.shapes.group);attachDrawFinishFunction(a);return a}function getAllNodes(a){var b={};
var c;while(a.firstChild){c=a.firstChild;if(!c.firstChild){b.text=c.data}if(c.nodeName==="#text"){a.removeChild(c)}else{if(c){b=getAllNodes(c);b[c.tagName]=c.attributes;a.removeChild(c)}}}return b}function initializeAnnotationObject(a,e){var c=JSON.parse(JSON.stringify(isIE));if(e!=undefined){isIE=e}var b=a.attributes;switch(b.type){case markupTypes.Circle:a.setCX(b.cx);a.setCY(b.cy);a.setRX(b.rx);a.setRY(b.ry);a.setFillColor(b.fillColor);a.setBorderColor(b.borderColor);a.setBorderWeight(b.borderWeight);a.setOpacity(b.opacity);a.setId(b.id);break;case markupTypes.Rectangle:a.setX(b.x);a.setY(b.y);a.setWidth(b.width);a.setHeight(b.height);a.setFillColor(b.fillColor);a.setBorderColor(b.borderColor);a.setBorderWeight(b.borderWeight);a.setOpacity(b.opacity);a.setId(b.id);break;case markupTypes.Arrow:a.shapes.SVGLine.setAttributeNS(null,"marker-end","url(#arrowhead-"+b.id+")");appendObjectToDom(a.shapes.group,a.shapes.SVGArrowHead);appendObjectToDom(a.shapes.group,a.shapes.SVGLine);a.setCircMaskCX(b.x2);
a.setCircMaskCY(b.y2);a.setCircMaskRX(12);a.setCircMaskRY(12);case markupTypes.Line:a.setX1(b.x1);a.setY1(b.y1);a.setX2(b.x2);a.setY2(b.y2);a.setFillColor(b.fillColor);a.setBorderWeight(b.borderWeight);a.setOpacity(b.opacity);a.setId(b.id);break;case markupTypes.Text:a.shapes.SVGRectangle.setAttributeNS(null,"style","z-index:-1;position:absolute;");a.setX(b.x);a.setY(b.y);a.setWidth(b.width);a.setHeight(b.height);a.setFillColor(b.fillColor);a.setBorderColor(b.borderColor);a.setBorderWeight(b.borderWeight);a.setOpacity(b.opacity);a.setId(b.id);a.setFontColor(b.fontColor);a.setFontFamily(b.fontFamily);a.setFontSize(b.fontSize);a.setBoldStyle(b.boldStyle);a.setItalicStyle(b.italicStyle);a.setUnderlineStrikeStyle(b.underLineStrikeStyle);a.setHorizontalAlign(b.horizontalAlign);a.setVerticalAlign(b.verticalAlign);if(isIE){var f=null,d=0;switch(b.horizontalAlign){case"left":d=5;f="start";break;case"center":d=parseInt(b.width/2);f="middle";break;case"right":d=parseInt(b.width-5);f="end";break}a.shapes.SVGGWrapper.setAttributeNS(null,"transform","matrix(1 0 0 1 "+b.x+" "+b.y+")");
a.setSVGTextValueX(d);a.setTextAnchor(f)}insertTextValuetoDiv(a,a.getText());break;case markupTypes.RectangleRedaction:a.shapes.group.setAttributeNS(null,"data-isi","redaction-"+(markupId));a.setX(b.x);a.setY(b.y);a.setWidth(b.width);a.setHeight(b.height);a.setFontColor("rgb(255, 255, 255)");a.visibilityMode=visibilityMode.Shown;a.setId(b.id);a.setOpacity(1);if(isIE){}else{a.setFillColor("rgba(0, 0, 0, 1)");a.setText(b.text)}break}if(c!=isIE){isIE=c}}function createMarkupSVGObjects(b){var a={};switch(b){case markupTypes.Text:case markupTypes.RectangleRedaction:if(isIE){}else{}case markupTypes.Rectangle:a.SVGRectangle=createSVGElement("rect");a.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGRectangle.parentNode);return transformed};a.retrieveShapeForCalculation=function(){return this.SVGRectangle};break;case markupTypes.Arrow:a.SVGArrowHead=createSVGElement("marker");case markupTypes.Line:a.SVGLine=createSVGElement("line");a.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGLine.parentNode);
return transformed};break;case markupTypes.Circle:a.SVGEllipse=createSVGElement("ellipse");a.retrieveOriginCoordinates=function(){transformed=getObjectMatrix(this.SVGEllipse.parentNode);return transformed};break}return a}function processAnnotationXMLNode(d,c){var b=d.getAttribute("drawType");var a={};a=createMarkupDrawnObject(d);b=a.markupType;initializePreDrawProcess(a.markupType,a,c.svgMarkupGroup,a.attributes.text);initializeAnnotationObject(a);if(!a.id){a=null}return a}var curPage,curscrollPercentage,scrollHeightPercentage,lastCurScrollPer,DoctotalPages,scrollDiff;function loadDivPages(){var b=$(getElement("viewer-document-wrapper")),a=pageCollection.length,e,d,g,c;if(a>0){for(var f=0;f<a;f++){pageId=pageCollection[f].attributes.id;d=pageCollection[f].attributes.pageWidth,g=pageCollection[f].attributes.pageHeight;c=pageCollection[f].attributes.rotateDegrees;e=$(document.createElement("div"));e.attr("id",pageId);e.addClass("pageContent");if(c==90||c==270){e.css("width",g);e.css("height",d)
}else{e.css("width",d);e.css("height",g)}b.append(e);if(f==0&&b.first()){e.addClass("currentView")}}currentView=$(".currentView")}curPage=$(".current-page").val();getScrollHeightPercentage(pageCollection.length);HScrollBarChecker()}function getScrollHeightPercentage(b){var a=$(getElement("viewerContainer"));DoctotalPages=b;scrollDiff=(a[0].scrollHeight-a[0].clientHeight),scrollHeightPerPage=scrollDiff/b,scrollHeightPercentage=(scrollHeightPerPage/scrollDiff)*100}function currentScrollVal(b,c){var a=b/100;return Math.round(a*c)}function HScrollBarChecker(){var c=$(getElement("viewerContainer")),b=$(getElement("viewer-document-wrapper")),a=$(getElement("page-handtool"));handToolJS=document.getElementById("page-handtool");if(Number(c[0].scrollWidth+10)>c.innerWidth()){handToolJS.setAttributeNS(null,"data-drag","enable");if(a.data("drag")==="unable"){a.trigger("mouseup")}}else{if(a.data("drag")==="unable"){handToolJS.setAttributeNS(null,"data-drag","unable");a.data("drag","unable").removeClass("selected-tool");
b.removeDragScroll()}}}function disableHandTool(){var a=$(getElement("page-handtool"));a.data("drag","unable").removeClass("selected-tool");a.data("laststate",false);viewerWrapper.removeDragScroll()}var $window=$(window);var documentHeight=$(document).height();var windowHeight=$window.height();var scrollTop=$window.scrollTop();var pageNavScroll=false;var zoomScroll=false;var preZoomPageNo;function getCompCurPage(){var b=curscrollPercentage/scrollHeightPercentage;var a=Math.ceil(b);a=(a===0||isNaN(a))?1:a;a=(a>DoctotalPages)?DoctotalPages:a;return a}function scrollFn(){var c=$(getElement("viewerContainer")),b=$(".current-page");transferTextAreaValuetoDiv(lastSelectedDivReason);if(currentView.length<=0){return false}curscrollPercentage=((c.scrollTop()/scrollDiff)*100);if(pageNavScroll){viewerWrapper.children().eq(b.val()-1).addClass("currentView").siblings().removeClass("currentView");pageNavScroll=false}else{if(zoomScroll){zoomScroll=false;var a=getCompCurPage();if(preZoomPageNo!=a){jumpPage(preZoomPageNo)
}else{viewerWrapper.children().eq(a-1).addClass("currentView").siblings().removeClass("currentView");b.val(a)}}else{var a=getCompCurPage();viewerWrapper.children().eq(a-1).addClass("currentView").siblings().removeClass("currentView");b.val(a)}}c.find(".pageContent").each(function(d){var e=$(this);displayViewableSvg(e)});checkNavigation()}function loadSvgOnViewablePage(){var a=$(getElement("viewer-document-wrapper")).children(".pageContent");a.each(function(){var b=$(this);if(isPageViewable(b)){var c=pageCollection[b.index()];loadSVG($(this));c.isPageRequested=true}})}function displayErrorPlaceHolder(){$(".pages").text(1);$(".current-page").val(1);var c=1,a=0;var e=new UDVPage(c,a,erroredPage.height,erroredPage.width,null);e.isErroredPage=true;pageCollection.push(e);var b=$(getElement("viewer-document-wrapper")),d=$(document.createElement("div"));d.addClass("pageContent");d.addClass("currentView");d.css("width",erroredPage.width);d.css("height",erroredPage.height);b.append(d);currentView=$(".currentView");
loadSVG($(d))}function displayReviewTools(b){displayReviewTabs(b);if(b===true){displayVisibilityTools(documentViewer.annotateTab,documentViewer.redactTab)}else{displayVisibilityTools(false,false)}if(documentViewer.isMobile===true){hideDocCompletedTools()}else{hideVisibilityTools(documentViewer.annotateTab,documentViewer.redactTab);displayDocCompletedTools()}var a=$(".downloadDocument");if(b===true){displayTool(a,true);a.attr("data-toggle","modal");a.attr("data-target","#downloadModal")}else{displayTool(a,false);a.removeAttr("data-toggle");a.removeAttr("data-target")}}function displayReviewTabs(b){var e=(b)?"block":"none";var d;var a;reviewTools=$(".review-tab");for(var c=0;c<reviewTools.length;c++){d=reviewTools[c];a=true;if(d.id==="redactTab"&&documentViewer.redactTab===false){a=false}if(d.id==="annotateTab"&&documentViewer.annotateTab===false){a=false}if(a){$(reviewTools[c]).css("display",e)}}}function displayVisibilityTools(b,a){var c=$(".selected-visibility-redaction").children(".visibility-holder-redaction");
var d=$(".selected-visibility-annotation").children(".visibility-holder-annotation");displayTool(c,a);displayTool(d,b)}function hideVisibilityTools(b,a){var c=$(".selected-visibility-redaction").children(".visibility-holder-redaction");var d=$(".selected-visibility-annotation").children(".visibility-holder-annotation");if(a===false){hideTool(c)}if(b===false){hideTool(d)}}function displayVisibilityToolsForAvailableObjects(){var a=hasObjectsOnDocument();displayVisibilityTools(a.hasAnnotations,a.hasRedactions);hideVisibilityTools(a.hasAnnotations,a.hasRedactions)}function displayDocCompletedTools(){if(logFileStatus==="Completed"){displayTool($(".printDocument"),true);displayTool($(".saveDocSettings"),true)}else{displayTool($(".printDocument"),false);displayTool($(".saveDocSettings"),false)}}function hideDocCompletedTools(a,b){$(".printDocument").hide();$(".saveDocSettings").hide()}function displayTool(a,b){if(b){a.addClass("enable-tool");a.removeClass("disable-tool")}else{a.addClass("disable-tool");
a.removeClass("enable-tool")}}function hideTool(a){a.hide()}function checkNavigation(){var c=parseInt($(".pages").text()),e=parseInt($(".current-page").val()),b=$("#firstPage > i,#prevPage > i"),d=$("#firstPage, #prevPage"),f=$("#lastPage > i, #nextPage > i"),a=$("#lastPage, #nextPage");if(e<=1){b.css({opacity:"0.5"});d.css({cursor:"default"}).data("enable",false)}else{b.css({opacity:"1"});d.css({cursor:"pointer"}).data("enable",true)}if(e>=c){f.css({opacity:"0.5"});a.css({cursor:"default"}).data("enable",false)}else{f.css({opacity:"1"});a.css({cursor:"pointer"}).data("enable",true)}}var saveDoc=$(".saveDocSettings");saveDoc.on("click",function(){isSaved=true;saveWithCallback();var a=getEditedElements();burnAnnotation(a);burnRedactionAnnotation(a)});function save(a){if(saveDoc.hasClass("disable-tool")){return}transferTextAreaValuetoDiv(lastSelectedDivReason);saveDocumentSettings(a);showAlert("Annotations, redactions and rotations are saved.","accept");setTimeout(function(){var b=$("#DV-Notif");
b.animate({top:"-85px",opacity:0},600)},3000)}function saveNoCallback(){save(false)}function saveWithCallback(){save(true)}function saveDocumentSettings(b){var a=getStoredMarkup();sendXMLToServer(a.markup,a.hasRedactions,b)}function getStoredMarkup(){var o=pageCollection.length;var l=false;var d=false;var a="<documentAnnotations><pages>";for(var h=0;h<o;h++){var c=pageCollection[h];if(!l){l=c.hasRedactions()}if(!d){d=c.isRotationAdjusted()}if(c.hasDrawnObject()||c.isRotationAdjusted()){a+=parseXML("page",c.attributes);var f=c.markups.length;var m=c.markups;if(c.hasDrawnObject()){for(var q=0;q<f;q++){m[q].attributes.layerIndex=$(m[q].shapes.group).index()}for(var j=0;j<f;j++){var n=c.retrieveLayeredMarkObjectInPage(j);a+=parseXML("annotation",n);if(n.attributes.type===markupTypes.Text){var k=n.attributes.text;var e=k.length;for(var b=0;b<e;b++){a+="<text>"+k[b]+"</text>"}}a+="</annotation>"}}a+="</page>"}}a+="</pages></documentAnnotations>";var g={markup:a,hasRedactions:l,hasRotation:d};
return g}function getMarkup(){return getStoredMarkup().markup}function parseXML(a,c){var h="<"+a;var d=c;var e={};var b={};if(a=="annotation"){e=c.shapes.retrieveOriginCoordinates();d=c.attributes}else{if(a==="page"){if(documentViewer.excludeRotation){b.rotateDegrees=parseInt(d.rotateDegrees);b.rotateX=parseInt(d.rotateX);b.rotateY=parseInt(d.rotateY);d.rotateDegrees=0;d.rotateX=d.pageHeight/2;d.rotateY=d.pageHeight/2}}}for(var f in d){if(d.hasOwnProperty(f)){if(d.type==markupTypes.RectangleRedaction&&f==="text"){h+=" "+f+'="'+d[f][0]+'"'}else{if(f!="text"||(f!="pageHeight"||f!="pageWidth")){var g=d[f];if(d.type===markupTypes.Line||d.type===markupTypes.Arrow){if(f==="x1"||f==="x2"||f==="y1"||f==="y2"){g=parseFloat(g);switch(f){case"x1":case"x2":g+=parseFloat(e.x);break;case"y1":case"y2":g+=parseFloat(e.y);break}}}else{if(d.type===markupTypes.Circle){if(f==="cx"||f==="cy"){g=parseFloat(g);switch(f){case"cx":g+=parseFloat(e.x);break;case"cy":g+=parseFloat(e.y);break}}}else{if(d.type!=markupTypes.Circle){if(f==="x"||f==="y"){g=parseFloat(g);
switch(f){case"x":g+=parseFloat(e.x);break;case"y":g+=parseFloat(e.y);break}}}}}h+=" "+f+'="'+g+'"'}}}}h+=">";if(documentViewer.excludeRotation){d.rotateDegrees=b.rotateDegrees;d.rotateX=b.rotateX;d.rotateY=b.rotateY}return h}function sendXMLToServer(a,c,d){var b=new XMLHttpRequest();if(d&&documentViewer.saveCallback){documentViewer.saveCallback(a)}b.open("POST",documentViewer.domain+"/DocViewerWS/rest/convert/save?path="+documentViewer.markupPath,true);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.onreadystatechange=function(){if(c&&b.readyState==4&&b.status==200){burnRedactedFile();return}else{if(documentViewer.postRedactGeneration){documentViewer.postRedactGeneration(documentViewer.documentAbsPath,false)}}if(b.readyState!==4){return}if(b.status!==200&&b.status!==304){return}};b.send(a)}function burnRedactedFile(){var a=new XMLHttpRequest();a.open("POST",documentViewer.domain+"/DocViewerWS/rest/convert/burnredactedfile?nativeFilePath="+documentViewer.documentAbsPath+"&markupPath="+documentViewer.markupPath,true);
a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.onreadystatechange=function(){if(a.readyState!==4){return}checkRedactedFilePostBurn(1);if(a.status!==200&&a.status!==304){return}};a.send()}var processingAnnotation;function burnAnnotation(a){var b=processAnnotations(a);$.ajax({method:"POST",url:documentViewer.domain+"/DocViewerWS/rest/document/processAnnotatedPDF",contentType:"application/json",data:JSON.stringify(b),beforeSend:function(){processingAnnotation=true},success:function(c){processingAnnotation=false}})}var processingRedactionAnnotation;function burnRedactionAnnotation(a){var b=processRedactionAnnotation(a);$.ajax({method:"POST",url:documentViewer.domain+"/DocViewerWS/rest/document/processRedactedAnnotatedPDF",contentType:"application/json",data:JSON.stringify(b),beforeSend:function(){processingRedactionAnnotation=true},success:function(c){processingRedactionAnnotation=false}})}function processAnnotations(b){var a={path:documentViewer.documentAbsPath,markup:documentViewer.markupPath,docPages:b.pagesAnnotation,isAnnotated:b.isEdited};
return a}function processRedactionAnnotation(b){var a={path:documentViewer.documentAbsPath,markup:documentViewer.markupPath,docPages:b.pagesAll,isEdited:b.isEdited};return a}function getEditedElements(){var l=false;var c=[],o=[];var a=pageCollection;var t=pageCollection.length;for(var v=0;v<t;v++){var p=a[v];var f=p.svgMarkupGroup;var q=[],g=[];if(f!=null){var u=f.childNodes,e=u.length;for(var s=0;s<e;s++){var k=u[s];var d=$(k).attr("data-isi");var b=removeCircleArrowHead(k);l=true;var j;if(k.childNodes.length>=2&&k.firstChild.tagName==="rect"){var m=parseInt(d.substring(d.indexOf("-")+1,d.length));isWithin=true;var n=createMarkupObject(p.retrieveMarkObjectInPage(m),v+1,true);j=getIEEquivalentHTML(n,f,p.attributes.rotateDegrees);isWithin=false}else{j=k.outerHTML}if(d.match("^annotation")){g.push(j)}q.push(j);if(b!=undefined){k.insertBefore(b,k.firstChild);var h=$(k).children()[1];h.removeAttribute("style")}}c.push({pageIndex:v,elements:g});o.push({pageIndex:v,elements:q})}}var r={isEdited:l,pagesAnnotation:c,pagesAll:o};
return r}function getIEEquivalentHTML(j,m,b){isWithin=true;var c=j.shapes,d=c.group,k=c.SVGRectangle,i=c.SVGGWrapper,h="";isWithin=false;appendObjectToDom(m,d);j.rotateTextObject(b,true);var f=k.getAttributeNS(null,"fill");f="rgb"+f.substring(4,f.lastIndexOf(","))+")";k.setAttributeNS(null,"fill",f);if(j.markupType===markupTypes.RectangleRedaction){f=c.SVGText.getAttributeNS(null,"style").substring(5);f="rgb"+f.substring(4,f.lastIndexOf(","))+")";c.SVGText.setAttributeNS(null,"style","fill:"+f)}var g=c.SVGText.childNodes;var n=g.length;var a=c.SVGText.getAttributeNS(null,"style");for(var l=0;l<n;l++){g[l].setAttributeNS(null,"style",a)}var e=i.getAttributeNS(null,"clip-path");i.setAttributeNS(null,"clip-path","");c.SVGText.setAttributeNS(null,"clip-path",e);h=d.outerHTML;m.removeChild(d);return h}function removeCircleArrowHead(e){if($(e).children().length>2&&$(e).has("marker[id^='arrowhead']")){var f=e.firstChild;e.removeChild(f);var d=$(e).children();var b=d[0];var a=d[1];var c=$(a).attr("style");
$(b).attr("style",c);return f}}function getMatrixValue(e,a){if(e&&e.hasAttribute("transform")){var b=e.getAttribute("transform");if(b&&b.length>0){var c=b.slice(7,-1);if(isIE){var d=c.split(" ");return parseFloat(d[a])}else{var d=c.split(",");return parseFloat(d[a])}}else{return 0}}else{return 0}}var downloadTimeoutCollection=[];var isAnnotated;var isRedactedAnnotated;var zz=function(){var b=$("#showDownloadModal");var a=$("#dlRedactCheckBox");var e=$("#dlAnnotationCheckBox");var d=$("#downloadBtn");a.prop("disabled",true);a.prop("checked",false);e.prop("disabled",true);e.prop("checked",false);try{window.setTimeout(function(){if(isSaved===true){var f=docHasAnnotation();var g=docHasRedaction();if(f&&g){if($("#dlRedactCheckBox").is(":disabled")||$("#dlAnnotationCheckBox").is(":disabled")){$("#downloadNote").fadeIn("fast")}}else{if(!f&&g){if($("#dlRedactCheckBox").is(":disabled")){$("#downloadNote").fadeIn("fast")}}else{if(f&&!g){if($("#dlAnnotationCheckBox").is(":disabled")){$("#downloadNote").fadeIn("fast")
}}}}}},5000);checkRedactedFileForDownload(1);hasRedactionAnnotationFile();hasAnnotationFile()}catch(c){console.log(c)}b.on("click",function(){$("#closeRedact").click();$("#closeAnnotateBox").click()});d.on("click",function(){if($("#dlRedactCheckBox").is(":checked")&&$("#dlAnnotationCheckBox").is(":checked")){var f=documentViewer.domain+"/DocViewerWS/rest/document/getRedactedAnnotatedPDF?markupPath="+documentViewer.markupPath;window.location=f;$("#cancelDownloadBtn").click()}else{if(!$("#dlRedactCheckBox").is(":checked")&&!$("#dlAnnotationCheckBox").is(":checked")){var f="";if(!getStoredMarkup().hasRotation){f=documentViewer.domain+"/DocViewerWS/rest/document/originalFile?nativeFilePath="+documentViewer.documentAbsPath}else{f=documentViewer.domain+"/DocViewerWS/rest/document/rotateFile?nativeFilePath="+documentViewer.documentAbsPath+"&markupPath="+documentViewer.markupPath}window.location=f;$("#cancelDownloadBtn").click()}else{if($("#dlRedactCheckBox").is(":checked")){if($("#dlRedactCheckBox").is(":checked")){var f=documentViewer.domain+"/DocViewerWS/rest/document/redactedFile?markupPath="+documentViewer.markupPath+breakCacheParameter();
window.location=f}$("#cancelDownloadBtn").click()}else{if($("#dlAnnotationCheckBox").is(":checked")){var f=documentViewer.domain+"/DocViewerWS/rest/document/getAnnotatedPDF?markupPath="+documentViewer.markupPath;window.location=f;$("#cancelDownloadBtn").click()}}}}clearDownloadTimer()});$("#cancelDownloadBtn").on("click",function(){$("#downloadNote").hide();clearDownloadTimer()})};function checkRedactedFileForDownload(b){if(!b){b=1}var a=function(){checkRedactedFileForDownload(b+1)};var c=new XMLHttpRequest();c.open("GET",documentViewer.domain+"/DocViewerWS/rest/document/redactedFileExists?markupPath="+documentViewer.markupPath+breakCacheParameter(),true);c.send();c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var d=c.responseText;if(d==="true"){hasRedactedFile=true;$("#dlRedactCheckBox").prop("disabled",false);$("#dlRedactCheckBox").prop("checked",true);$("#downloadNote").fadeOut("fast")}else{if(b<50){executeDownloadTimer(a,100)}}}}}function executeDownloadTimer(b,a){downloadTimeoutCollection.push(setTimeout(b,a))
}function clearDownloadTimer(){var a=downloadTimeoutCollection.length;for(var b=0;b<a;b++){clearTimeout(downloadTimeoutCollection[b])}}$(".downloadDocument")[0].addEventListener("mouseup",zz);function hasAnnotationFile(){if(processingAnnotation==true){$("#dlAnnotationCheckBox").prop("disabled",true);isAnnotated=false;return}$.ajax({url:documentViewer.domain+"/DocViewerWS/rest/document/annotatedFileExists?markupPath="+documentViewer.markupPath,contentType:"text/plain",cache:false,success:function(b){var a=b;if(a=="true"){$("#dlAnnotationCheckBox").prop("disabled",false);$("#downloadNote").fadeOut("fast");isAnnotated=true}else{$("#dlAnnotationCheckBox").prop("disabled",true);isAnnotated=false}}})}function hasRedactionAnnotationFile(){if(processingRedactionAnnotation==true){isRedactedAnnotated=false;return}$.ajax({url:documentViewer.domain+"/DocViewerWS/rest/document/redactedAnnotatedFileExists?markupPath="+documentViewer.markupPath,contentType:"text/plain",cache:false,success:function(a){var b=a;
if(b=="true"){isRedactedAnnotated=true}else{isRedactedAnnotated=false}}})}function docHasAnnotation(){for(var a=0;a<pageCollection.length;a++){if(pageCollection[a].hasAnnotations()){return true}}return false}function docHasRedaction(){for(var a=0;a<pageCollection.length;a++){if(pageCollection[a].hasRedactions()){return true}}return false}(function(a){a.fn.drags=function(c){c=a.extend({handle:"",cursor:"move"},c);if(c.handle===""){var b=this}else{var b=this.find(c.handle)}return b.css("cursor",c.cursor).on("mousedown",function(k){if(c.handle===""){var d=a(this).addClass("draggable")}else{var d=a(this).addClass("active-handle").parent().addClass("draggable")}var i=d.css("z-index"),j=d.outerHeight(),h=d.outerWidth(),f=d.offset().top+j-k.pageY,g=d.offset().left+h-k.pageX;d.css("z-index",1000).parents().on("mousemove",function(l){a(".draggable").offset({top:l.pageY+f-j,left:l.pageX+g-h}).on("mouseup",function(){a(this).removeClass("draggable").css("z-index",i)})});k.preventDefault()}).on("mouseup",function(){if(c.handle===""){var d=a(this);
d.removeClass("draggable");d.css({right:(a(window).width()-(d.offset().left+d.outerWidth())),left:""})}else{a(this).removeClass("active-handle").parent().removeClass("draggable")}})}})(jQuery);function Dropdown(b,a){this.select=$(b);this.container=this.select.children(a);this.init()}Dropdown.prototype={init:function(){var a=this;a.select.on("click",function(b){a.container.toggleClass("active");return false})}};var temp=[];$(document).ready(function(){$("#showRedactModal").on("click",function(){$("#closeRedact").click();$("#closeAnnotateBox").click()});$("#redactionBtn").on("click",function(){if($("#pagesId").val().length==0){$("#page-note").text("Please Enter pages.");$("#page-note").fadeIn("fast")}else{var a=getPageRange(temp[0]);if(a!==null){$("#cancelfpRedactionBtn").click();createFullPageRedact(a,$("#selectReason").find(":selected").text())}else{$("#page-note").text("Invalid Page range.");$("#page-note").fadeIn("fast")}}});$("#pagesId").focus(function(){$("#page-note").fadeOut("fast")
});$("#pagesId").focusout(function(){temp[0]=$("#pagesId").val();var b=$("#pagesId").val().length;if(b>=30){$("#pagesId").val($("#pagesId").val().substr(0,30)+"...")}});$("#pagesId").focusin(function(){$("#pagesId").val(temp[0])});$("#pagesId").keypress(function(b){var a=new RegExp("^[0-9,\b-]+$");var c=String.fromCharCode(!b.charCode?b.which:b.charCode);if(a.test(c)){return true}b.preventDefault();return false});$("#cancelfpRedactionBtn").on("click",function(){$("#pagesId").val("");$("#page-note").hide();temp[0]=""})});function getPageRange(a){var j=[];var e=a.split(",");var f=e.length;var c,h,g,b,d;for(c=0;c<f;c++){h=e[c];if(+h>pageCollection.length||0>=+h){return null}if(!~h.indexOf("-")){j.push(+h)}else{if(h.split("-").length!=2){return null}d=h.split("-");g=+d[0];b=+d[1];if(b<g){return null}else{while(g<=b){j.push(g++)}}}}return j}Dropdown_Opacity=new Dropdown(".lineopacityPicker",".opacity-available-container"),colorPickerBox=$(".linecolorPickerBox"),opacityPicker=$(".lineopacityPicker"),WidthPicker=$(".lineWidthPicker"),availableColors=$(".availableColors"),close=$("#closeLine"),resizer=$("#resizeLineAnnotate"),controls=$(".LineControls"),contents=$(".LineControls-contents"),container=$("#viewer-lineAnnotate"),lineDelete=$("#line_delete"),style=$("#LineStyle"),index=$("#Line_index"),styleTab=$(".lineAnnotateStyle"),indexTab=$(".linelayering-controls"),lineBringFront=$(".lineBringFront"),lineBringBack=$(".lineBringBack"),lineMoveFront=$(".lineMoveFront"),lineMoveBack=$(".lineMoveBack");
$(document).on("click",function(){opacityPicker.children(".opacity-available-container").removeClass("active");WidthPicker.children(".width-available-container").removeClass("active");colorPickerBox.children(".availableColors").removeClass("active")});opacityPicker.on("click",function(){WidthPicker.children(".width-available-container").removeClass("active");colorPickerBox.children(".availableColors").removeClass("active")});WidthPicker.on("click",function(){opacityPicker.children(".opacity-available-container").removeClass("active");colorPickerBox.children(".availableColors").removeClass("active")});colorPickerBox.on("click",function(){var a=$(this);a.children(".availableColors").addClass("active");opacityPicker.children(".opacity-available-container").removeClass("active");WidthPicker.children(".width-available-container").removeClass("active");return false});$(".opacity-holder").on({click:function(){var b=$(this),a=b.text();b.parent().siblings(".selectedLineOpacity").children("span").text(a);
if($("#viewer-lineAnnotate").css("display")==="block"){setOpacity(getSingleSelectedObject(0),"line_fillOpacity")}}});$(".width-holder").on({click:function(){var b=$(this),a=b.text();b.parent().siblings(".selectedLineWidth").children("span").text(a);if($("#viewer-lineAnnotate").css("display")==="block"){setWidth(getSingleSelectedObject(0),"line_fillWidth")}}});availableColors.on("click","div",function(a){$(this).parent().removeClass("active");$(this).parent(".availableColors").siblings(".selectedColor").attr("style",$(this).attr("style"));if($("#viewer-lineAnnotate").css("display")==="block"){if($("#LineStyle").hasClass("selected")){setAttributeColor("stroke",getSingleSelectedObject(0),"line_fillColor")}}return false});resizer.on("click",function(){var a=$(this);if(a.data("resize")=="minimize"){controls.css("display","none");contents.css("display","none");lineDelete.css("display","none");container.animate({width:"35px"},500,function(){a.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize")
})}else{if(a.data("resize")=="maximize"){container.animate({width:"284px"},500,function(){controls.css("display","block");contents.css("display","block");lineDelete.css("display","block");a.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")})}}});style.on({mousedown:function(){var a=$(this);a.siblings("img").removeClass("selected").end().addClass("selected");styleTab.css("display","block");indexTab.css("display","none")}});index.on({mousedown:function(){var a=$(this);a.siblings("img").removeClass("selected").end().addClass("selected");styleTab.css("display","none");indexTab.css("display","block")}});close.on("click",function(){if(!container.is(":animated")){if(resizer.data("resize")=="maximize"){container.css({width:"284px"});resizer.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")}lineDelete.css("display","block");controls.css("display","block");contents.css("display","block");container.css("display","none");
removeActivate()}});function removeActivate(){var b=$("#viewer-document-wrapper"),a=b.children(".pageContent");$("#addLine").data("active",false).removeClass("selected-tool");a.removeClass("cursorCrosshair")}lineDelete.on({mouseup:function(){deleteSingleMarkup();removeSingleMarkupInArray();clearAllHandles()}});lineBringFront.on("click",function(){var a=getSelectedObjectGroup();if(a){layerAnnotationObject(a,layerOptions.Top)}});lineBringBack.on("click",function(){var a=getSelectedObjectGroup();if(a){layerAnnotationObject(a,layerOptions.Bottom)}});lineMoveFront.on("click",function(){var a=getSelectedObjectGroup();if(a){layerAnnotationObject(a,layerOptions.Forward)}});lineMoveBack.on("click",function(){var a=getSelectedObjectGroup();if(a){layerAnnotationObject(a,layerOptions.Backward)}});UDViewer=function(w){var ax=this,aE,av=$(getElement("viewerContainer")),ap=$(getElement("viewer-document-wrapper")),am=ap.outerHeight(),U=ap.children("div"),V=$(".pages","#viewer-menu"),J=V.siblings(".current-page"),aq=$(getElement("wrapper")),aX,k=true,Y=aq.find("#viewer-redactbox"),s=aq.find("#viewer-annotateBox"),x=$(getElement("viewer-arrowAnnotate")),C=$(getElement("viewer-lineAnnotate")),I=$(getElement("viewer-squareAnnotate")),l=$(getElement("viewer-circleAnnotate")),au=$(getElement("viewer-textAnnotate")),m=$(getElement("viewer-searchbox")),Z=$(".page-nav-container"),aW=$(getElement("deleteMultiple")),G=$(getElement("showSearchMenu")),b=$(getElement("addRedact")),W=$(getElement("addArrow")),ay=$(getElement("addLine")),a3=$(getElement("addSquare")),aI=$(getElement("addCircle")),M=$(getElement("addText")),ag=$(getElement("page-handtool")),B=document.getElementById("page-handtool"),ae=$(".tabContent"),e=$(".annotateBoxTab"),a7=$(getElement("arrowTab")),n=$(getElement("lineTab")),aR=$(getElement("rectTab")),aw=$(getElement("rectBorderTab")),aP=$(getElement("circleTab")),aV=$(getElement("circleBorderTab")),ac=$(getElement("textTab")),ar=$(getElement("textstyleTab")),Q=$(getElement("textAlignTab")),aT=$(getElement("verticalAlignTab")),a=$(getElement("layerTab")),j=$(getElement("fillOpacity")),p=$(getElement("fillWidth")),L=$(getElement("fillColor")),an=$(getElement("leftAlign")),aZ=$(getElement("centerAlign")),o=$(getElement("rightAlign")),aA=$(getElement("topAlign")),X=$(getElement("middleAlign")),q=$(getElement("bottomAlign")),E=$(".reasons-available-container"),t=$(".colorPickerBox"),v=$(".opacityPickerBox"),aH=$(".widthPickerBox"),af=$(".fontFacePickerBox"),aj=$(".textSizePickerBox"),A=$(".textStyleContainer"),i=$(".textAlignContainer"),h=$(".verticalAlignContainer"),az=$(".layerContainer"),a1=$(getElement("availableColors")),a4=$(getElement("availableOpacity")),aO=$(getElement("availableWidth")),aN=$(getElement("availableFonts")),a0=$(getElement("availableSize")),ak=$(".deleteObject"),T=$(getElement("closeAnnotateBox")),aM=$(getElement("resizeAnnotateBox")),aU=$(getElement("boldText")),ad=$(getElement("italicText")),at=$(getElement("underlineText")),ao=$(getElement("strikeoutText")),aG=$(getElement("leftAlign")),al=$(getElement("rightAlign")),z=$(getElement("topAlign")),aD=$(getElement("middleAlign")),g=$(getElement("bottomAlign")),aa=$(getElement("blocker")),H=$(getElement("DV-PrintModal")),ai=$(getElement("PreloaderModal")),aY=document;
window.html5.shivMethods=false;documentViewer=this;this.printTemplateStr="";this.markupPath=w.markupPath;this.domain=w.domain;this.allowRotation=w.allowRotation;this.rotationMarkupPath=w.rotationMarkupPath;this.saveCallBack=null;this.autoGeneration=true;this.excludeRotation=w.excludeRotation;this.redactTab=w.redactTab;this.annotateTab=w.annotateTab;this.isMobile=w.isMobile;if(w.highlightColor!=undefined&&w.highlightColor!=null){defaultHighlightColor=w.highlightColor}defaultActiveHighlightColor=shadeBlendConvert(-0.2,defaultHighlightColor);if(this.isMobile===true){this.redactTab=false;this.annotateTab=false}if(w.autoGeneration!=undefined){this.autoGeneration=w.autoGeneration}if(!w.timezone){w.timezone=0}$(window.parent).keydown(aK);$(document).keydown(aK);$(getElement("annotationInfiniteBtn")).on("click",function(){$(this).toggleClass("active-state");var a9=$("#annotationInfiniteBtn").hasClass("active-state");aJ[annotationObject].continuous=a9});$(getElement("redactionInfiniteBtn")).on("click",function(){$(this).toggleClass("active-state");
var a9=$("#redactionInfiniteBtn").hasClass("active-state");aJ[annotationObject].continuous=a9});var aF=false;$(getElement("clearSearchBox")).mouseup(function(a9){clearSearch()});$(getElement("searchBox")).keydown(function(be){function a9(){var bf=$(".search-btns > li > span",'#"searchOptions"');return bf}var bc=be.keyCode;if(bc===16){aF=true}if(bc===13){if(this.value===""&&this.value===undefined){console.log("Query is empty. Try again.")}else{if(this.value.length<3){console.log("Query is too short")}else{if(lastQuery===this.value){if(aF){D()}else{aB()}}else{highlightWalkerCollection=[];document.getElementById("walker").innerHTML=1;var bb=document.getElementById("caseSensitive").firstChild.classList.contains("selected-visibility");var ba=document.getElementById("exactWord").firstChild.classList.contains("selected-visibility");lastQuery=this.value;var bd="";if(bb){bd+=":"}if(ba){bd+="="}bd+="*"+this.value+"*";search(bd)}}}}});$("#searchBtn").on("click",function(){highlightWalkerCollection=[];
document.getElementById("walker").innerHTML=1;var ba=document.getElementById("caseSensitive").firstChild.classList.contains("selected-visibility");var a9=document.getElementById("exactWord").firstChild.classList.contains("selected-visibility");lastQuery=this.value;var bb="";if(ba){bb+=":"}if(a9){bb+="="}bb+=$("#searchBox").val();search(bb)});$(getElement("searchBox")).keyup(function(ba){var a9=ba.keyCode;if(a9===16){aF=false}});this.timezone=w.timezone;this.annotationToolBox=[];var aJ=this.annotationToolBox;a8();F(w.redactionReason);loadDocument(w.doc,this.markupPath,undefined,undefined,this.rotationMarkupPath);function a8(){for(var a9 in markupTypes){var ba=markupTypes[a9];switch(ba){case markupTypes.RectangleRedaction:aJ.push(new RedactionRectangleToolBox());break;case markupTypes.Rectangle:aJ.push(new RectangleToolBox());break;case markupTypes.Arrow:aJ.push(new ArrowToolBox());break;case markupTypes.Line:aJ.push(new LineToolBox());break;case markupTypes.Circle:aJ.push(new CircleToolBox());
break;case markupTypes.Text:aJ.push(new TextAnnotationToolBox());break}}}this.setCurrentSelectedMarkup=function P(a9){aE=a9};function a6(bb){var a9=document.getElementById("selectReason");var ba=document.createElement("option");ba.value=bb;ba.innerHTML=bb;a9.appendChild(ba);var bc=document.createElement("div");bc.className="reasons-holder";bc.innerHTML=bb;var bb=$(bc);bb.on({click:selectRedactionReason});bb.on({mouseenter:hoverRedactionReason,mouseleave:outRedactionReason});E.append(bb)}function aK(ba){var a9=ba.keyCode;if(a9===46){if(s.css("display")==="block"){ak.mouseup()}else{if(Y.css("display")==="block"){$(getElement("Redact_delete")).mouseup()}else{$(getElement("multiple_delete")).mouseup()}}}}function F(ba){ba=""+ba;ba=ba.split(",");var bb=new XMLHttpRequest();if(ba){$(".selected-reason").children("span").text(ba[0]);aJ[markupTypes.RectangleRedaction].reason=ba[0];for(var a9=0;a9<ba.length;a9++){a6(ba[a9])}}else{a6("Redaction")}}$(".tab-menu").on("click","li",function(){transferTextAreaValuetoDiv(lastSelectedDivReason);
var a9=$(this);a9.addClass("tab-active").siblings("li").removeClass("tab-active");switch(a9.data("name")){case"page":$(".under-page").show().siblings().hide();break;case"search":$(".under-search").show().siblings().hide();break;case"annotate":$(".under-annotate").show().siblings().hide();break;case"redact":$(".under-redact").show().siblings().hide();break}$(".tab-menu li").on("click",function(){$("#annotationInfiniteBtn").removeClass("active-state");$("#redactionInfiniteBtn").removeClass("active-state")});if(a9.data("name")!="search"){m.removeAttr("style");m.css({display:"none"});G.data("active",false).removeClass("selected-tool")}});ag.on({mouseup:function(){transferTextAreaValuetoDiv(lastSelectedDivReason);var a9=$(this);if(a9.data("drag")=="unable"){U.removeClass("cursorCrosshair");a9.data("drag","enable").addClass("selected-tool");a9.data("laststate",true);ap.dragScroll();a9.removeAttr("style");document.removeEventListener("mousedown",initStartPosition,false)}else{if(a9.data("drag")=="enable"){a9.data("drag","unable").removeClass("selected-tool");
a9.data("laststate",false);ap.removeDragScroll()}}if(!selectedObjectCollection.length){T.trigger("click");$(getElement("closeRedact")).trigger("click")}}});b.on({mouseup:function(){r(markupTypes.RectangleRedaction,Y,$(this))}});W.on({mouseup:function(){r(markupTypes.Arrow,s,$(this))}});ay.on({mouseup:function(){r(markupTypes.Line,s,$(this))}});a3.on({mouseup:function(){r(markupTypes.Rectangle,s,$(this))}});aI.on({mouseup:function(){r(markupTypes.Circle,s,$(this))}});M.on({mouseup:function(){r(markupTypes.Text,s,$(this))}});function r(bb,ba,bc){annotationObject=bb;aL(bc,ba);selectedObjectCollection=[];clearAllHandles();var a9=aJ[bb];aE=bb;switch(bb){case markupTypes.RectangleRedaction:$(getElement("Redact_fill")).siblings("img").removeClass("selected").end().addClass("selected");$("#Redact_index").css("display","none ");$(".reason-container").css("display","block");$(".layering-controls").css("display","none");a9.continuous?$("#redactionInfiniteBtn").addClass("active-state"):$("#redactionInfiniteBtn").removeClass("active-state");
break;case markupTypes.Rectangle:j.html(a9.opacityLevel);p.html(a9.borderWeight);L.css("background-color",a9.fillColor);a9.continuous?$("#annotationInfiniteBtn").addClass("active-state"):$("#annotationInfiniteBtn").removeClass("active-state");break;case markupTypes.Arrow:p.html(a9.borderWeight);j.html(a9.opacityLevel);L.css("background-color",a9.fillColor);a9.continuous?$("#annotationInfiniteBtn").addClass("active-state"):$("#annotationInfiniteBtn").removeClass("active-state");break;case markupTypes.Line:p.html(a9.borderWeight);j.html(a9.opacityLevel);L.css("background-color",a9.fillColor);a9.continuous?$("#annotationInfiniteBtn").addClass("active-state"):$("#annotationInfiniteBtn").removeClass("active-state");break;case markupTypes.Circle:j.html(a9.opacityLevel);p.html(a9.borderWeight);L.css("background-color",a9.fillColor);a9.continuous?$("#annotationInfiniteBtn").addClass("active-state"):$("#annotationInfiniteBtn").removeClass("active-state");break;case markupTypes.Text:j.html(a9.opacityLevel);
p.html(a9.borderWeight);L.css("background-color",a9.fillColor);a9.continuous?$("#annotationInfiniteBtn").addClass("active-state"):$("#annotationInfiniteBtn").removeClass("active-state");clearTextStyleTab();clearHorizontalAlignTab();clearVerticalAlignTab();if(a9.boldStyle){aU.addClass("selected")}if(a9.italicStyle){ad.addClass("selected")}if(a9.underlineStyle){at.addClass("selected")}if(a9.strikeStyle){ao.addClass("selected")}switch(a9.horizontalAlign){case"center":aZ.addClass("selected");break;case"left":aG.addClass("selected");break;case"right":al.addClass("selected");break}switch(a9.verticalAlign){case"top":z.addClass("selected");break;case"middle":aD.addClass("selected");break;case"bottom":g.addClass("selected");break}}}function aL(ba,a9){if(ba.data("active")==false){var bb=ba.data("annotate");if($(M).hasClass("selected-tool")&&bb!=markupTypes.Text){u(M,a9);document.removeEventListener("mousedown",initStartPosition,false)}aC();addAnnotationDraw();ag.data("drag","unable").removeClass("selected-tool");
ap.removeDragScroll();a9.siblings().css("display","none").end().css("display","block");ba.data("active",true).addClass("selected-tool");ap.addClass("cursorCrosshair");e.children("img").css("display","none").removeClass("selected").removeClass("standBy");switch(bb){case markupTypes.Arrow:a7.siblings().removeClass("standBy selected").end().addClass("standBy selected");a7.trigger("click");a1.children("#nofillColor").css({display:"none",cursor:"default"}).removeClass("nofillColor");a1.children("#nofillColor").removeClass("nofillColor");break;case markupTypes.Line:n.siblings().removeClass("standBy selected").end().addClass("standBy selected");n.trigger("click");a1.children("#nofillColor").css({display:"none",cursor:"default"}).removeClass("nofillColor");a1.children("#nofillColor").removeClass("nofillColor");break;case markupTypes.Rectangle:aR.siblings().removeClass("standBy selected").end().addClass("standBy selected");aw.addClass("standBy");aR.trigger("click");a1.children("#nofillColor").css({display:"block",cursor:"pointer"});
a1.children("#nofillColor").addClass("nofillColor");break;case markupTypes.Circle:aP.siblings().removeClass("standBy selected").end().addClass("standBy selected");aV.addClass("standBy");aP.trigger("click");a1.children("#nofillColor").css({display:"block",cursor:"pointer"});a1.children("#nofillColor").addClass("nofillColor");break;case markupTypes.Text:aR.siblings().removeClass("standBy selected").end().addClass("standBy selected");aw.addClass("standBy");ac.addClass("standBy");ar.addClass("standBy");Q.addClass("standBy");aT.addClass("standBy");aR.trigger("click");a1.children("#nofillColor").css({display:"block",cursor:"pointer"});a1.children("#nofillColor").addClass("nofillColor");break}}else{if(ba.data("active")==true){u(ba,a9)}}}function u(ba,a9){deactivateAnnotationDraw();ba.data("active",false).removeClass("selected-tool");ap.removeClass("cursorCrosshair");a9.css("display","none");setMouseStyle()}ap.on("click",function(){R()});function K(bk,bd){var bh,bi,bm,bl,bp,ba,bf,bc=false,a9=false,bb=false,be=false;
var bn=(bk===markupTypes.Text&&(bd!="fill"&&bd!="border"))?getSingleSelectedTextObject():getSingleSelectedObject(0);var bg=getSingleSelectedMarkupObject(0);var bj=aJ[bk];switch(bd){case"fill":if(bn){switch(bk){case markupTypes.Line:case markupTypes.Arrow:bh=bn.getAttribute("stroke");bm=bn.getAttribute("stroke-width");break;default:bh=bn.getAttribute("fill");break}bi=(bg.attributes.opacity)}else{bh=bj.fillColor;bi=bj.opacityLevel;bi=parseInt(bi.substring(0,bi.indexOf("%")))/100;bm=bj.borderWeight}break;case"border":if(bn){bh=bn.getAttribute("stroke");bm=bn.getAttribute("stroke-width")}else{bh=bj.borderColor;bm=bj.borderWeight}break;case"text":if(bn){if(isIE){bh=getRGBvalue(getComputedStyle(bn,null).getPropertyValue("fill"))}else{if(isFirefox){bh=getRGBvalue(bn.style.color)}else{bh=getRGBvalue(getComputedStyle(bn,null).getPropertyValue("color"))}}bl=getComputedStyle(bn,null).getPropertyValue("font-family");bl=bl.replace("'","");bp=getComputedStyle(bn,null).getPropertyValue("font-size");bp=bp.replace("px","")
}else{bh=bj.fontColor;bl=bj.fontFamily.replace("'","");bp=bj.fontSize.replace("px","")}break;case"textStyle":clearTextStyleTab();if(bn){bc=bn.style.fontWeight!="normal";a9=bn.style.fontStyle!="normal";var bo=getComputedStyle(bn,null).getPropertyValue("text-decoration");if(bo=="underline"){bb=true}else{if(bo=="line-through"){be=true}else{if(bo=="underline line-through"){bb=true;be=true}}}}else{bc=bj.boldStyle;a9=bj.italicStyle;bb=bj.underlineStyle;be=bj.strikeStyle}break;case"textAlign":clearHorizontalAlignTab();clearVerticalAlignTab();if(bn){ba=getComputedStyle(bn,null).getPropertyValue("text-align");bf=getComputedStyle(bn,null).getPropertyValue("vertical-align")}else{ba=bj.horizontalAlign;bf=bj.verticalAlign}switch(ba){case"left":an.addClass("selected");break;case"center":aZ.addClass("selected");break;case"right":o.addClass("selected");break}switch(bf){case"top":aA.addClass("selected");break;case"middle":X.addClass("selected");break;case"bottom":q.addClass("selected");break}break}if(bh=="rgba(176, 176, 176, 0)"||bh=="rgba(0, 0, 0, 0)"||bh=="transparent"){L.addClass("nofillColor")
}else{L.removeClass("nofillColor")}if(bd=="fill"||bd=="border"||bd=="text"){L.css("background-color",getRGBvalue(bh))}setToolBarOpacity("fillOpacity",bi);setToolBarWidth("fillWidth",bm);setToolBarFontFace("fontFace",bl);setToolBarFontSize("textSize",bp);if(bc){aU.addClass("selected")}if(a9){ad.addClass("selected")}if(bb){at.addClass("selected")}if(be){ao.addClass("selected")}}a7.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");a2();K(markupTypes.Arrow,"fill");showHideNoFillColor("stroke")}});n.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");a2();K(markupTypes.Line,"fill");showHideNoFillColor("stroke")}});aR.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");S();if(aE===markupTypes.Rectangle){K(markupTypes.Rectangle,"fill");showHideNoFillColor("fill")}else{K(markupTypes.Text,"fill");showHideNoFillColor("fill")}}});aw.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");
aS();if(aE===markupTypes.Rectangle){K(markupTypes.Rectangle,"border");showHideNoFillColor("border")}else{K(markupTypes.Text,"border");showHideNoFillColor("border")}}});aP.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");S();K(markupTypes.Circle,"fill");showHideNoFillColor("fill")}});aV.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");aS();K(markupTypes.Circle,"border");showHideNoFillColor("border")}});ac.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");N();K(markupTypes.Text,"text");showHideNoFillColor("text")}});ar.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");ab();K(markupTypes.Text,"textStyle")}});Q.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");d();K(markupTypes.Text,"textAlign")}});aT.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");
aQ()}});a.on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");ah()}});function S(){O();t.addClass("standBy");v.addClass("standBy")}function a2(){O();t.addClass("standBy");v.addClass("standBy");aH.addClass("standBy")}function aS(){O();t.addClass("standBy");aH.addClass("standBy")}function N(){O();t.addClass("standBy");af.addClass("standBy");aj.addClass("standBy")}function ab(){O();A.addClass("standBy")}function d(){O();i.addClass("standBy")}function aQ(){O();h.addClass("standBy")}function ah(){O();az.addClass("standBy");az.children("img").each(function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}})}t.on({click:function(){var a9=$(this);a9.siblings("div").children().each(function(){if($(this).hasClass("active")){$(this).removeClass("active")}});if(a1.hasClass("active")){a1.removeClass("active")}else{a1.addClass("active")}}});v.on({click:function(){var a9=$(this);a9.siblings("div").children().each(function(){if($(this).hasClass("active")){$(this).removeClass("active")
}});if(a4.hasClass("active")){a4.removeClass("active")}else{a4.addClass("active")}}});aH.on({click:function(){var a9=$(this);a9.siblings("div").children().each(function(){if($(this).hasClass("active")){$(this).removeClass("active")}});if(aO.hasClass("active")){aO.removeClass("active")}else{aO.addClass("active")}}});af.on({click:function(){var a9=$(this);a9.siblings("div").children().each(function(){if($(this).hasClass("active")){$(this).removeClass("active")}});if(aN.hasClass("active")){aN.removeClass("active")}else{aN.addClass("active")}}});aj.on({click:function(){var a9=$(this);a9.siblings("div").children().each(function(){if($(this).hasClass("active")){$(this).removeClass("active")}});if(a0.hasClass("active")){a0.removeClass("active")}else{a0.addClass("active")}}});a1.on({click:function(){var ba=$(this);if(ba.attr("data-bgcolor")=="none"){L.addClass("nofillColor")}else{L.removeClass("nofillColor")}L.attr("style",ba.attr("style"));var a9=getSingleSelectedMarkupObject(0);var bb=aJ[aE];
switch(aE){case markupTypes.Arrow:case markupTypes.Line:if(a9){a9.setFillColor(L.css("background-color"))}bb.fillColor=L.css("background-color");break;case markupTypes.Text:if(a9){if(ac.hasClass("selected")){a9.setFontColor(getRGBAcolor(L.css("background-color"),getSingleSelectedObject(0).getAttribute("data-opacity")));document.getElementById("textAreaContainer").style.color=L.css("background-color")}}if(ac.hasClass("selected")){bb.fontColor=L.css("background-color")}case markupTypes.Rectangle:if(a9){if(aR.hasClass("selected")){a9.setFillColor(L.css("background-color"));if(document.getElementById("textAreaContainer").style.display!="none"){var bc=L.css("background-color");if(bc=="rgba(176, 176, 176, 0)"||bc=="rgba(0, 0, 0, 0)"||bc=="transparent"){bc="rgba(255, 255, 255, 1)"}$(getElement("textAreaContainer")).css("background-color",bc)}}if(aw.hasClass("selected")){a9.setBorderColor(L.css("background-color"))}}if(aR.hasClass("selected")){bb.fillColor=L.css("background-color")}if(aw.hasClass("selected")){bb.borderColor=L.css("background-color")
}break;case markupTypes.Circle:if(a9){if(aP.hasClass("selected")){a9.setFillColor(L.css("background-color"))}if(aV.hasClass("selected")){a9.setBorderColor(L.css("background-color"))}}if(aP.hasClass("selected")){bb.fillColor=L.css("background-color")}if(aV.hasClass("selected")){bb.borderColor=L.css("background-color")}break}R();return false}},"div");a4.on({click:function(){j.text($(this).text());var a9=getSingleSelectedMarkupObject(0);if(a9){a9.setOpacity(getSelectedOpacity("fillOpacity"))}aJ[aE].setOpacityLevel($(this).text());R();return false}},"div");aO.on({click:function(){p.text($(this).text());var a9=getSingleSelectedMarkupObject(0);if(a9){a9.setBorderWeight(getSelectedWidth("fillWidth"));if(a9.markupType===markupTypes.Arrow){changeArrowHeadSize(a9.shapes.SVGArrowHead,a9.shapes.SVGPath,a9.attributes)}var ba=pageCollection[(selectedObjectCollection[0].pageId)];reCalculateHandles(ba)}aJ[aE].borderWeight=$(this).text();R();return false}},"div");aN.on({click:function(){$(getElement("fontFace")).text($(this).text());
R();var a9=document.getElementById("fontFace").innerHTML;if(getSelectedObjectGroup()!=null){var ba=getSingleSelectedMarkupObject(0);ba.setFontFamily(a9);document.getElementById("textAreaContainer").style.fontFamily=a9}aJ[aE].fontFamily=a9;return false}},"div");a0.on({click:function(){$(getElement("textSize")).text($(this).text());R();var bb=document.getElementById("textSize").innerHTML;if(getSelectedObjectGroup()!=null){var ba=parseInt(selectedObjectCollection[0].markupId);var a9=getSingleSelectedMarkupObject(0);a9.setFontSize(bb);document.getElementById("textAreaContainer").style.fontSize=bb;if(isIE){wrapTextOnSizeChange();setVerticalAlignOnChange(document.getElementById("divText-"+ba))}}aJ[aE].fontSize=bb;return false}},"div");function O(){ae.children("div").css("display","none").removeClass("standBy");R()}function R(){ae.children("div").children("div").each(function(){if($(this).hasClass("active")){$(this).removeClass("active")}})}$(".textStyleContainer").children("img").each(function(){$(this).on({click:function(){if($(this).hasClass("selected")){$(this).removeClass("selected");
return false}else{$(this).addClass("selected")}}})});aU.on("click",function(){var ba=$(this);if(getSelectedObjectGroup()!=null){var a9=getSingleSelectedMarkupObject(0);if(ba.hasClass("selected")){a9.setBoldStyle("bold");document.getElementById("textAreaContainer").style.fontWeight="bold"}else{a9.setBoldStyle("normal");document.getElementById("textAreaContainer").style.fontWeight="normal"}}aJ[aE].boldStyle=ba.hasClass("selected")});ad.on("click",function(){var ba=$(this);if(getSelectedObjectGroup()!=null){var a9=getSingleSelectedMarkupObject(0);if(ba.hasClass("selected")){a9.setItalicStyle("italic");document.getElementById("textAreaContainer").style.fontStyle="italic"}else{a9.setItalicStyle("normal");document.getElementById("textAreaContainer").style.fontStyle="normal"}}aJ[aE].italicStyle=ba.hasClass("selected")});at.on("click",function(){var ba=$(this);if(getSelectedObjectGroup()!=null){var a9=getSingleSelectedMarkupObject(0);if(ba.hasClass("selected")){if(ao.hasClass("selected")){a9.setUnderlineStrikeStyle("underline line-through");
document.getElementById("textAreaContainer").style.textDecoration="underline line-through"}else{a9.setUnderlineStrikeStyle("underline");document.getElementById("textAreaContainer").style.textDecoration="underline"}}else{if(ao.hasClass("selected")){a9.setUnderlineStrikeStyle("line-through");document.getElementById("textAreaContainer").style.textDecoration="line-through"}else{a9.setUnderlineStrikeStyle("none");document.getElementById("textAreaContainer").style.textDecoration="none"}}}aJ[aE].underlineStyle=ba.hasClass("selected")});ao.on("click",function(){var ba=$(this);if(getSelectedObjectGroup()!=null){var a9=getSingleSelectedMarkupObject(0);if(ba.hasClass("selected")){if(at.hasClass("selected")){a9.setUnderlineStrikeStyle("underline line-through");document.getElementById("textAreaContainer").style.textDecoration="underline line-through"}else{a9.setUnderlineStrikeStyle("line-through");document.getElementById("textAreaContainer").style.textDecoration="line-through"}}else{if(at.hasClass("selected")){a9.setUnderlineStrikeStyle("underline");
document.getElementById("textAreaContainer").style.textDecoration="underline"}else{a9.setUnderlineStrikeStyle("none");document.getElementById("textAreaContainer").style.textDecoration="none"}}}aJ[aE].strikeStyle=ba.hasClass("selected")});$(".textAlignContainer").children("img").each(function(){$(this).on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");var bd=$(this).context.id;var be=bd.indexOf("Align");bd=bd.substring(0,be);if(getSelectedObjectGroup()!=null){var ba=parseInt(selectedObjectCollection[0].markupId);var bg=pageCollection[parseInt(selectedObjectCollection[0].pageId)];var bf=bg.attributes.rotateDegrees;var bh=getSelectedObjectGroup().firstChild.getAttribute("width");if(bf===90||bf===270){bh=getSelectedObjectGroup().firstChild.getAttribute("height")}var bc=document.getElementById("divText-"+ba).childNodes.length;var a9=getSingleSelectedMarkupObject(0);switch($(this).context.id){case"leftAlign":if(isIE){a9.setSVGTextValueX(5);a9.setTextAnchor("start");
for(var bb=1;bb<bc;bb++){document.getElementById("divText-"+ba).childNodes[bb].setAttributeNS(null,"x",5)}}a9.setHorizontalAlign("left");break;case"centerAlign":if(isIE){a9.setSVGTextValueX(parseInt(bh/2));a9.setTextAnchor("middle");for(var bb=1;bb<bc;bb++){document.getElementById("divText-"+ba).childNodes[bb].setAttributeNS(null,"x",parseInt(bh/2))}}a9.setHorizontalAlign("center");break;case"rightAlign":if(isIE){a9.setSVGTextValueX(parseInt(bh-5));a9.setTextAnchor("end");for(var bb=1;bb<bc;bb++){document.getElementById("divText-"+ba).childNodes[bb].setAttributeNS(null,"x",parseInt(bh-5))}}a9.setHorizontalAlign("right");break}}aJ[aE].horizontalAlign=bd}})});$(".verticalAlignContainer").children("img").each(function(){$(this).on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");var bd=$(this).context.id;var be=bd.indexOf("Align");bd=bd.substring(0,be);if(getSelectedObjectGroup()!=null){var bb=parseInt(selectedObjectCollection[0].markupId);var bg=pageCollection[parseInt(selectedObjectCollection[0].pageId)];
var bf=bg.attributes.rotateDegrees;var bh=getSelectedObjectGroup().firstChild.getAttribute("height");if(bf===90||bf===270){bh=getSelectedObjectGroup().firstChild.getAttribute("width")}var bj=document.getElementById("divText-"+bb).style.fontSize.replace("px","");var bc=document.getElementById("divText-"+bb).childNodes.length;var ba=parseInt(bj)*parseInt(bc-1);var bi=parseInt(bh)+(parseInt(bj)/2);var a9=getSingleSelectedMarkupObject(0);switch($(this).context.id){case"topAlign":if(isIE){a9.setSVGTextValueY(parseInt(bj))}a9.setVerticalAlign("top");break;case"middleAlign":if(isIE){a9.setSVGTextValueY(parseInt(bi/2)-parseInt(ba/2))}a9.setVerticalAlign("middle");break;case"bottomAlign":if(isIE){a9.setSVGTextValueY(parseInt(bh-10)-ba)}a9.setVerticalAlign("bottom");break}}aJ[aE].verticalAlign=bd}})});az.children("img").each(function(){$(this).on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");switch(this.id){case"annotationBringFront":layerMarkupObject(layerOptions.Top);
break;case"annotationMoveFront":layerMarkupObject(layerOptions.Forward);break;case"annotationMoveBack":layerMarkupObject(layerOptions.Backward);break;case"annotationBringBack":layerMarkupObject(layerOptions.Bottom);break}}})});$(getElement("cancelPrinting")).on("click",function(){isPrintingCancelled=true;clearTimeoutCollection();ai.css("display","none");aa.css("display","none")});$(getElement("closePrintModal")).on("click",function(){hidePrintModal()});$(".printDocument").on("click",function(){transferTextAreaValuetoDiv(lastSelectedDivReason);if($(this).hasClass("disable-tool")){return}document.getElementById("printAll").checked=true;document.getElementById("printCurrent").checked=false;var a9=hasObjectsOnDocument();document.getElementById("w_redaction").checked=a9.hasRedactions;if(a9.hasRedactions===false){document.getElementById("w_redaction").disabled=true}else{document.getElementById("w_redaction").disabled=false}document.getElementById("w_annotation").checked=false;if(a9.hasAnnotations===false){document.getElementById("w_annotation").disabled=true
}else{document.getElementById("w_annotation").disabled=false}H.css("display","block");aa.css("display","block")});$(getElement("printDoc")).on("click",function(){H.css("display","none");printDocument()});ak.on("mouseup",function(){deleteSingleMarkup();removeSingleMarkupInArray();clearAllHandles();s.css("display","none");$(getElement("viewer-redactbox")).css("display","none")});aM.on("click",function(){var bb=$(this),a9=$(".annotateBoxTab"),ba=$(".tabContent");if(s.is(":animated")){return false}a9.css("display","none");ba.css("display","none");ak.css("display","none");if(bb.data("resize")=="minimize"){bb.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize");s.animate({width:"35px"},500)}else{if(bb.data("resize")=="maximize"){bb.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Maximize"}).data("resize","minimize");s.animate({width:"284px"},500,function(){a9.css("display","inline-block");ba.css("display","block");ak.css("display","block")
})}}});T.on("click",function(){$(".redact-container").children("img").each(function(){$(this).data("active",false).removeClass("selected-tool")});s.css("display","none");deactivateAnnotationDraw();setMouseStyle();return false});function aC(){b.data("active",false).removeClass("selected-tool");W.data("active",false).removeClass("selected-tool");ay.data("active",false).removeClass("selected-tool");a3.data("active",false).removeClass("selected-tool");aI.data("active",false).removeClass("selected-tool");M.data("active",false).removeClass("selected-tool");Y.css("display","none");x.css("display","none");C.css("display","none");I.css("display","none");l.css("display","none");au.css("display","none");aW.css("display","none")}G.on({mousedown:function(){var a9=$(this);if(a9.data("active")==false){m.css("display","block");a9.data("active",true).addClass("selected-tool").removeAttr("style");getSearchedWordRow()}else{if(a9.data("active")==true){m.css("display","none");a9.data("active",false).removeClass("selected-tool")
}}},mouseenter:function(){var a9=$(this);if(a9.data("active")==false){a9.css({"background-color":"#767676"})}},mouseleave:function(){var a9=$(this);if(a9.data("active")==false){a9.removeAttr("style")}}});av.on("scroll",scrollFn);Z.find("ul > li").css({cursor:"default"});Z.find("ul > li > i").css({opacity:"1"});var a5=V.text();if(V.text()==a5){$(getElement("firstBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("prevBtn")).css({cursor:"not-allowed",opacity:"0.5"})}else{if(V.text()==parseInt("1")){$(getElement("lastBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("nextBtn")).css({cursor:"not-allowed",opacity:"0.5"})}}Z.on("click","ul > li",function(){transferTextAreaValuetoDiv(lastSelectedDivReason);var ba=$(this);var a9=$.Event("keypress");a9.which=13;if(ba.data("enable")==true){switch(ba.attr("id")){case"firstPage":jumpPage(1);$(getElement("firstBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("prevBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("lastBtn")).css({cursor:"pointer",opacity:"1"});
$(getElement("nextBtn")).css({cursor:"pointer",opacity:"1"});break;case"prevPage":if(J.val()==""){jumpPage(1)}else{jumpPage(parseInt(J.val())-1);if(J.val()==parseInt("1")){$(getElement("firstBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("prevBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("lastBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("nextBtn")).css({cursor:"pointer",opacity:"1"})}else{$(getElement("firstBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("prevBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("lastBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("nextBtn")).css({cursor:"pointer",opacity:"1"})}}break;case"nextPage":if(J.val()==""){jumpPage(1)}else{jumpPage(parseInt(J.val())+1);if(J.val()==parseInt(V.text())){$(getElement("firstBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("prevBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("lastBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("nextBtn")).css({cursor:"not-allowed",opacity:"0.5"})
}else{$(getElement("firstBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("prevBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("lastBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("nextBtn")).css({cursor:"pointer",opacity:"1"})}}break;case"lastPage":jumpPage(parseInt(V.text()));$(getElement("lastBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("nextBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("firstBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("prevBtn")).css({cursor:"pointer",opacity:"1"});break}}else{if(ba.data("enable")==false){return}}});J.keypress(function(a9){if(a9.which==13){jumpPage(a9.target.value);if(J.val()==parseInt(V.text())){$(getElement("firstBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("prevBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("lastBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("nextBtn")).css({cursor:"not-allowed",opacity:"0.5"})}else{if(J.val()==parseInt("1")){$(getElement("firstBtn")).css({cursor:"not-allowed",opacity:"0.5"});
$(getElement("prevBtn")).css({cursor:"not-allowed",opacity:"0.5"});$(getElement("lastBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("nextBtn")).css({cursor:"pointer",opacity:"1"})}else{if(J.val()!=parseInt(V.text())||J.val()!=parseInt("1")){$(getElement("firstBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("prevBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("lastBtn")).css({cursor:"pointer",opacity:"1"});$(getElement("nextBtn")).css({cursor:"pointer",opacity:"1"})}}}}if(a9.which==8){return true}if((a9.which<48||a9.which>57)){return false}});try{if(this.isMobile===false){document.addEventListener("mousedown",selectAnnotationObject,true);if(isIE){if(msieversion()===11){document.addEventListener("mousemove",fixArrows,true);document.addEventListener("mouseup",fixArrows,true)}}}}catch(c){console.error("Exception: "+c)}function aB(){var be=document.getElementById("walker");var bd=parseInt(be.innerHTML);var ba=bd-1;var bc=highlightWalkerCollection[ba];var bf=bc.rectangles;
var a9=bf.length;for(var bb=0;bb<a9;bb++){changeToHighlightColor(bf[bb])}if(ba===highlightWalkerCollection.length-1&&ba!=0){ba=0;bd=0}else{if(highlightWalkerCollection.length!=1){ba++}}navigateToNextTerm(ba);if(highlightWalkerCollection.length!=1){be.innerHTML=bd+1}}function D(){var be=document.getElementById("walker");var bd=parseInt(be.innerHTML);var ba=bd-1;var bc=highlightWalkerCollection[ba];var bf=bc.rectangles;var a9=bf.length;for(var bb=0;bb<a9;bb++){changeToHighlightColor(bf[bb])}if(ba===0&&ba!=(highlightWalkerCollection.length-1)){ba=highlightWalkerCollection.length-1;bd=highlightWalkerCollection.length+1}else{if(highlightWalkerCollection.length!=1){ba--}}navigateToNextTerm(ba);if(highlightWalkerCollection.length!=1){be.innerHTML=bd-1}}document.getElementById("nextHit").addEventListener("mouseup",aB,true);document.getElementById("prevHit").addEventListener("mouseup",D,true);window.onresize=function(a9){transferTextAreaValuetoDiv(lastSelectedDivReason)};window.addEventListener("onscroll",transferTextAreaValuetoDiv,false);
window.addEventListener("message",function(a9){var ba=a9.data;if(typeof ba=="function"){ba()}UDVApi(ba)});var f;$(window.parent).resize(function(){isResizing=true;clearTimeout(f);f=setTimeout(y,250)});function y(){if(isFitContent){fitToWidthViewablePages()}isResizing=false}};UDViewer.prototype={getRectangleToolbox:function(){return this.rectangleToolBox}};function UDVApi(b){var a=b.arguments;switch(b.functionName){case"loadDocument":loadDocument(a.document,a.markup);break;case"loadAnnotations":getXMLFromServer(true,true,a.markup);break;case"displayReviewTools":displayReviewTools(a.isDisplay);break}}function clearTextStyleTab(){$(getElement("boldText")).removeClass("selected");$(getElement("italicText")).removeClass("selected");$(getElement("strikeoutText")).removeClass("selected");$(getElement("underlineText")).removeClass("selected")}function clearHorizontalAlignTab(){$(getElement("leftAlign")).removeClass("selected");$(getElement("centerAlign")).removeClass("selected");$(getElement("rightAlign")).removeClass("selected")
}function clearVerticalAlignTab(){$(getElement("topAlign")).removeClass("selected");$(getElement("middleAlign")).removeClass("selected");$(getElement("bottomAlign")).removeClass("selected")}function jumpPage(a){var e=$(getElement("viewerContainer")),d=$(".pages"),c=$(".current-page");var b=parseInt(d.text());if(a<=1){a=1;c.val(a);e.scrollTop(0);return false}else{if(a>b){a=b;c.val(a);e.scrollTop(scrollDiff);return false}}e.scrollTop(0);pageNavScroll=true;var f=e.find(".pageContent").filter(":nth-child("+a+")");e.scrollTop(f.position().top);c.val(a)}var DVNotif=$("#DV-Notif"),IconNotif=$(".icon-Notif"),Textmsg=$("#textMsg"),closeNotif=$("#close-Notif");closeNotif.click(function(){DVNotif.animate({top:0},500,"linear",function(){$(this).css({display:"none",visibility:"hidden"})})});DVNotif.on("click",function(){});$(document).keyup(function(a){if(a.keyCode==27){DVNotif.trigger("click")}});function clearAlert(){DVNotif.css({top:"0",display:"none",visibility:"hidden"})}function showAlert(b,a){clearAlert();
switch(a){case"accept":IconNotif.attr("src","images/messagebox/accept.png");closeNotif.addClass("closeAccept");break;case"warning":IconNotif.attr("src","images/messagebox/warning.png");closeNotif.addClass("closeWarning");break;case"error":IconNotif.attr("src","images/messagebox/error.png");closeNotif.addClass("closeError");break}DVNotif.css({display:"block",visibility:"visible"}).attr("class",a).animate({top:"85px",opacity:1},600);Textmsg.text(b)}close=$("#closeMultipleDelete"),resizer=$("#resizeMultipleDelete"),multiDelete=$("#multiple_delete");resizer.on("click",function(){var a=$(this);if(a.data("resize")=="minimize"){multiDelete.css("display","none");container.animate({width:"35px"},500,function(){a.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize")})}else{if(a.data("resize")=="maximize"){container.animate({width:"68px"},500,function(){multiDelete.css("display","block");a.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")
})}}});close.on("click",function(){if(!container.is(":animated")){if(resizer.data("resize")=="maximize"){container.css({width:"284px"});resizer.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")}multiDelete.css("display","block");container.css("display","none")}});multiDelete.on({mouseup:function(){deleteMultipleMarkups();removeMultipleMarkupInArray();selectedObjectCollection=[];clearAllHandles();container.css("display","none")}});var PreloaderModal=document.getElementById("PreloaderModal"),blockerContainer=document.getElementById("blocker"),currentGenNo=0,cur_gen_no=document.getElementById("cur_generate_no"),to_gen_no=document.getElementById("to_generate_no"),preloaderBarFill=document.getElementById("preloaderBarFill"),preloaderLoadingValue,preLoaderHolder=0;isFirstPrint=true;function printDocument(){isPrintingCancelled=false;preloaderBarFill.style.width="0%";preLoaderHolder=0;preloaderLoadingValue=0;currentGenNo=0;printOptions=new PrintingOptions();
generatePrintFrame()}function generatePrintFrame(){var e=document.getElementById("udvPrint");if(e){e.parentNode.removeChild(e)}var a=document.createElement("iframe");a.id="udvPrint";a.style.position="absolute";a.style.bottom=a.style.right="0px";a.style.width=a.style.height="1px";a.style.zIndex="0";a.style.border="none";document.body.appendChild(a);addPrintMediaStyle();isFirstPrint=false;var c;if(a.contentDocument){c=a.contentDocument}else{if(a.contentWindow){c=a.contentWindow.document}else{c=a.document}}var f=documentViewer.printTemplateStr;f=f.replace(/udvPrintOrientation/g,printOptions.landscape?"landscape":"portrait");c.open();c.write(f);c.close();var b=$(".pages").text(),g=$(".current-page").val(),d=pageCollection.length;to_gen_no.innerHTML=printOptions.currentPage?1:b;preloaderLoadingValue=100/Number(to_gen_no.innerHTML);if(b==d){if(printOptions.currentPage){generatePrintPageContent(c,parseInt(g)-1)}else{if(printOptions.allPages){generatePrintPageContent(c,0)}}}}function generatePrintPageContent(c,b){PreloaderModal.style.display="block";
currentGenNo++;cur_gen_no.innerHTML=currentGenNo;preLoaderHolder+=preloaderLoadingValue;preloaderBarFill.style.width=preLoaderHolder+"%";var e=pageCollection[b];var a=$(document.createElement("div"));a.attr("id","print_"+e.attributes.id);if(isChrome||isFirefox||isOpera){a.addClass("page")}else{if(isIE){a.addClass("pageIE")}else{if(isSafari){a.addClass("pageSafari")}}}var d=$(c.getElementById("print-viewerContainer"));d.append(a);loadSvgPrintPage(a,e,b,c)}function loadSvgPrintPage(b,d,f,a){var g=createSVGElement("svg");g.setAttribute("id","print_svgp_"+(f+1));g.setAttributeNS(xmlNamespace,"xmlns",svgNamespace);g.setAttributeNS(xmlNamespace,"xmlns:xlink","http://www.w3.org/1999/xlink");g.setAttribute("version","1.1");var e=createSVGElement("g");e.setAttribute("class","print_gWrapper");e.setAttribute("transform",getTransformVal(d,b));var h=null;if(d.svgMarkupGroup){h=generateMarkUpGrp(d.svgMarkupGroup);if(h){h.setAttribute("data-isi","print_"+h.getAttribute("data-isi"))}}var c=function(){getSVGFileFromServerForPrintPage(e,h,f,a)
};executeTimeout(c,100);g.appendChild(e);b.append($(g))}function generateMarkUpGrp(a){var c=null;if(printOptions.withRedaction|printOptions.withAnnotation){c=a.cloneNode(true);var d=$(c).children(),e=null;for(var b=0;b<d.length;b++){e=d.eq(b);if(printOptions.withRedaction&&(e.attr("data-isi").indexOf("redaction")>-1)){}else{if(printOptions.withAnnotation&&(e.attr("data-isi").indexOf("annotation")>-1)){}else{e.remove()}}}}return c}function getSVGFileFromServerForPrintPage(c,e,a,b){var d=new XMLHttpRequest();d.open("GET",documentViewer.domain+"/DocViewerWS/rest/document/svg?nativeFilePath="+documentAbsPath+"&pgn="+(a+1)+"&logFileStatus="+logFileStatus+breakCacheParameter(),true);d.send(null);d.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var h=JSON.parse(d.responseText),f=h.status;if(f!="Queued"){var g=html5.createElement("g");g.innerHTML=h.content;c.appendChild(g.firstChild);if(e){c.appendChild(e)}}if(printOptions.allPages&&a<(pageCollection.length-1)){if(!isPrintingCancelled){generatePrintPageContent(b,(a+1))
}}else{PreloaderModal.style.display="none";blockerContainer.style.display="none";executeTimeout(showPrintFormForBrowser,1000)}}}}function showPrintFormForBrowser(){var a=document.getElementById("udvPrint");if(isChrome||isSafari){a.contentWindow.focus();a.contentWindow.document.execCommand("print",false,null)}else{if(isFirefox||isIE){a.contentWindow.focus();a.contentWindow.print()}}if(documentViewer.printCallback){documentViewer.printCallback()}}function getTransformVal(h,a){var b=h.rotatedDimensions().width,g=h.rotatedDimensions().height,c=h.attributes.rotateDegrees,e=h.attributes.rotateX,d=h.attributes.rotateY,f=sfW=sfH=1;var i=b>g;c=(c===360)?0:c;switch(true){default:case printOptions.autoOrientation:if(isSafari){a.addClass("portraitSafari");if(i){c+=90;e=setRotationAxis(c,h).rx;d=setRotationAxis(c,h).ry;sfW=setPrintScaleFactor(b,806.4);sfH=setPrintScaleFactor(g,624)}else{sfW=setPrintScaleFactor(b,662.4);sfH=setPrintScaleFactor(g,854.4)}}else{if(isIE){a.addClass("portraitIE");if(i){c+=90;
e=setRotationAxis(c,h).rx;d=setRotationAxis(c,h).ry;sfW=setPrintScaleFactor(b,868.8);sfH=setPrintScaleFactor(g,672)}else{sfW=setPrintScaleFactor(b,700.8);sfH=setPrintScaleFactor(g,912)}}else{a.addClass("portrait");if(i){c+=90;e=setRotationAxis(c,h).rx;d=setRotationAxis(c,h).ry;sfW=setPrintScaleFactor(b,1056);sfH=setPrintScaleFactor(g,816)}else{sfW=setPrintScaleFactor(b,816);sfH=setPrintScaleFactor(g,1056)}}}f=sfH<sfW?sfH:sfW;break;case printOptions.portrait:if(isSafari){a.addClass("portraitSafari");sfW=setPrintScaleFactor(b,662.4);sfH=setPrintScaleFactor(g,854.4)}else{if(isIE){a.addClass("portraitIE");sfW=setPrintScaleFactor(b,700.8);sfH=setPrintScaleFactor(g,912)}else{a.addClass("portrait");sfW=setPrintScaleFactor(b,816);sfH=setPrintScaleFactor(g,1056)}}f=sfH<sfW?sfH:sfW;break;case printOptions.landscape:if(isSafari){a.addClass("landscapeSafari");sfW=setPrintScaleFactor(b,806.4);sfH=setPrintScaleFactor(g,624)}else{if(isIE){a.addClass("landscapeIE");sfW=setPrintScaleFactor(b,868.8);sfH=setPrintScaleFactor(g,672)
}else{a.addClass("landscape");sfW=setPrintScaleFactor(b,1056);sfH=setPrintScaleFactor(g,816)}}f=sfH<sfW?sfH:sfW;break}var j=getTransformMatrixValue(f,c,e,d);return j}function setPrintScaleFactor(b,c){var a=1;if(b>c){a=c/b}return a}function setRotationAxis(b,c){var a={};switch(b){case 0:case 90:case 360:a.rx=a.ry=c.attributes.pageHeight/2;break;case 180:a.rx=c.attributes.pageWidth/2;a.ry=c.attributes.pageHeight/2;break;case 270:a.rx=a.ry=c.attributes.pageWidth/2;break}return a}function addPrintMediaStyle(){if(!isIE){return}if(!isFirstPrint){return}var g=window.parent.document;var a=g.activeElement;var e=g.defaultView.document;var b=e.getElementById("udvPrint")?true:false;if(!b){var f='[data-udvcontainer|="UDVContainer"]';if(a.id){f="#"+a.id}else{a.setAttribute("data-udvcontainer","UDVContainer")}var d=f+"{width: 100%;}";var c=document.createElement("style");c.setAttribute("type","text/css");c.setAttribute("media","print");if(c.sheet){c.sheet.cssText=d}g.head.appendChild(c)}}$(function(){var j=new Dropdown(".reason-container",".reasons-available-container");
$(document).on("click",function(){$(".reasons-available-container").removeClass("active")});$(".reasons-holder").on({click:selectRedactionReason});var m=$(".redactControls"),d=$(".redactControls-contents"),a=$("#viewer-redactbox"),k=$("#resizeRedactBox"),i=$("#Redact_delete"),l=$("#Redact_fill"),c=$("#Redact_index"),e=$(".reasons-holder"),h=$(".reason-container"),g=$(".layering-controls"),b=$(".downloadDocument");k.on("click",function(){var n=$(this);if(n.data("resize")=="minimize"){m.css("display","none");d.css("display","none");i.css("display","none");a.animate({width:"35px"},500,function(){n.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize")})}else{if(n.data("resize")=="maximize"){a.animate({width:"284px"},500,function(){m.css("display","block");d.css("display","block");i.css("display","block");n.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")})}}});e.on({mouseenter:hoverRedactionReason,mouseleave:outRedactionReason});
l.on({mousedown:function(){var n=$(this);n.siblings("img").removeClass("selected").end().addClass("selected");h.css("display","block");g.css("display","none");$(".reasons-holder").parent().siblings(".selected-reason").children("span").text(getSelectedRedactionReason(0))}});c.on({mousedown:function(){var n=$(this);n.siblings("img").removeClass("selected").end().addClass("selected");h.css("display","none");g.css("display","block");g.children("img").each(function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}})}});$("#closeRedact").on("click",function(){if(!a.is(":animated")){$("#addRedact").data("active",false).removeClass("selected-tool");if(k.data("resize")=="maximize"){a.css({width:"284px"});k.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")}i.css("display","block");m.css("display","block");d.css("display","block");a.css("display","none");f();deactivateAnnotationDraw();setMouseStyle()}});function f(){var o=$("#viewer-document-wrapper"),n=o.children(".pageContent");
$("#addRedact").data("active",false).removeClass("selected-tool");n.removeClass("cursorCrosshair")}i.on({mouseup:function(){deleteSingleMarkup();removeSingleMarkupInArray();clearAllHandles()}});g.children("img").each(function(){$(this).on({click:function(){$(this).siblings().removeClass("selected").end().addClass("selected");switch(this.id){case"redactionBringFront":layerMarkupObject(layerOptions.Top);break;case"redactionMoveFront":layerMarkupObject(layerOptions.Forward);break;case"redactionMoveBack":layerMarkupObject(layerOptions.Backward);break;case"redactionBringBack":layerMarkupObject(layerOptions.Bottom);break}}})});b.on({click:function(){transferTextAreaValuetoDiv(lastSelectedDivReason);if($(this).hasClass("disable-tool")){return}}})});var hasRedactedFile=false;function checkRedactedFile(){if(documentViewer.markupPath&&documentViewer.markupPath!=""){if(logFileStatus==="Completed"){var a=new XMLHttpRequest();a.open("GET",documentViewer.domain+"/DocViewerWS/rest/document/redactedFileExists?markupPath="+documentViewer.markupPath+breakCacheParameter(),true);
a.send();a.onreadystatechange=function(){if(a.readyState==4&&a.status==200){var b=a.responseText;if(b=="true"){hasRedactedFile=true;displayTool($(".downloadDocument"),true)}else{displayTool($(".downloadDocument"),false)}}}}else{displayTool($(".downloadDocument"),false)}}}function checkRedactedFilePostBurn(b){if(!b){b=1}var a=function(){checkRedactedFilePostBurn(b+1)};var c=new XMLHttpRequest();c.open("GET",documentViewer.domain+"/DocViewerWS/rest/document/redactedFileExists?markupPath="+documentViewer.markupPath+breakCacheParameter(),true);c.send();c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var d=c.responseText;if(d==="true"){hasRedactedFile=true;if(documentViewer.postRedactGeneration){documentViewer.postRedactGeneration(documentViewer.documentAbsPath,true)}}else{if(b<200){executeTimeout(a,100)}else{if(documentViewer.postRedactGeneration){documentViewer.postRedactGeneration(documentViewer.documentAbsPath,false)}}}}}}function getRedactedFile(){var a=documentViewer.domain+"/DocViewerWS/rest/document/redactedFile?markupPath="+documentViewer.markupPath+breakCacheParameter();
window.location=a}var rotatePageCW=$(getElement("page-rotatePage")),rotatePageCCW=$(getElement("page-rotatePageCounter")),rotateDocCW=$(getElement("page-rotateDoc")),rotateDocCCW=$(getElement("page-rotateDocCounter")),currentPageCount=$(".current-page");rotatePageCW.on("click",function(){transferTextAreaValuetoDiv(lastSelectedDivReason);var d=parseInt($(".pages").text()),b=parseInt($(".current-page").val()),a=b-1;if(b>=1&&b<=d){var c=parseInt(pageCollection[a].attributes.rotateDegrees);c=(c==360)?0:c;c+=90;rotatePage(a,c);jumpPage(parseInt(currentPageCount.val()))}getScrollHeightPercentage(d)});rotatePageCCW.on("click",function(){transferTextAreaValuetoDiv(lastSelectedDivReason);var d=parseInt($(".pages").text()),b=parseInt($(".current-page").val()),a=b-1;if(b>=1&&b<=d){var c=parseInt(pageCollection[a].attributes.rotateDegrees);c=(c==0)?360:c;c-=90;rotatePage(a,c);jumpPage(parseInt(currentPageCount.val()))}getScrollHeightPercentage(d)});rotateDocCW.on("click",function(){transferTextAreaValuetoDiv(lastSelectedDivReason);
var c=parseInt($(".pages").text());if(c>0){for(var a=0;a<c;a++){var b=parseInt(pageCollection[a].attributes.rotateDegrees);b=(b==360)?0:b;b+=90;rotatePage(a,b)}jumpPage(parseInt(currentPageCount.val()))}getScrollHeightPercentage(c)});rotateDocCCW.on("click",function(){transferTextAreaValuetoDiv(lastSelectedDivReason);var c=parseInt($(".pages").text());if(c>0){for(var a=0;a<c;a++){var b=parseInt(pageCollection[a].attributes.rotateDegrees);b=(b==0)?360:b;b-=90;rotatePage(a,b)}jumpPage(parseInt(currentPageCount.val()))}getScrollHeightPercentage(c)});function rotatePage(a,b){var c=$(getElement("viewer-document-wrapper")).children(".pageContent"),k=c.eq(a);if(k.length){var o=pageCollection[a];var l,d,m,j,n=k[0].style.width,e=k[0].style.height,p=o.attributes.pageWidth,h=o.attributes.pageHeight,i=getViewerContainerWidth(),g;if(b===90||b===270){g=i/h}else{g=i/p}console.log(isFitContent);switch(b){case 90:l=e;d=n;m=h/2;j=m;break;case 180:l=e;d=n;m=p/2;j=h/2;break;case 270:l=e;d=n;m=p/2;j=m;break;
case 0:case 360:default:l=e;d=n;m=h/2;j=m;break}if(isFitContent){if(b==90||b==270){l=parseFloat(g*h);d=parseFloat(g*p)}else{l=parseFloat(g*p);d=parseFloat(g*h)}}o.attributes.rotateDegrees=b;o.attributes.rotateX=m;o.attributes.rotateY=j;var f=k.find(".gWrapper");if(hasNativeSVG(k)||f){if(f.prop("tagName")=="g"){console.log();var q;if(!isFitContent){q=getTransformMatrixValue(scaleFactor,b,m,j)}else{if(b==270||b==90){q=getTransformMatrixValue((getViewerContainerWidth()/h),b,m,j)}else{q=getTransformMatrixValue((getViewerContainerWidth()/p),b,m,j)}console.log(q);if(b==270){q.f=parseFloat(d)}else{if(b==90){q.e=parseFloat(l)}}}Snap(f[0]).transform(q);o.rotateTextMarkups(b)}}k.width(l);k.height(d);reCalculateHandles(pageCollection[a])}displayViewableSvg(k);HScrollBarChecker()}function rotatePageOnLoad(a,b){var c=$(getElement("viewer-document-wrapper")).children(".pageContent"),k=c.eq(a);if(k.length){var o=pageCollection[a];var l,d,m,j,n=k[0].style.width,e=k[0].style.height,p=o.attributes.pageWidth,h=o.attributes.pageHeight,i=getViewerContainerWidth(),g=i/p;
switch(b){case 90:l=h;d=p;m=h/2;j=m;break;case 180:l=p;d=h;m=p/2;j=h/2;break;case 270:l=h;d=p;m=p/2;j=m;break;case 0:case 360:default:l=p;d=h;m=h/2;j=m;break}o.attributes.rotateDegrees=b;o.attributes.rotateX=m;o.attributes.rotateY=j;var f=k.find(".gWrapper");if(hasNativeSVG(k)||f){if(f.prop("tagName")=="g"){var q;if(!isFitContent){q=getTransformMatrixValue(scaleFactor,b,m,j)}else{q=getTransformMatrixValue((getViewerContainerWidth()/p),b,m,j)}Snap(f[0]).transform(q);o.rotateTextMarkups(b)}}k.width(l);k.height(d);reCalculateHandles(pageCollection[a])}displayViewableSvg(k);HScrollBarChecker()}var closeSearch=$("#closeSearchMenu"),searchBox=$("#viewer-searchbox"),searchWordCol=$(".searchedWord-column"),searchedWordRowContainer=$(".searchedWord-row-container"),searchedWordRow=$(".searchedWord-row"),searchWordControls=$(".searchWord-controls"),searchWordCount=$(".searchWord-count"),searchControls=$(".searchControls"),viewerWrapper=$("#viewer-document-wrapper"),matchExact=$("#matchExact"),matchCase=$("#matchCase"),wholeWord=$("#wholeWord"),beginsWith=$("#beginsWith"),endsWith=$("#endsWith"),wildCard=$("#wildCard"),searchResult=searchedWordRowContainer.children(".searchedWord-row").length;
matchExact.on("click",function(){var a=$(this);if(a.data("active")==false){a.addClass("selected-searchControl");a.data("active",true)}else{if(a.data("active")==true){a.removeClass("selected-searchControl");a.data("active",false)}}});matchCase.on("click",function(){var a=$(this);if(a.data("active")==false){a.addClass("selected-searchControl");a.data("active",true)}else{if(a.data("active")==true){a.removeClass("selected-searchControl");a.data("active",false)}}});wholeWord.on("click",function(){var a=$(this);if(a.data("active")==false){a.addClass("selected-searchControl");a.data("active",true)}else{if(a.data("active")==true){a.removeClass("selected-searchControl");a.data("active",false)}}});beginsWith.on("click",function(){var a=$(this);if(a.data("active")==false){a.addClass("selected-searchControl");a.data("active",true)}else{if(a.data("active")==true){a.removeClass("selected-searchControl");a.data("active",false)}}});endsWith.on("click",function(){var a=$(this);if(a.data("active")==false){a.addClass("selected-searchControl");
a.data("active",true)}else{if(a.data("active")==true){a.removeClass("selected-searchControl");a.data("active",false)}}});wildCard.on("click",function(){var a=$(this);if(a.data("active")==false){a.addClass("selected-searchControl");a.data("active",true)}else{if(a.data("active")==true){a.removeClass("selected-searchControl");a.data("active",false)}}});searchControls.on({mouseenter:function(){var a=$(this);a.css({"background-color":"#696969"})},mouseleave:function(){var a=$(this);a.css({"background-color":"transparent"})}},"img");closeSearch.on("click",function(){$("#showSearchMenu").data("active",false).removeClass("selected-tool");searchBox.removeAttr("style");searchBox.css({display:"none"})});searchedWordRow.on({mouseenter:function(b){var a=$(this);a.css({"background-color":"#e5e5e5"})},mouseleave:function(b){var a=$(this);a.css({"background-color":"#fff"})}});searchWordCol.on("click",function(){var a=false});searchWordControls.on({mouseenter:function(){var a=$(this);a.css({"background-color":"#696969"})
},mouseleave:function(){var a=$(this);a.css({"background-color":"#474747"})},mousedown:function(){var a=$(this);a.css({"background-color":"#8C8C8C"})},mouseup:function(){var a=$(this);a.css({"background-color":"#696969"})}},"li");function getSearchedWordRow(){searchWordCount.children(".count").text(searchedWordRowContainer.children().length)}var hlBtn=$("#highLightBtn");var hlRedactBtn=$("#highLightRedactBtn");var searchBtns=$(".search-btns ul > li");var label=$("span.addon").text();var searchFieldVal=$("#searchBox");var clearInput=$("#clearSearchBox");var min=$("#min");var max=$("#max");var temp;var exactWordOption=$("#exactWord");var caseSentivieOption=$("#caseSensitive");$(document).ready(function(){$("#searchTab").on("click",function(){$("#closeAnnotateBox").click();$("#closeRedact").click()});exactWordOption.on("click",function(){$(this).find("i").toggleClass("selected-visibility")});caseSentivieOption.on("click",function(){$(this).find("i").toggleClass("selected-visibility")});hlBtn.on("click",function(){$(".pageContent").toggleClass("text-cursor");
$(this).toggleClass("active-state")});hlRedactBtn.on("click",function(){$(".pageContent").toggleClass("text-cursor");$(this).toggleClass("active-state")});searchBtns.on("click",function(){$(".addon").text($(this).find("span").text());$(".search-content").show();$(this).toggleClass("active-state")});$("#csBtn").on("click",function(){$(".cs-btns").fadeIn("fast");$(".match-btns").hide()});$("#begWBtn").on("click",function(){$(".match-btns").fadeIn("fast");$(".cs-btns").hide()});$("#exactBtn").on("click",function(){$(".cs-btns").hide();$(".match-btns").hide()});$("#alphaBtn").on("click",function(){$(".cs-btns").hide();$(".match-btns").hide()});min.on("click",function(){$(".search-content").hide();$(this).hide();max.show()});max.on("click",function(){$(".search-content").show();$(this).hide();min.show()});searchFieldVal.attr("maxlength",50);searchFieldVal.focusin(function(){searchFieldVal.val(temp)});clearInput.on("click",function(){searchFieldVal.val("");temp=""});searchFieldVal.focusout(function(){temp=searchFieldVal.val();
var b=searchFieldVal.val().length;if(b>=7){searchFieldVal.val(searchFieldVal.val().substr(0,7)+"...")}});$("#searchTab").on("click",function(){$(".search-content").hide();max.show();min.hide()})});$(function(){var u=new Dropdown(".squareWidthPicker",".width-available-container"),p=new Dropdown(".squareopacityPicker",".opacity-available-container"),m=$(".squarecolorPickerBox"),c=$(".squareopacityPicker"),a=$(".squareWidthPicker"),i=$(".availableColors"),o=$("#closeSquare"),j=$("#resizeSquareAnnotate"),k=$(".SquareControls"),r=$(".SquareControls-contents"),h=$("#viewer-squareAnnotate"),l=$("#square_delete"),s=$("#SquareStyle"),g=$("#Square_index"),q=$("#SquareB"),w=$(".squareAnnotateStyle"),d=$(".squarelayering-controls"),b=$(".squareborder-controls"),n=$(".squareBringFront"),v=$(".squareBringBack"),f=$(".squareMoveFront"),t=$(".squareMoveBack");$(document).on("click",function(){c.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");
m.children(".availableColors").removeClass("active")});c.on("click",function(){a.children(".width-available-container").removeClass("active");m.children(".availableColors").removeClass("active")});a.on("click",function(){c.children(".opacity-available-container").removeClass("active");m.children(".availableColors").removeClass("active")});m.on("click",function(){var x=$(this);x.children(".availableColors").addClass("active");c.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");return false});$(".opacity-holder").on({click:function(){var y=$(this),x=y.text();y.parent().siblings(".selectedSquareOpacity").children("span").text(x);if($("#viewer-squareAnnotate").css("display")==="block"){setOpacity(getSingleSelectedObject(0),"rect_fillOpacity")}}});$(".width-holder").on({click:function(){var y=$(this),x=y.text();y.parent().siblings(".selectedSquareWidth").children("span").text(x);if($("#viewer-squareAnnotate").css("display")==="block"){setWidth(getSingleSelectedObject(0),"rect_borderWidth")
}}});i.on("click","div",function(x){$(this).parent().removeClass("active");$(this).parent(".availableColors").siblings(".selectedColor").attr("style",$(this).attr("style"));if($("#viewer-squareAnnotate").css("display")==="block"){if($("#SquareB").hasClass("selected")){setAttributeColor("stroke",getSingleSelectedObject(0),"rect_borderColor")}if($("#SquareStyle").hasClass("selected")){setAttributeColor("fill",getSingleSelectedObject(0),"rect_fillColor")}}return false});j.on("click",function(){var x=$(this);if(x.data("resize")=="minimize"){k.css("display","none");r.css("display","none");l.css("display","none");h.animate({width:"35px"},500,function(){x.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize")})}else{if(x.data("resize")=="maximize"){h.animate({width:"284px"},500,function(){k.css("display","block");r.css("display","block");l.css("display","block");x.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")
})}}});s.on({mousedown:function(){var x=$(this);x.siblings("img").removeClass("selected").end().addClass("selected");w.css("display","block");d.css("display","none");b.css("display","none")}});g.on({mousedown:function(){var x=$(this);x.siblings("img").removeClass("selected").end().addClass("selected");w.css("display","none");d.css("display","block");b.css("display","none")}});q.on({mousedown:function(){var x=$(this);x.siblings("img").removeClass("selected").end().addClass("selected");w.css("display","none");d.css("display","none");b.css("display","block")}});o.on("click",function(){if(!h.is(":animated")){if(j.data("resize")=="maximize"){h.css({width:"284px"});j.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")}l.css("display","block");k.css("display","block");r.css("display","block");h.css("display","none");e()}});function e(){var y=$("#viewer-document-wrapper"),x=y.children(".pageContent");$("#addSquare").data("active",false).removeClass("selected-tool");
x.removeClass("cursorCrosshair")}l.on({mouseup:function(){deleteSingleMarkup();removeSingleMarkupInArray();clearAllHandles()}});n.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Top)}});v.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Bottom)}});f.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Forward)}});t.on("click",function(){var x=getSelectedObjectGroup();if(x){layerAnnotationObject(x,layerOptions.Backward)}})});function loadSVG(f){var o=false;if(!((logFileStatus=="ConvertingToSVG")||(logFileStatus=="Completed"))){o=true}var l=f,i=l.index(),a=i+1,b=pageCollection[i];if(!l.attr("id")){l.attr("id",("udv_page_"+a))}var j=createSVGElement("svg");j.setAttribute("id","svgp_"+a);j.setAttributeNS(xmlNamespace,"xmlns",svgNamespace);j.setAttributeNS(xmlNamespace,"xmlns:xlink","http://www.w3.org/1999/xlink");j.setAttribute("version","1.1");j.setAttribute("class","svgWrapperClass");
var d=createSVGElement("g");d.setAttribute("class","gWrapper");var e=null;var h=null;if(!o){if(!b.svgMarkupGroup){e=createSVGElement("g");e.setAttribute("data-isi","markups-"+a);h=createSVGElement("g");h.setAttribute("data-isi","highlights-"+a);b.svgMarkupGroup=e;b.svgHighlightGroup=h}else{e=b.svgMarkupGroup;h=b.svgHighlightGroup}if(!b.svgHighlightGroup){h=createSVGElement("g");h.setAttribute("data-isi","highlights-"+a);b.svgHighlightGroup=h}else{h=b.svgHighlightGroup}}var c=b.attributes,n=c.rotateDegrees,m=c.rotateX,k=c.rotateY,g=getTransformMatrixValue(isFitContent?getFitToWidthScaleFactor(c.pageWidth):scaleFactor,n,m,k);d.setAttribute("transform",g);getSVGFileFromServer(b,i,e,h,d,f);j.appendChild(d);l.append($(j));if(!o){b.svgPage=j;if(isFitContent){newFit(b,d,isFitContent,document.getElementById("viewer-document-wrapper").offsetWidth-20)}}}function getSVGFileFromServer(e,a,f,c,b,g){var d=new XMLHttpRequest();d.open("GET",documentViewer.domain+"/DocViewerWS/rest/document/svg?nativeFilePath="+documentAbsPath+"&pgn="+(a+1)+"&logFileStatus="+logFileStatus+breakCacheParameter(),true);
d.send(null);d.onreadystatechange=function(){var h=function(){getSVGFileFromServer(e,a,f,c,b,g)};if(this.readyState==4&&this.status==200){var l=JSON.parse(d.responseText),j=l.status,i=$(g);if(j==="Queued"){e.isErroredPage=true;if(isPageViewable(i)){setPageContentBackground(i,j);setTimeout(h,200)}else{e.isPageRequested=false}}else{e.isErroredPage=false;setPageContentBackground(i,j);var k=html5.createElement("g");k.innerHTML=l.content;b.appendChild(k.firstChild);if(f){if(c){b.appendChild(c)}b.appendChild(f);e.initializeHighlights();i.append($(e.divHandles));reCalculateHandles(e);e.rotateTextMarkups(e.attributes.rotateDegrees)}if(j==="ErroredPage"){e.isErroredPage=true;recalculateErroredPageAttr(e,i)}}}}}function setPageContentBackground(b,a){if(a==="Queued"){b.css("background-image",'url("images/loader.gif")');b.css("background-repeat","no-repeat");b.css("background-attachment","relative");b.css("background-position","center")}else{b.css("background-image","none")}}function isPageViewable(b){var e=b,c=e.position().top,a=e.position().top+e.outerHeight(true),d=$(getElement("viewerContainer")).position().top,f=$(getElement("viewerContainer")).outerHeight(true);
if(e.hasClass("currentView")){return true}else{if(a>d&&c<(f+d)){return true}else{return false}}}function hasChildren(a){var b=a;if(b.children().length>0){return true}else{return false}}function removeSVG(a){var b=a;pageCollection[b.index()].svgPage=null;b.children().remove()}function hasNativeSVG(a){var c=a;if(c.children().length>0){var b=c.find(".gWrapper").find("svg");if(b.prop("tagName")=="svg"){return true}else{return false}}else{return false}}function recalculateErroredPageAttr(e,d){var c,b,a=e.attributes.rotateDegrees;switch(a){case 180:c=erroredPage.width/2;b=erroredPage.height/2;break;case 270:c=erroredPage.width/2;b=c;break;case 0:case 90:case 360:default:c=erroredPage.height/2;b=c;break}e.attributes.rotateX=c;e.attributes.rotateY=b;e.attributes.pageWidth=erroredPage.width;e.attributes.pageHeight=erroredPage.height;newPageW=erroredPage.width*scaleFactor;newPageH=erroredPage.height*scaleFactor;if(a==90||a==270){d.css("height",newPageW);d.css("width",newPageH)}else{d.css("height",newPageH);
d.css("width",newPageW)}}function displayViewableSvg(a){if(isPageViewable(a)){var b=pageCollection[a.index()];if(!hasChildren(a)){loadSVG(a);b.isPageRequested=true}else{if(!hasNativeSVG(a)){if(!b.isPageRequested){removeSVG(a);loadSVG(a);b.isPageRequested=true}}}}else{if(hasChildren(a)){removeSVG(a)}}}$(function(){var C=new Dropdown(".textboxWidthPicker",".width-available-container"),t=new Dropdown(".textboxopacityPicker",".opacity-available-container"),w=new Dropdown(".textfontPicker",".fonts-available-container"),A=new Dropdown(".textsizePicker",".size-available-container"),q=$(".textboxcolorPickerBox"),s=$(".textcolorPickerBox"),d=$(".textboxopacityPicker"),a=$(".textboxWidthPicker"),l=$(".textfontPicker"),u=$(".textsizePicker"),n=$(".availableColors"),r=$("#closeText"),o=$("#resizeTextAnnotate"),p=$(".TextboxControls"),y=$(".TextboxControls-contents"),m=$("#viewer-textAnnotate"),h=$("#textbox_delete"),x=$("#TextboxStyle"),z=$("#TextStyle"),v=$("#TextB"),j=$("#characterStyle"),i=$("#Textbox_index"),E=$(".textboxAnnotateStyle"),D=$(".textStyleTab"),c=$(".textborder-controls"),b=$(".characterStyle-controls"),e=$(".textboxlayering-controls"),g=$(".textBoxBringFront"),F=$(".textBoxBringBack"),k=$(".textBoxMoveFront"),B=$(".textBoxMoveBack");
boldText=$("#boldText"),italicText=$("#italicText"),underlineText=$("#underlineText"),strikeoutText=$("#strikeoutText");boldText.on("click",function(){var H=$(this);var G=getSelectedObjectGroup().childNodes[1].children[0].children[0].id;if(H.hasClass("selected")){H.removeClass("selected");document.getElementById(G).style.fontWeight="normal";return}H.addClass("selected");document.getElementById(G).style.fontWeight="bold"});italicText.on("click",function(){var H=$(this);var G=getSelectedObjectGroup().childNodes[1].children[0].children[0].id;if(H.hasClass("selected")){H.removeClass("selected");document.getElementById(G).style.fontStyle="normal";return}H.addClass("selected");document.getElementById(G).style.fontStyle="italic"});underlineText.on("click",function(){var H=$(this);var G=getSelectedObjectGroup().childNodes[1].children[0].children[0].id;if(H.hasClass("selected")){H.removeClass("selected");if(strikeoutText.hasClass("selected")){document.getElementById(G).style.textDecoration="line-through"
}else{document.getElementById(G).style.textDecoration="none"}return}H.addClass("selected");if(strikeoutText.hasClass("selected")){document.getElementById(G).style.textDecoration="underline line-through"}else{document.getElementById(G).style.textDecoration="underline"}});strikeoutText.on("click",function(){var H=$(this);var G=getSelectedObjectGroup().childNodes[1].children[0].children[0].id;if(H.hasClass("selected")){H.removeClass("selected");if(underlineText.hasClass("selected")){document.getElementById(G).style.textDecoration="underline"}else{document.getElementById(G).style.textDecoration="none"}return}H.addClass("selected");if(underlineText.hasClass("selected")){document.getElementById(G).style.textDecoration="underline line-through"}else{document.getElementById(G).style.textDecoration="line-through"}});$(document).on("click",function(){d.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");n.removeClass("active")
});d.on("click",function(){a.children(".width-available-container").removeClass("active");n.removeClass("active")});a.on("click",function(){d.children(".opacity-available-container").removeClass("active");n.removeClass("active")});l.on("click",function(){u.children(".size-available-container").removeClass("active");n.removeClass("active");var G=document.getElementById("text_fontFace");var H=getSelectedObjectGroup().childNodes[1].children[0].children[0].id;document.getElementById(H).style.fontFamily=G.innerHTML});u.on("click",function(){l.children(".fonts-available-container").removeClass("active");n.removeClass("active");var G=document.getElementById("text_fontSize");var H=getSelectedObjectGroup().childNodes[1].children[0].children[0].id;document.getElementById(H).style.fontSize=G.innerHTML+"px"});q.on("click",function(){var G=$(this);G.children(n).addClass("active");d.children(".opacity-available-container").removeClass("active");a.children(".width-available-container").removeClass("active");
return false});s.on("click",function(){var G=$(this);G.children(n).addClass("active");l.children(".fonts-available-container").removeClass("active");u.children(".size-available-containerr").removeClass("active");return false});$(".opacity-holder").on({click:function(){var H=$(this),G=H.text();H.parent().siblings(".selectedTextboxOpacity").children("span").text(G);if($("#viewer-textAnnotate").css("display")==="block"){setOpacity(getSingleSelectedObject(0),"text_fillOpacity")}}});$(".width-holder").on({click:function(){var H=$(this),G=H.text();H.parent().siblings(".selectedTextboxWidth").children("span").text(G);if($("#viewer-textAnnotate").css("display")==="block"){setWidth(getSingleSelectedObject(0),"text_borderWidth")}}});$(".font-holder").on({click:function(){var H=$(this),G=H.text();H.parent().siblings(".selectedTextFont").children("span").text(G)}});$(".size-holder").on({click:function(){var H=$(this),G=H.text();H.parent().siblings(".selectedFontSize").children("span").text(G)}});n.on("click","div",function(H){$(this).parent().removeClass("active");
$(this).parent().siblings(".selectedColor").attr("style",$(this).attr("style"));if($("#viewer-textAnnotate").css("display")==="block"){if($("#TextB").hasClass("selected")){setAttributeColor("stroke",getSingleSelectedObject(0),"text_borderColor")}if($("#TextboxStyle").hasClass("selected")){setAttributeColor("fill",getSingleSelectedObject(0),"text_fillColor")}if($("#TextStyle").hasClass("selected")){var G=getSelectedObjectGroup().childNodes[1].children[0].children[0].id;document.getElementById(G).style.color=getSelectedColor("text_fontColor")}}return false});o.on("click",function(){var G=$(this);if(G.data("resize")=="minimize"){p.css("display","none");y.css("display","none");h.css("display","none");m.animate({width:"35px"},500,function(){G.attr({src:"images/under-redact/RedactBox/Maximize.png",title:"Maximize"}).data("resize","maximize")})}else{if(G.data("resize")=="maximize"){m.animate({width:"284px"},500,function(){p.css("display","block");y.css("display","block");h.css("display","block");
G.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")})}}});x.on({mousedown:function(){var G=$(this);G.siblings("img").removeClass("selected").end().addClass("selected");e.css("display","none");E.css("display","block");D.css("display","none");b.css("display","none");c.css("display","none")}});z.on({mousedown:function(){var G=$(this);G.siblings("img").removeClass("selected").end().addClass("selected");e.css("display","none");E.css("display","none");D.css("display","block");b.css("display","none");c.css("display","none")}});v.on({mousedown:function(){var G=$(this);G.siblings("img").removeClass("selected").end().addClass("selected");e.css("display","none");E.css("display","none");D.css("display","none");b.css("display","none");c.css("display","block")}});j.on({mousedown:function(){var G=$(this);G.siblings("img").removeClass("selected").end().addClass("selected");e.css("display","none");E.css("display","none");D.css("display","none");b.css("display","block");
c.css("display","none")}});i.on({mousedown:function(){var G=$(this);G.siblings("img").removeClass("selected").end().addClass("selected");e.css("display","block");E.css("display","none");D.css("display","none");b.css("display","none");c.css("display","none")}});r.on("click",function(){if(!m.is(":animated")){if(o.data("resize")=="maximize"){m.css({width:"284px"});o.attr({src:"images/under-redact/RedactBox/Minimize.png",title:"Minimize"}).data("resize","minimize")}h.css("display","block");p.css("display","block");y.css("display","block");m.css("display","none");f()}});function f(){var H=$("#viewer-document-wrapper"),G=H.children(".pageContent");$("#addText").data("active",false).removeClass("selected-tool");G.removeClass("cursorCrosshair")}h.on({mouseup:function(){deleteSingleMarkup();removeSingleMarkupInArray();clearAllHandles()}});g.on("click",function(){var G=getSelectedObjectGroup();if(G){layerAnnotationObject(G,layerOptions.Top)}});F.on("click",function(){var G=getSelectedObjectGroup();
if(G){layerAnnotationObject(G,layerOptions.Bottom)}});k.on("click",function(){var G=getSelectedObjectGroup();if(G){layerAnnotationObject(G,layerOptions.Forward)}});B.on("click",function(){var G=getSelectedObjectGroup();if(G){layerAnnotationObject(G,layerOptions.Backward)}})});$(function(){var a=$("#closeAnnotateBox");var d=$(".selected-visibility-redaction").children(".visibility-holder-redaction");d.on({click:function(){if($(this).hasClass("disable-tool")){return}transferTextAreaValuetoDiv(lastSelectedDivReason);var i=$(this),g=null,h=i.attr("data-visibility");availableVisibility=$(".selected-visibility-redaction").siblings(".visibility-available-container");switch(h){case"Show Redaction":i.attr("data-visibility","Semi-Transparent Redaction");g=availableVisibility.children()[1].getAttribute("src");f(visibilityMode.Transparent);i.attr("title","Change Redaction Visibility to Hide");break;case"Semi-Transparent Redaction":i.attr("data-visibility","Hide Redaction");g=availableVisibility.children()[2].getAttribute("src");
f(visibilityMode.Hidden);i.attr("title","Change Redaction Visibility to Show");break;case"Hide Redaction":i.attr("data-visibility","Show Redaction");g=availableVisibility.children()[0].getAttribute("src");f(visibilityMode.Shown);i.attr("title","Change Redaction Visibility to Semi-Transparent");break}$(".selected-visibility-redaction").children("img").attr("src",g)}});var c=$(".selected-visibility-annotation").children(".visibility-holder-annotation");c.on({click:function(){if($(this).hasClass("disable-tool")){return}transferTextAreaValuetoDiv(lastSelectedDivReason);var i=$(this),g=null,h=i.attr("data-visibility");availableVisibility=$(".selected-visibility-annotation").siblings(".visibility-available-container");switch(h){case"Show Annotation":i.attr("data-visibility","Semi-Transparent Annotation");g=availableVisibility.children()[1].getAttribute("src");b(visibilityMode.Transparent);i.attr("title","Change Annotation Visibility to Hide");break;case"Semi-Transparent Annotation":i.attr("data-visibility","Hide Annotation");
g=availableVisibility.children()[2].getAttribute("src");b(visibilityMode.Hidden);i.attr("title","Change Annotation Visibility to Show");break;case"Hide Annotation":i.attr("data-visibility","Show Annotation");g=availableVisibility.children()[0].getAttribute("src");b(visibilityMode.Shown);i.attr("title","Change Annotation Visibility to Semi-Transparent");break}$(".selected-visibility-annotation").children("img").attr("src",g)}});function f(g){for(var k=0;k<pageCollection.length;k++){var l=pageCollection[k];for(var h=0;h<l.markups.length;h++){if(l.markups[h].markupType===markupTypes.RectangleRedaction){e(l,l.markups[h],g)}}}if(g===visibilityMode.Hidden){selectObject()}}function b(g){for(var k=0;k<pageCollection.length;k++){var l=pageCollection[k];for(var h=0;h<l.markups.length;h++){if(l.markups[h].markupType!==markupTypes.RectangleRedaction){e(l,l.markups[h],g)}}}if(g===visibilityMode.Hidden){selectObject()}}function e(k,h,g){h.shapes.group.style.display=(g===visibilityMode.Hidden)?"none":"block";
h.setVisibilityMode(g);if(k.isMarkupSelected(h.id)){var j=k.selectedMarkupIds.indexOf(h.id);var i=k.handleCollections[j].parentHandle;i.style.display=(g===visibilityMode.Hidden)?"none":"block"}if(g===visibilityMode.Hidden){if(k.isMarkupSelected(h.id)){k.deSelectMarkup(h.id)}}}});var zoomControls=$(".zoomControls > img"),zoomOut=$(".zoomOut"),zoomIn=$(".zoomIn"),currentPageCount=$(".current-page"),viewerContainer=$("#viewerContainer"),lastCurrentPage=currentPageCount.val();zoomControls.on({mouseenter:function(){var a=$(this);if(scaleFactor>0.25&&scaleFactor<5){a.addClass("hoveredBtn")}return false},mouseleave:function(){var a=$(this);a.removeClass("hoveredBtn");return false}});zoomOut.on("click",zoomOutFn);function zoomOutFn(){var c=$("#fitToWidth");var b=c.attr("class");var a=b.indexOf("active-state");if(a>0&&!isResizing){b=b.substring(0,a);c.attr("class",b);isFitContent=false;scaleFactor=scaleFactor-(scaleFactor%0.25);scaleFactor+=0.25;originalScaleFactor=-1}zoomOut.off("click",zoomOutFn);
transferTextAreaValuetoDiv(lastSelectedDivReason);if(logFileStatus=="FileNotFound"||logFileStatus=="Queued"||logFileStatus=="ConvertingToPDF"){return}if(scaleFactor>="0.50"){scaleFactor-=0.25;setZoomLabel(parseFloat((scaleFactor*100)).toFixed(0)+"%");zoomAllPages(scaleFactor)}setTimeout(function(){zoomOut.on("click",zoomOutFn)},100)}zoomIn.on("click",zoomInFn);function zoomInFn(){var c=$("#fitToWidth");var b=c.attr("class");var a=b.indexOf("active-state");if(a>0&&!isResizing){b=b.substring(0,a);c.attr("class",b);isFitContent=false;scaleFactor=scaleFactor-(scaleFactor%0.25);if(scaleFactor===4.75){scaleFactor-=0.25}originalScaleFactor=-1}zoomIn.off("click",zoomInFn);transferTextAreaValuetoDiv(lastSelectedDivReason);if(logFileStatus=="FileNotFound"||logFileStatus=="Queued"||logFileStatus=="ConvertingToPDF"){return}if(scaleFactor<="4.75"){scaleFactor+=0.25;setZoomLabel(parseFloat((scaleFactor*100)).toFixed(0)+"%");zoomAllPages(scaleFactor)}setTimeout(function(){zoomIn.on("click",zoomInFn)},100)
}function zoomAllPages(f){var g=$("#viewer-document-wrapper");viewerChild=g.children(".pageContent"),pageCount=viewerChild.length;var k=$("#viewerContainer");var d=curscrollPercentage;preZoomPageNo=parseInt($(".current-page").val());zoomScroll=true;for(var c=0;c<pageCount;c++){var j=viewerChild.eq(c);var o=pageCollection[c];var b=o.attributes,n=o.attributes.rotateDegrees,m=o.attributes.rotateX,h=o.attributes.rotateY,p=getTransformMatrixValue(f,n,m,h);if(!isFitContent&&b.isFitted){b.isFitted=false}if(j.children().length>0){var e=j.find(".gWrapper");if(e.prop("tagName")=="g"){Snap(e[0]).transform(p)}}var l=o.attributes.pageWidth*f;var a=o.attributes.pageHeight*f;reCalculateHandles(o);if(n==90||n==270){j.width(a+"px");j.height(l+"px")}else{j.width(l+"px");j.height(a+"px")}displayViewableSvg(j)}HScrollBarChecker();getScrollHeightPercentage(pageCount);k.scrollTop(currentScrollVal(d,scrollDiff))}function setZoomLabel(a){$(".selected-zoom","#page-zoomtool").children("span").text(a);if(a==="25%"){$(".zoomOut").css("opacity","0.5");
$(".zoomOut").removeClass("hoveredBtn")}else{if(a==="500%"){$(".zoomIn").css("opacity","0.5");$(".zoomIn").removeClass("hoveredBtn")}else{$(".zoomOut").css("opacity","1");$(".zoomIn").css("opacity","1")}}}function getWidth(){if(navigator.userAgent.match(/(iPod|iPhone|iPad)/)){var a=$("body").width()-5;$("#viewerContainer").css("max-width",a)}}$(document).on("resize",function(){getWidth()});